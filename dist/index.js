// @bun
var _X=Object.create;var{getPrototypeOf:SX,defineProperty:e5,getOwnPropertyNames:DX}=Object;var PX=Object.prototype.hasOwnProperty;var OX=(z,w,U)=>{U=z!=null?_X(SX(z)):{};let W=w||!z||!z.__esModule?e5(U,"default",{value:z,enumerable:!0}):U;for(let X of DX(z))if(!PX.call(W,X))e5(W,X,{get:()=>z[X],enumerable:!0});return W};var RX=(z,w)=>()=>(w||z((w={exports:{}}).exports,w),w.exports);var K6=(z,w)=>{for(var U in w)e5(z,U,{get:w[U],enumerable:!0,configurable:!0,set:(W)=>w[U]=()=>W})};var MW=RX((BW)=>{Object.defineProperty(BW,"__esModule",{value:!0});BW.parse=jN;BW.serialize=EN;var ON=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,RN=/^[\u0021-\u003A\u003C-\u007E]*$/,CN=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,bN=/^[\u0020-\u003A\u003D-\u007E]*$/,KN=Object.prototype.toString,FN=(()=>{let z=function(){};return z.prototype=Object.create(null),z})();function jN(z,w){let U=new FN,W=z.length;if(W<2)return U;let X=w?.decode||IN,A=0;do{let Z=z.indexOf("=",A);if(Z===-1)break;let $=z.indexOf(";",A),Y=$===-1?W:$;if(Z>Y){A=z.lastIndexOf(";",Z-1)+1;continue}let Q=QW(z,A,Z),J=JW(z,Z,Q),N=z.slice(Q,J);if(U[N]===void 0){let S=QW(z,Z+1,Y),G=JW(z,Y,S),O=X(z.slice(S,G));U[N]=O}A=Y+1}while(A<W);return U}function QW(z,w,U){do{let W=z.charCodeAt(w);if(W!==32&&W!==9)return w}while(++w<U);return U}function JW(z,w,U){while(w>U){let W=z.charCodeAt(--w);if(W!==32&&W!==9)return w+1}return U}function EN(z,w,U){let W=U?.encode||encodeURIComponent;if(!ON.test(z))throw new TypeError(`argument name is invalid: ${z}`);let X=W(w);if(!RN.test(X))throw new TypeError(`argument val is invalid: ${w}`);let A=z+"="+X;if(!U)return A;if(U.maxAge!==void 0){if(!Number.isInteger(U.maxAge))throw new TypeError(`option maxAge is invalid: ${U.maxAge}`);A+="; Max-Age="+U.maxAge}if(U.domain){if(!CN.test(U.domain))throw new TypeError(`option domain is invalid: ${U.domain}`);A+="; Domain="+U.domain}if(U.path){if(!bN.test(U.path))throw new TypeError(`option path is invalid: ${U.path}`);A+="; Path="+U.path}if(U.expires){if(!xN(U.expires)||!Number.isFinite(U.expires.valueOf()))throw new TypeError(`option expires is invalid: ${U.expires}`);A+="; Expires="+U.expires.toUTCString()}if(U.httpOnly)A+="; HttpOnly";if(U.secure)A+="; Secure";if(U.partitioned)A+="; Partitioned";if(U.priority)switch(typeof U.priority==="string"?U.priority.toLowerCase():void 0){case"low":A+="; Priority=Low";break;case"medium":A+="; Priority=Medium";break;case"high":A+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${U.priority}`)}if(U.sameSite)switch(typeof U.sameSite==="string"?U.sameSite.toLowerCase():U.sameSite){case!0:case"strict":A+="; SameSite=Strict";break;case"lax":A+="; SameSite=Lax";break;case"none":A+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${U.sameSite}`)}return A}function IN(z){if(z.indexOf("%")===-1)return z;try{return decodeURIComponent(z)}catch(w){return z}}function xN(z){return KN.call(z)==="[object Date]"}});var Mw;(function(z){z[z.Include=0]="Include",z[z.None=1]="None"})(Mw||(Mw={}));var qw;(function(z){z[z.Required=0]="Required",z[z.Ignore=1]="Ignore"})(qw||(qw={}));function zz(z){return Nw(z,CX,b4.Include)}function K4(z){return Nw(z,bX,b4.None)}function Nw(z,w,U){let W="";for(let X=0;X<z.byteLength;X+=3){let A=0,Z=0;for(let $=0;$<3&&X+$<z.byteLength;$++)A=A<<8|z[X+$],Z+=8;for(let $=0;$<4;$++)if(Z>=6)W+=w[A>>Z-6&63],Z-=6;else if(Z>0)W+=w[A<<6-Z&63],Z=0;else if(U===b4.Include)W+="="}return W}var CX="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bX="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";var b4;(function(z){z[z.Include=0]="Include",z[z.None=1]="None"})(b4||(b4={}));var Lw;(function(z){z[z.Required=0]="Required",z[z.Ignore=1]="Ignore"})(Lw||(Lw={}));class Hw{uint8(z,w){if(z.byteLength<w+1)throw new TypeError("Insufficient bytes");return z[w]}uint16(z,w){if(z.byteLength<w+2)throw new TypeError("Insufficient bytes");return z[w]<<8|z[w+1]}uint32(z,w){if(z.byteLength<w+4)throw new TypeError("Insufficient bytes");let U=0;for(let W=0;W<4;W++)U|=z[w+W]<<24-W*8;return U}uint64(z,w){if(z.byteLength<w+8)throw new TypeError("Insufficient bytes");let U=0n;for(let W=0;W<8;W++)U|=BigInt(z[w+W])<<BigInt(56-W*8);return U}putUint8(z,w,U){if(z.length<U+1)throw new TypeError("Not enough space");if(w<0||w>255)throw new TypeError("Invalid uint8 value");z[U]=w}putUint16(z,w,U){if(z.length<U+2)throw new TypeError("Not enough space");if(w<0||w>65535)throw new TypeError("Invalid uint16 value");z[U]=w>>8,z[U+1]=w&255}putUint32(z,w,U){if(z.length<U+4)throw new TypeError("Not enough space");if(w<0||w>4294967295)throw new TypeError("Invalid uint32 value");for(let W=0;W<4;W++)z[U+W]=w>>(3-W)*8&255}putUint64(z,w,U){if(z.length<U+8)throw new TypeError("Not enough space");if(w<0||w>18446744073709551615n)throw new TypeError("Invalid uint64 value");for(let W=0;W<8;W++)z[U+W]=Number(w>>BigInt((7-W)*8)&0xffn)}}class _w{uint8(z,w){if(z.byteLength<w+1)throw new TypeError("Insufficient bytes");return z[w]}uint16(z,w){if(z.byteLength<w+2)throw new TypeError("Insufficient bytes");return z[w]|z[w+1]<<8}uint32(z,w){if(z.byteLength<w+4)throw new TypeError("Insufficient bytes");let U=0;for(let W=0;W<4;W++)U|=z[w+W]<<W*8;return U}uint64(z,w){if(z.byteLength<w+8)throw new TypeError("Insufficient bytes");let U=0n;for(let W=0;W<8;W++)U|=BigInt(z[w+W])<<BigInt(W*8);return U}putUint8(z,w,U){if(z.length<1+U)throw new TypeError("Insufficient space");if(w<0||w>255)throw new TypeError("Invalid uint8 value");z[U]=w}putUint16(z,w,U){if(z.length<2+U)throw new TypeError("Insufficient space");if(w<0||w>65535)throw new TypeError("Invalid uint16 value");z[U+1]=w>>8,z[U]=w&255}putUint32(z,w,U){if(z.length<4+U)throw new TypeError("Insufficient space");if(w<0||w>4294967295)throw new TypeError("Invalid uint32 value");for(let W=0;W<4;W++)z[U+W]=w>>W*8&255}putUint64(z,w,U){if(z.length<8+U)throw new TypeError("Insufficient space");if(w<0||w>18446744073709551615n)throw new TypeError("Invalid uint64 value");for(let W=0;W<8;W++)z[U+W]=Number(w>>BigInt(W*8)&0xffn)}}var j1=new Hw,KX=new _w;function c0(z,w){return(z<<32-w|z>>>w)>>>0}function v2(z,w){return(z<<BigInt(64-w)|z>>BigInt(w))&0xffffffffffffffffn}class Sw{blockSize=64;size=32;blocks=new Uint8Array(64);currentBlockSize=0;H=new Uint32Array([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]);l=0n;w=new Uint32Array(64);update(z){if(this.l+=BigInt(z.byteLength)*8n,this.currentBlockSize+z.byteLength<64){this.blocks.set(z,this.currentBlockSize),this.currentBlockSize+=z.byteLength;return}let w=0;if(this.currentBlockSize>0){let U=z.slice(0,64-this.currentBlockSize);this.blocks.set(U,this.currentBlockSize),this.process(),w+=U.byteLength,this.currentBlockSize=0}while(w+64<=z.byteLength){let U=z.slice(w,w+64);this.blocks.set(U),this.process(),w+=64}if(z.byteLength-w>0){let U=z.slice(w);this.blocks.set(U),this.currentBlockSize=U.byteLength}}digest(){if(this.blocks[this.currentBlockSize]=128,this.currentBlockSize+=1,64-this.currentBlockSize<8)this.blocks.fill(0,this.currentBlockSize),this.process(),this.currentBlockSize=0;this.blocks.fill(0,this.currentBlockSize),j1.putUint64(this.blocks,this.l,this.blockSize-8),this.process();let z=new Uint8Array(28);for(let w=0;w<7;w++)j1.putUint32(z,this.H[w],w*4);return z}process(){for(let Y=0;Y<16;Y++)this.w[Y]=(this.blocks[Y*4]<<24|this.blocks[Y*4+1]<<16|this.blocks[Y*4+2]<<8|this.blocks[Y*4+3])>>>0;for(let Y=16;Y<64;Y++){let Q=(c0(this.w[Y-2],17)^c0(this.w[Y-2],19)^this.w[Y-2]>>>10)>>>0,J=(c0(this.w[Y-15],7)^c0(this.w[Y-15],18)^this.w[Y-15]>>>3)>>>0;this.w[Y]=Q+this.w[Y-7]+J+this.w[Y-16]|0}let z=this.H[0],w=this.H[1],U=this.H[2],W=this.H[3],X=this.H[4],A=this.H[5],Z=this.H[6],$=this.H[7];for(let Y=0;Y<64;Y++){let Q=(c0(X,6)^c0(X,11)^c0(X,25))>>>0,J=(X&A^~X&Z)>>>0,N=$+Q+J+FX[Y]+this.w[Y]|0,S=(c0(z,2)^c0(z,13)^c0(z,22))>>>0,G=(z&w^z&U^w&U)>>>0,O=S+G|0;$=Z,Z=A,A=X,X=W+N|0,W=U,U=w,w=z,z=N+O|0}this.H[0]=z+this.H[0]|0,this.H[1]=w+this.H[1]|0,this.H[2]=U+this.H[2]|0,this.H[3]=W+this.H[3]|0,this.H[4]=X+this.H[4]|0,this.H[5]=A+this.H[5]|0,this.H[6]=Z+this.H[6]|0,this.H[7]=$+this.H[7]|0}}var FX=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function wz(z){let w=new Uz;return w.update(z),w.digest()}class Uz{blockSize=64;size=32;blocks=new Uint8Array(64);currentBlockSize=0;H=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);l=0n;w=new Uint32Array(64);update(z){if(this.l+=BigInt(z.byteLength)*8n,this.currentBlockSize+z.byteLength<64){this.blocks.set(z,this.currentBlockSize),this.currentBlockSize+=z.byteLength;return}let w=0;if(this.currentBlockSize>0){let U=z.slice(0,64-this.currentBlockSize);this.blocks.set(U,this.currentBlockSize),this.process(),w+=U.byteLength,this.currentBlockSize=0}while(w+64<=z.byteLength){let U=z.slice(w,w+64);this.blocks.set(U),this.process(),w+=64}if(z.byteLength-w>0){let U=z.slice(w);this.blocks.set(U),this.currentBlockSize=U.byteLength}}digest(){if(this.blocks[this.currentBlockSize]=128,this.currentBlockSize+=1,64-this.currentBlockSize<8)this.blocks.fill(0,this.currentBlockSize),this.process(),this.currentBlockSize=0;this.blocks.fill(0,this.currentBlockSize),j1.putUint64(this.blocks,this.l,this.blockSize-8),this.process();let z=new Uint8Array(32);for(let w=0;w<8;w++)j1.putUint32(z,this.H[w],w*4);return z}process(){for(let Y=0;Y<16;Y++)this.w[Y]=(this.blocks[Y*4]<<24|this.blocks[Y*4+1]<<16|this.blocks[Y*4+2]<<8|this.blocks[Y*4+3])>>>0;for(let Y=16;Y<64;Y++){let Q=(c0(this.w[Y-2],17)^c0(this.w[Y-2],19)^this.w[Y-2]>>>10)>>>0,J=(c0(this.w[Y-15],7)^c0(this.w[Y-15],18)^this.w[Y-15]>>>3)>>>0;this.w[Y]=Q+this.w[Y-7]+J+this.w[Y-16]|0}let z=this.H[0],w=this.H[1],U=this.H[2],W=this.H[3],X=this.H[4],A=this.H[5],Z=this.H[6],$=this.H[7];for(let Y=0;Y<64;Y++){let Q=(c0(X,6)^c0(X,11)^c0(X,25))>>>0,J=(X&A^~X&Z)>>>0,N=$+Q+J+jX[Y]+this.w[Y]|0,S=(c0(z,2)^c0(z,13)^c0(z,22))>>>0,G=(z&w^z&U^w&U)>>>0,O=S+G|0;$=Z,Z=A,A=X,X=W+N|0,W=U,U=w,w=z,z=N+O|0}this.H[0]=z+this.H[0]|0,this.H[1]=w+this.H[1]|0,this.H[2]=U+this.H[2]|0,this.H[3]=W+this.H[3]|0,this.H[4]=X+this.H[4]|0,this.H[5]=A+this.H[5]|0,this.H[6]=Z+this.H[6]|0,this.H[7]=$+this.H[7]|0}}var jX=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);class Z6{blockSize=128;size=64;blocks=new Uint8Array(128);currentBlockSize=0;l=0n;w=new BigUint64Array(80);H;constructor(z){if(z.byteLength!==64)throw new TypeError;this.H=z}update(z){if(this.l+=BigInt(z.byteLength)*8n,this.currentBlockSize+z.byteLength<128){this.blocks.set(z,this.currentBlockSize),this.currentBlockSize+=z.byteLength;return}let w=0;if(this.currentBlockSize>0){let U=z.slice(0,128-this.currentBlockSize);this.blocks.set(U,this.currentBlockSize),this.process(),w+=U.byteLength,this.currentBlockSize=0}while(w+128<=z.byteLength){let U=z.slice(w,w+128);this.blocks.set(U),this.process(),w+=128,this.currentBlockSize=0}if(z.byteLength-w>0){let U=z.slice(w);this.blocks.set(U),this.currentBlockSize=U.byteLength}}putDigest(z){if(z.byteLength>64||z.byteLength%8!==0)throw new TypeError;if(this.blocks[this.currentBlockSize]=128,this.currentBlockSize+=1,128-this.currentBlockSize<16)this.blocks.fill(0,this.currentBlockSize),this.process(),this.currentBlockSize=0;this.blocks.fill(0,this.currentBlockSize),j1.putUint64(this.blocks,this.l,this.blockSize-8),this.process();for(let w=0;w<z.byteLength/8;w++)j1.putUint64(z,this.H[w],w*8)}process(){for(let Y=0;Y<16;Y++)this.w[Y]=BigInt(this.blocks[Y*8])<<56n|BigInt(this.blocks[Y*8+1])<<48n|BigInt(this.blocks[Y*8+2])<<40n|BigInt(this.blocks[Y*8+3])<<32n|BigInt(this.blocks[Y*8+4])<<24n|BigInt(this.blocks[Y*8+5])<<16n|BigInt(this.blocks[Y*8+6])<<8n|BigInt(this.blocks[Y*8+7]);for(let Y=16;Y<80;Y++){let Q=(v2(this.w[Y-2],19)^v2(this.w[Y-2],61)^this.w[Y-2]>>6n)&0xffffffffffffffffn,J=(v2(this.w[Y-15],1)^v2(this.w[Y-15],8)^this.w[Y-15]>>7n)&0xffffffffffffffffn;this.w[Y]=Q+this.w[Y-7]+J+this.w[Y-16]&0xffffffffffffffffn}let z=this.H[0],w=this.H[1],U=this.H[2],W=this.H[3],X=this.H[4],A=this.H[5],Z=this.H[6],$=this.H[7];for(let Y=0;Y<80;Y++){let Q=(v2(X,14)^v2(X,18)^v2(X,41))&0xffffffffffffffffn,J=(X&A^~X&Z)&0xffffffffffffffffn,N=$+Q+J+EX[Y]+this.w[Y]&0xffffffffffffffffn,S=(v2(z,28)^v2(z,34)^v2(z,39))&0xffffffffffffffffn,G=(z&w^z&U^w&U)&0xffffffffffffffffn,O=S+G&0xffffffffffffffffn;$=Z,Z=A,A=X,X=W+N&0xffffffffffffffffn,W=U,U=w,w=z,z=N+O&0xffffffffffffffffn}this.H[0]=z+this.H[0]&0xffffffffffffffffn,this.H[1]=w+this.H[1]&0xffffffffffffffffn,this.H[2]=U+this.H[2]&0xffffffffffffffffn,this.H[3]=W+this.H[3]&0xffffffffffffffffn,this.H[4]=X+this.H[4]&0xffffffffffffffffn,this.H[5]=A+this.H[5]&0xffffffffffffffffn,this.H[6]=Z+this.H[6]&0xffffffffffffffffn,this.H[7]=$+this.H[7]&0xffffffffffffffffn}}class Dw{blockSize=128;size=64;sha512=new Z6(new BigUint64Array([0x6a09e667f3bcc908n,0xbb67ae8584caa73bn,0x3c6ef372fe94f82bn,0xa54ff53a5f1d36f1n,0x510e527fade682d1n,0x9b05688c2b3e6c1fn,0x1f83d9abfb41bd6bn,0x5be0cd19137e2179n]));update(z){this.sha512.update(z)}digest(){let z=new Uint8Array(64);return this.sha512.putDigest(z),z}}var EX=new BigUint64Array([0x428a2f98d728ae22n,0x7137449123ef65cdn,0xb5c0fbcfec4d3b2fn,0xe9b5dba58189dbbcn,0x3956c25bf348b538n,0x59f111f1b605d019n,0x923f82a4af194f9bn,0xab1c5ed5da6d8118n,0xd807aa98a3030242n,0x12835b0145706fben,0x243185be4ee4b28cn,0x550c7dc3d5ffb4e2n,0x72be5d74f27b896fn,0x80deb1fe3b1696b1n,0x9bdc06a725c71235n,0xc19bf174cf692694n,0xe49b69c19ef14ad2n,0xefbe4786384f25e3n,0x0fc19dc68b8cd5b5n,0x240ca1cc77ac9c65n,0x2de92c6f592b0275n,0x4a7484aa6ea6e483n,0x5cb0a9dcbd41fbd4n,0x76f988da831153b5n,0x983e5152ee66dfabn,0xa831c66d2db43210n,0xb00327c898fb213fn,0xbf597fc7beef0ee4n,0xc6e00bf33da88fc2n,0xd5a79147930aa725n,0x06ca6351e003826fn,0x142929670a0e6e70n,0x27b70a8546d22ffcn,0x2e1b21385c26c926n,0x4d2c6dfc5ac42aedn,0x53380d139d95b3dfn,0x650a73548baf63den,0x766a0abb3c77b2a8n,0x81c2c92e47edaee6n,0x92722c851482353bn,0xa2bfe8a14cf10364n,0xa81a664bbc423001n,0xc24b8b70d0f89791n,0xc76c51a30654be30n,0xd192e819d6ef5218n,0xd69906245565a910n,0xf40e35855771202an,0x106aa07032bbd1b8n,0x19a4c116b8d2d0c8n,0x1e376c085141ab53n,0x2748774cdf8eeb99n,0x34b0bcb5e19b48a8n,0x391c0cb3c5c95a63n,0x4ed8aa4ae3418acbn,0x5b9cca4f7763e373n,0x682e6ff3d6b2b8a3n,0x748f82ee5defb2fcn,0x78a5636f43172f60n,0x84c87814a1f0ab72n,0x8cc702081a6439ecn,0x90befffa23631e28n,0xa4506cebde82bde9n,0xbef9a3f7b2c67915n,0xc67178f2e372532bn,0xca273eceea26619cn,0xd186b8c721c0c207n,0xeada7dd6cde0eb1en,0xf57d4f7fee6ed178n,0x06f067aa72176fban,0x0a637dc5a2c898a6n,0x113f9804bef90daen,0x1b710b35131c471bn,0x28db77f523047d84n,0x32caab7b40c72493n,0x3c9ebe0a15c9bebcn,0x431d67c49c100d4cn,0x4cc5d4becb3e42b6n,0x597f299cfc657e2an,0x5fcb6fab3ad6faecn,0x6c44198c4a475817n]);class Pw{blockSize=128;size=48;sha512=new Z6(new BigUint64Array([0xcbbb9d5dc1059ed8n,0x629a292a367cd507n,0x9159015a3070dd17n,0x152fecd8f70e5939n,0x67332667ffc00b31n,0x8eb44a8768581511n,0xdb0c2e0d64f98fa7n,0x47b5481dbefa4fa4n]));update(z){this.sha512.update(z)}digest(){let z=new Uint8Array(48);return this.sha512.putDigest(z),z}}class Ow{blockSize=128;size=28;sha512=new Z6(new BigUint64Array([0x8c3d37c819544da2n,0x73e1996689dcd4d6n,0x1dfab7ae32ff9c82n,0x679dd514582f9fcfn,0x0f6d2b697bd44da8n,0x77e36f7304c48942n,0x3f9d85a86a1d36c8n,0x1112e6ad91d692a1n]));update(z){this.sha512.update(z)}digest(){let z=new Uint8Array(32);return this.sha512.putDigest(z),z.slice(0,28)}}class Rw{blockSize=128;size=28;sha512=new Z6(new BigUint64Array([0x22312194fc2bf72cn,0x9f555fa3c84c64c2n,0x2393b86b6f53b151n,0x963877195940eabdn,0x96283ee2a88effe3n,0xbe5e1e2553863992n,0x2b0199fc2c85b8aan,0x0eb72ddc81c52ca2n]));update(z){this.sha512.update(z)}digest(){let z=new Uint8Array(32);return this.sha512.putDigest(z),z}}class o6{data;constructor(z){this.data=z}tokenType(){if("token_type"in this.data&&typeof this.data.token_type==="string")return this.data.token_type;throw new Error("Missing or invalid 'token_type' field")}accessToken(){if("access_token"in this.data&&typeof this.data.access_token==="string")return this.data.access_token;throw new Error("Missing or invalid 'access_token' field")}accessTokenExpiresInSeconds(){if("expires_in"in this.data&&typeof this.data.expires_in==="number")return this.data.expires_in;throw new Error("Missing or invalid 'expires_in' field")}accessTokenExpiresAt(){return new Date(Date.now()+this.accessTokenExpiresInSeconds()*1000)}hasRefreshToken(){return"refresh_token"in this.data&&typeof this.data.refresh_token==="string"}refreshToken(){if("refresh_token"in this.data&&typeof this.data.refresh_token==="string")return this.data.refresh_token;throw new Error("Missing or invalid 'refresh_token' field")}hasScopes(){return"scope"in this.data&&typeof this.data.scope==="string"}scopes(){if("scope"in this.data&&typeof this.data.scope==="string")return this.data.scope.split(" ");throw new Error("Missing or invalid 'scope' field")}idToken(){if("id_token"in this.data&&typeof this.data.id_token==="string")return this.data.id_token;throw new Error("Missing or invalid field 'id_token'")}}function V2(z){let w=wz(new TextEncoder().encode(z));return K4(w)}function Wz(){let z=new Uint8Array(32);return crypto.getRandomValues(z),K4(z)}function Xz(){let z=new Uint8Array(32);return crypto.getRandomValues(z),K4(z)}function Cw(z,w){if(w.length!==1)throw new TypeError("Invalid character string");let U=0;while(U<z.length&&z[U]===w)U++;return z.slice(U)}function Az(z,w){if(w.length!==1)throw new TypeError("Invalid character string");let U=z.length;while(U>0&&z[U-1]===w)U--;return z.slice(0,U)}function r0(z,...w){let U=Az(z,"/");for(let W of w)U=Az(U,"/")+"/"+Cw(W,"/");return U}function g(z,w){let U=new TextEncoder().encode(w.toString()),W=new Request(z,{method:"POST",body:U});return W.headers.set("Content-Type","application/x-www-form-urlencoded"),W.headers.set("Accept","application/json"),W.headers.set("User-Agent","arctic"),W.headers.set("Content-Length",U.byteLength.toString()),W}function E1(z,w){let U=new TextEncoder().encode(`${z}:${w}`);return zz(U)}async function i(z){let w;try{w=await fetch(z)}catch(U){throw new $6(U)}if(w.status===400||w.status===401){let U;try{U=await w.json()}catch{throw new d1(w.status)}if(typeof U!=="object"||U===null)throw new Z1(w.status,U);let W;try{W=A8(U)}catch{throw new Z1(w.status,U)}throw W}if(w.status===200){let U;try{U=await w.json()}catch{throw new d1(w.status)}if(typeof U!=="object"||U===null)throw new Z1(w.status,U);return new o6(U)}if(w.body!==null)await w.body.cancel();throw new d1(w.status)}async function h1(z){let w;try{w=await fetch(z)}catch(U){throw new $6(U)}if(w.status===400||w.status===401){let U;try{U=await w.json()}catch{throw new Z1(w.status,null)}if(typeof U!=="object"||U===null)throw new Z1(w.status,U);let W;try{W=A8(U)}catch{throw new Z1(w.status,U)}throw W}if(w.status===200){if(w.body!==null)await w.body.cancel();return}if(w.body!==null)await w.body.cancel();throw new d1(w.status)}function A8(z){let w;if("error"in z&&typeof z.error==="string")w=z.error;else throw new Error("Invalid error response");let U=null,W=null,X=null;if("error_description"in z){if(typeof z.error_description!=="string")throw new Error("Invalid data");U=z.error_description}if("error_uri"in z){if(typeof z.error_uri!=="string")throw new Error("Invalid data");W=z.error_uri}if("state"in z){if(typeof z.state!=="string")throw new Error("Invalid data");X=z.state}return new F4(w,U,W,X)}class $6 extends Error{constructor(z){super("Failed to send request",{cause:z})}}class F4 extends Error{code;description;uri;state;constructor(z,w,U,W){super(`OAuth request error: ${z}`);this.code=z,this.description=w,this.uri=U,this.state=W}}class d1 extends Error{status;constructor(z){super("Unexpected error response");this.status=z}}class Z1 extends Error{status;data;constructor(z,w){super("Unexpected error response body");this.status=z,this.data=w}}class y{clientId;clientPassword;redirectURI;constructor(z,w,U){this.clientId=z,this.clientPassword=w,this.redirectURI=U}createAuthorizationURL(z,w,U){let W=new URL(z);if(W.searchParams.set("response_type","code"),W.searchParams.set("client_id",this.clientId),this.redirectURI!==null)W.searchParams.set("redirect_uri",this.redirectURI);if(W.searchParams.set("state",w),U.length>0)W.searchParams.set("scope",U.join(" "));return W}createAuthorizationURLWithPKCE(z,w,U,W,X){let A=new URL(z);if(A.searchParams.set("response_type","code"),A.searchParams.set("client_id",this.clientId),this.redirectURI!==null)A.searchParams.set("redirect_uri",this.redirectURI);if(A.searchParams.set("state",w),U===e.S256){let Z=V2(W);A.searchParams.set("code_challenge_method","S256"),A.searchParams.set("code_challenge",Z)}else if(U===e.Plain)A.searchParams.set("code_challenge_method","plain"),A.searchParams.set("code_challenge",W);if(X.length>0)A.searchParams.set("scope",X.join(" "));return A}async validateAuthorizationCode(z,w,U){let W=new URLSearchParams;if(W.set("grant_type","authorization_code"),W.set("code",w),this.redirectURI!==null)W.set("redirect_uri",this.redirectURI);if(U!==null)W.set("code_verifier",U);if(this.clientPassword===null)W.set("client_id",this.clientId);let X=g(z,W);if(this.clientPassword!==null){let Z=E1(this.clientId,this.clientPassword);X.headers.set("Authorization",`Basic ${Z}`)}return await i(X)}async refreshAccessToken(z,w,U){let W=new URLSearchParams;if(W.set("grant_type","refresh_token"),W.set("refresh_token",w),this.clientPassword===null)W.set("client_id",this.clientId);if(U.length>0)W.set("scope",U.join(" "));let X=g(z,W);if(this.clientPassword!==null){let Z=E1(this.clientId,this.clientPassword);X.headers.set("Authorization",`Basic ${Z}`)}return await i(X)}async revokeToken(z,w){let U=new URLSearchParams;if(U.set("token",w),this.clientPassword===null)U.set("client_id",this.clientId);let W=g(z,U);if(this.clientPassword!==null){let X=E1(this.clientId,this.clientPassword);W.headers.set("Authorization",`Basic ${X}`)}await h1(W)}}var e;(function(z){z[z.S256=0]="S256",z[z.Plain=1]="Plain"})(e||(e={}));class Z8{authorizationEndpoint;tokenEndpoint;tokenRevocationEndpoint;client;constructor(z,w,U,W){this.authorizationEndpoint=`https://${z}/oauth2/authorize`,this.tokenEndpoint=`https://${z}/oauth2/token`,this.tokenRevocationEndpoint=`https://${z}/oauth2/revoke`,this.client=new y(w,U,W)}createAuthorizationURL(z,w,U){return this.client.createAuthorizationURLWithPKCE(this.authorizationEndpoint,z,e.S256,w,U)}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(this.tokenEndpoint,z,w)}async refreshAccessToken(z,w){return await this.client.refreshAccessToken(this.tokenEndpoint,z,w)}async revokeToken(z){await this.client.revokeToken(this.tokenRevocationEndpoint,z)}}var xX="https://anilist.co/api/v2/oauth/authorize",VX="https://anilist.co/api/v2/oauth/token";class $8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z){return this.client.createAuthorizationURL(xX,z,[])}async validateAuthorizationCode(z){return await this.client.validateAuthorizationCode(VX,z,null)}}var bw;(function(z){z[z.Include=0]="Include",z[z.None=1]="None"})(bw||(bw={}));var Kw;(function(z){z[z.Required=0]="Required",z[z.Ignore=1]="Ignore"})(Kw||(Kw={}));function F6(z){return kX(z,TX,Y8.None)}function kX(z,w,U){let W="";for(let X=0;X<z.byteLength;X+=3){let A=0,Z=0;for(let $=0;$<3&&X+$<z.byteLength;$++)A=A<<8|z[X+$],Z+=8;for(let $=0;$<4;$++)if(Z>=6)W+=w[A>>Z-6&63],Z-=6;else if(Z>0)W+=w[A<<6-Z&63],Z=0;else if(U===Y8.Include)W+="="}return W}var TX="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function Zz(z){return gX(z,fX,j4.Ignore)}function gX(z,w,U){let W=new Uint8Array(Math.ceil(z.length/4)*3),X=0;for(let A=0;A<z.length;A+=4){let Z=0,$=0;for(let Q=0;Q<4;Q++){if(U===j4.Required&&z[A+Q]==="=")continue;if(U===j4.Ignore&&(A+Q>=z.length||z[A+Q]==="="))continue;if(Q>0&&z[A+Q-1]==="=")throw new Error("Invalid padding");if(!(z[A+Q]in w))throw new Error("Invalid character");Z|=w[z[A+Q]]<<(3-Q)*6,$+=6}if($<24){let Q;if($===12)Q=Z&65535;else if($===18)Q=Z&255;else throw new Error("Invalid padding");if(Q!==0)throw new Error("Invalid padding")}let Y=Math.floor($/8);for(let Q=0;Q<Y;Q++)W[X]=Z>>16-Q*8&255,X++}return W.slice(0,X)}var Y8;(function(z){z[z.Include=0]="Include",z[z.None=1]="None"})(Y8||(Y8={}));var j4;(function(z){z[z.Required=0]="Required",z[z.Ignore=1]="Ignore"})(j4||(j4={}));var fX={"0":52,"1":53,"2":54,"3":55,"4":56,"5":57,"6":58,"7":59,"8":60,"9":61,A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,"-":62,_:63};function Fw(z){let w=z.split(".");if(w.length!==3)throw new Error("Invalid JWT");let U;try{U=new TextDecoder().decode(Zz(w[1]))}catch{throw new Error("Invalid JWT: Invalid base64url encoding")}let W;try{W=JSON.parse(U)}catch{throw new Error("Invalid JWT: Invalid JSON encoding")}if(typeof W!=="object"||W===null)throw new Error("Invalid JWT: Invalid payload");return W}function jw(z,w,U){let W=F6(new TextEncoder().encode(z)),X=F6(new TextEncoder().encode(w)),A=F6(U);return W+"."+X+"."+A}function Ew(z,w){let U=F6(new TextEncoder().encode(z)),W=F6(new TextEncoder().encode(w)),X=U+"."+W;return new TextEncoder().encode(X)}var hX="https://appleid.apple.com/auth/authorize",cX="https://appleid.apple.com/auth/token";class Q8{clientId;teamId;keyId;pkcs8PrivateKey;redirectURI;constructor(z,w,U,W,X){this.clientId=z,this.teamId=w,this.keyId=U,this.pkcs8PrivateKey=W,this.redirectURI=X}createAuthorizationURL(z,w){let U=new URL(hX);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId);let U=await this.createClientSecret();w.set("client_secret",U);let W=g(cX,w);return await i(W)}async createClientSecret(){let z=await crypto.subtle.importKey("pkcs8",this.pkcs8PrivateKey,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]),w=Math.floor(Date.now()/1000),U=JSON.stringify({typ:"JWT",alg:"ES256",kid:this.keyId}),W=JSON.stringify({iss:this.teamId,exp:w+300,aud:["https://appleid.apple.com"],sub:this.clientId,iat:w}),X=new Uint8Array(await crypto.subtle.sign({name:"ECDSA",hash:"SHA-256"},z,Ew(U,W)));return jw(U,W,X)}}var iX="https://auth.atlassian.com/authorize",xw="https://auth.atlassian.com/oauth/token";class J8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(iX);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U.searchParams.set("audience","api.atlassian.com"),U.searchParams.set("prompt","consent"),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(xw,w);return await i(U)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(xw,w);return await i(U)}}class B8{authorizationEndpoint;tokenEndpoint;tokenRevocationEndpoint;client;constructor(z,w,U,W){this.authorizationEndpoint=`https://${z}/authorize`,this.tokenEndpoint=`https://${z}/oauth/token`,this.tokenRevocationEndpoint=`https://${z}/oauth/revoke`,this.client=new y(w,U,W)}createAuthorizationURL(z,w,U){let W;if(w!==null)W=this.client.createAuthorizationURLWithPKCE(this.authorizationEndpoint,z,e.S256,w,U);else W=this.client.createAuthorizationURL(this.authorizationEndpoint,z,U);return W}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(this.tokenEndpoint,z,w)}async refreshAccessToken(z){return await this.client.refreshAccessToken(this.tokenEndpoint,z,[])}async revokeToken(z){await this.client.revokeToken(this.tokenRevocationEndpoint,z)}}class M8{authorizationEndpoint;tokenEndpoint;tokenRevocationEndpoint;client;constructor(z,w,U,W){this.authorizationEndpoint=r0(z,"/application/o/authorize/"),this.tokenEndpoint=r0(z,"/application/o/token/"),this.tokenRevocationEndpoint=r0(z,"/application/o/revoke/"),this.client=new y(w,U,W)}createAuthorizationURL(z,w,U){return this.client.createAuthorizationURLWithPKCE(this.authorizationEndpoint,z,e.S256,w,U)}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(this.tokenEndpoint,z,w)}async refreshAccessToken(z){return await this.client.refreshAccessToken(this.tokenEndpoint,z,[])}async revokeToken(z){await this.client.revokeToken(this.tokenRevocationEndpoint,z)}}var yX="https://bitbucket.org/site/oauth2/authorize",Vw="https://bitbucket.org/site/oauth2/access_token";class q8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z){return this.client.createAuthorizationURL(yX,z,[])}async validateAuthorizationCode(z){return await this.client.validateAuthorizationCode(Vw,z,null)}async refreshAccessToken(z){return await this.client.refreshAccessToken(Vw,z,[])}}var vX="https://account.box.com/api/oauth2/authorize",kw="https://api.box.com/oauth2/token",nX="https://api.box.com/oauth2/revoke";class L8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(vX);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(kw,w);return await i(U)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(kw,w);return await i(U)}async revokeToken(z){let w=new URLSearchParams;w.set("token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(nX,w);await h1(U)}}var uX="https://www.coinbase.com/oauth/authorize",Tw="https://www.coinbase.com/oauth/token",mX="https://api.coinbase.com/oauth/revoke";class N8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(uX);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(Tw,w);return await i(U)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(Tw,w);return await i(U)}async revokeToken(z){let w=new URLSearchParams;w.set("token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(mX,w);await h1(U)}}var gw="https://discord.com/oauth2/authorize",fw="https://discord.com/api/oauth2/token",tX="https://discord.com/api/oauth2/token/revoke";class G8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w,U){let W;if(w!==null)W=this.client.createAuthorizationURLWithPKCE(gw,z,e.S256,w,U);else W=this.client.createAuthorizationURL(gw,z,U);return W}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(fw,z,w)}async refreshAccessToken(z){return await this.client.refreshAccessToken(fw,z,[])}async revokeToken(z){await this.client.revokeToken(tX,z)}}var oX="https://dribbble.com/oauth/authorize",pX="https://dribbble.com/oauth/token";class H8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(oX);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(pX,w);return await i(U)}}var lX="https://www.dropbox.com/oauth2/authorize",dw="https://api.dropboxapi.com/oauth2/token",sX="https://api.dropboxapi.com/2/auth/token/revoke";class _8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w){return this.client.createAuthorizationURL(lX,z,w)}async validateAuthorizationCode(z){return await this.client.validateAuthorizationCode(dw,z,null)}async refreshAccessToken(z){return await this.client.refreshAccessToken(dw,z,[])}async revokeToken(z){await this.client.revokeToken(sX,z)}}var rX="https://www.facebook.com/v16.0/dialog/oauth",aX="https://graph.facebook.com/v16.0/oauth/access_token";class S8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(rX);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(aX,w);return await i(U)}}var eX="https://www.figma.com/oauth",zA="https://api.figma.com/v1/oauth/token",wA="https://api.figma.com/v1/oauth/refresh";class D8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w){return this.client.createAuthorizationURL(eX,z,w)}async validateAuthorizationCode(z){return await this.client.validateAuthorizationCode(zA,z,null)}async refreshAccessToken(z){return await this.client.refreshAccessToken(wA,z,[])}}var UA="https://github.com/login/oauth/authorize",hw="https://github.com/login/oauth/access_token";class P8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(UA);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));if(this.redirectURI!==null)U.searchParams.set("redirect_uri",this.redirectURI);return U}async validateAuthorizationCode(z){let w=new URLSearchParams;if(w.set("grant_type","authorization_code"),w.set("code",z),this.redirectURI!==null)w.set("redirect_uri",this.redirectURI);let U=g(hw,w),W=E1(this.clientId,this.clientSecret);return U.headers.set("Authorization",`Basic ${W}`),await cw(U)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z);let U=g(hw,w),W=E1(this.clientId,this.clientSecret);return U.headers.set("Authorization",`Basic ${W}`),await cw(U)}}async function cw(z){let w;try{w=await fetch(z)}catch(X){throw new $6(X)}if(w.status!==200){if(w.body!==null)await w.body.cancel();throw new d1(w.status)}let U;try{U=await w.json()}catch{throw new d1(w.status)}if(typeof U!=="object"||U===null)throw new Z1(w.status,U);if("error"in U&&typeof U.error==="string"){let X;try{X=A8(U)}catch{throw new Z1(w.status,U)}throw X}return new o6(U)}class O8{authorizationEndpoint;tokenEndpoint;tokenRevocationEndpoint;client;constructor(z,w,U,W){this.authorizationEndpoint=r0(z,"/oauth/authorize"),this.tokenEndpoint=r0(z,"/oauth/token"),this.tokenRevocationEndpoint=r0(z,"/oauth/revoke"),this.client=new y(w,U,W)}createAuthorizationURL(z,w){return this.client.createAuthorizationURL(this.authorizationEndpoint,z,w)}async validateAuthorizationCode(z){return await this.client.validateAuthorizationCode(this.tokenEndpoint,z,null)}async refreshAccessToken(z){return await this.client.refreshAccessToken(this.tokenEndpoint,z,[])}async revokeToken(z){await this.client.revokeToken(this.tokenRevocationEndpoint,z)}}var WA="https://accounts.google.com/o/oauth2/v2/auth",iw="https://oauth2.googleapis.com/token",XA="https://oauth2.googleapis.com/revoke";class R8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w,U){return this.client.createAuthorizationURLWithPKCE(WA,z,e.S256,w,U)}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(iw,z,w)}async refreshAccessToken(z){return await this.client.refreshAccessToken(iw,z,[])}async revokeToken(z){await this.client.revokeToken(XA,z)}}var AA="https://appcenter.intuit.com/connect/oauth2",yw="https://oauth.platform.intuit.com/oauth2/v1/tokens/bearer",ZA="https://developer.API.intuit.com/v2/oauth2/tokens/revoke";class C8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w){return this.client.createAuthorizationURL(AA,z,w)}async validateAuthorizationCode(z){return await this.client.validateAuthorizationCode(yw,z,null)}async refreshAccessToken(z){return await this.client.refreshAccessToken(yw,z,[])}async revokeToken(z){await this.client.revokeToken(ZA,z)}}var $A="https://kauth.kakao.com/oauth/authorize",vw="https://kauth.kakao.com/oauth/token";class b8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL($A);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(vw,w);return await i(U)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(vw,w);return await i(U)}}class K8{authorizationEndpoint;tokenEndpoint;tokenRevocationEndpoint;client;constructor(z,w,U,W){this.authorizationEndpoint=z+"/protocol/openid-connect/auth",this.tokenEndpoint=z+"/protocol/openid-connect/token",this.tokenRevocationEndpoint=z+"/protocol/openid-connect/revoke",this.client=new y(w,U,W)}createAuthorizationURL(z,w,U){return this.client.createAuthorizationURLWithPKCE(this.authorizationEndpoint,z,e.S256,w,U)}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(this.tokenEndpoint,z,w)}async refreshAccessToken(z){return await this.client.refreshAccessToken(this.tokenEndpoint,z,[])}async revokeToken(z){await this.client.revokeToken(this.tokenRevocationEndpoint,z)}}var YA="https://lichess.org/oauth",QA="https://lichess.org/api/token";class F8{client;constructor(z,w){this.client=new y(z,null,w)}createAuthorizationURL(z,w,U){return this.client.createAuthorizationURLWithPKCE(YA,z,e.S256,w,U)}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(QA,z,w)}}var JA="https://access.line.me/oauth2/v2.1/authorize",nw="https://api.line.me/oauth2/v2.1/token";class j8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w,U){let W=new URL(JA);if(W.searchParams.set("response_type","code"),W.searchParams.set("client_id",this.clientId),W.searchParams.set("state",z),U.length>0)W.searchParams.set("scope",U.join(" "));W.searchParams.set("redirect_uri",this.redirectURI);let X=V2(w);return W.searchParams.set("code_challenge_method","S256"),W.searchParams.set("code_challenge",X),W}async validateAuthorizationCode(z,w){let U=new URLSearchParams;U.set("grant_type","authorization_code"),U.set("code",z),U.set("code_verifier",w),U.set("redirect_uri",this.redirectURI),U.set("client_id",this.clientId),U.set("client_secret",this.clientSecret);let W=g(nw,U);return await i(W)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(nw,w);return await i(U)}}var BA="https://linear.app/oauth/authorize",MA="https://api.linear.app/oauth/token";class E8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(BA);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(MA,w);return await i(U)}}var qA="https://www.linkedin.com/oauth/v2/authorization",uw="https://www.linkedin.com/oauth/v2/accessToken";class I8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(qA);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(uw,w);return await i(U)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(uw,w);return await i(U)}}class x8{authorizationEndpoint;tokenEndpoint;clientId;clientSecret;redirectURI;constructor(z,w,U,W){this.authorizationEndpoint=r0("https://login.microsoftonline.com",z,"/oauth2/v2.0/authorize"),this.tokenEndpoint=r0("https://login.microsoftonline.com",z,"/oauth2/v2.0/token"),this.clientId=w,this.clientSecret=U,this.redirectURI=W}createAuthorizationURL(z,w,U){let W=new URL(this.authorizationEndpoint);W.searchParams.set("response_type","code"),W.searchParams.set("client_id",this.clientId),W.searchParams.set("redirect_uri",this.redirectURI),W.searchParams.set("state",z);let X=V2(w);if(W.searchParams.set("code_challenge_method","S256"),W.searchParams.set("code_challenge",X),U.length>0)W.searchParams.set("scope",U.join(" "));return W}async validateAuthorizationCode(z,w){let U=new URLSearchParams;if(U.set("grant_type","authorization_code"),U.set("code",z),U.set("redirect_uri",this.redirectURI),U.set("code_verifier",w),this.clientSecret===null)U.set("client_id",this.clientId);let W=g(this.tokenEndpoint,U);if(this.clientSecret!==null){let A=E1(this.clientId,this.clientSecret);W.headers.set("Authorization",`Basic ${A}`)}else W.headers.set("Origin","arctic");return await i(W)}async refreshAccessToken(z,w){let U=new URLSearchParams;if(U.set("grant_type","refresh_token"),U.set("refresh_token",z),this.clientSecret===null)U.set("client_id",this.clientId);if(w.length>0)U.set("scope",w.join(" "));let W=g(this.tokenEndpoint,U);if(this.clientSecret!==null){let A=E1(this.clientId,this.clientSecret);W.headers.set("Authorization",`Basic ${A}`)}else W.headers.set("Origin","arctic");return await i(W)}}var LA="https://myanimelist.net/v1/oauth2/authorize",mw="https://myanimelist.net/v1/oauth2/token";class V8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w){return this.client.createAuthorizationURLWithPKCE(LA,z,e.Plain,w,[])}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(mw,z,w)}async refreshAccessToken(z){return await this.client.refreshAccessToken(mw,z,[])}}var NA="https://api.notion.com/v1/oauth/authorize",GA="https://api.notion.com/v1/oauth/token";class k8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z){let w=this.client.createAuthorizationURL(NA,z,[]);return w.searchParams.set("owner","user"),w}async validateAuthorizationCode(z){return await this.client.validateAuthorizationCode(GA,z,null)}}class T8{authorizationEndpoint;tokenEndpoint;tokenRevocationEndpoint;client;constructor(z,w,U,W,X){let A=`https://${z}/oauth2`;if(w!==null)A=r0(A,w);this.authorizationEndpoint=r0(A,"/v1/authorize"),this.tokenEndpoint=r0(A,"/v1/token"),this.tokenRevocationEndpoint=r0(A,"/v1/revoke"),this.client=new y(U,W,X)}createAuthorizationURL(z,w,U){return this.client.createAuthorizationURLWithPKCE(this.authorizationEndpoint,z,e.S256,w,U)}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(this.tokenEndpoint,z,w)}async refreshAccessToken(z,w){return await this.client.refreshAccessToken(this.tokenEndpoint,z,w)}async revokeToken(z){await this.client.revokeToken(this.tokenRevocationEndpoint,z)}}var HA="https://osu.ppy.sh/oauth/authorize",tw="https://osu.ppy.sh/oauth/token";class g8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(HA);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));if(this.redirectURI!==null)U.searchParams.set("redirect_uri",this.redirectURI);return U}async validateAuthorizationCode(z){let w=new URLSearchParams;if(w.set("grant_type","authorization_code"),w.set("code",z),this.redirectURI!==null)w.set("redirect_uri",this.redirectURI);w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(tw,w);return await i(U)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(tw,w);return await i(U)}}var _A="https://www.patreon.com/oauth2/authorize",ow="https://www.patreon.com/api/oauth2/token";class f8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(_A);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(ow,w);return await i(U)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(ow,w);return await i(U)}}var SA="https://www.reddit.com/api/v1/authorize",pw="https://www.reddit.com/api/v1/access_token";class d8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w){return this.client.createAuthorizationURL(SA,z,w)}async validateAuthorizationCode(z){return await this.client.validateAuthorizationCode(pw,z,null)}async refreshAccessToken(z){return await this.client.refreshAccessToken(pw,z,[])}}var DA="https://apis.roblox.com/oauth/v1/authorize",lw="https://apis.roblox.com/oauth/v1/token",PA="https://apis.roblox.com/oauth/v1/token/revoke";class h8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w,U){return this.client.createAuthorizationURLWithPKCE(DA,z,e.S256,w,U)}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(lw,z,w)}async refreshAccessToken(z){return await this.client.refreshAccessToken(lw,z,[])}async revokeToken(z){await this.client.revokeToken(PA,z)}}class c8{authorizationEndpoint;tokenEndpoint;tokenRevocationEndpoint;client;constructor(z,w,U,W){this.authorizationEndpoint=`https://${z}/services/oauth2/authorize`,this.tokenEndpoint=`https://${z}/services/oauth2/token`,this.tokenRevocationEndpoint=`https://${z}/services/oauth2/revoke`,this.client=new y(w,U,W)}createAuthorizationURL(z,w,U){return this.client.createAuthorizationURLWithPKCE(this.authorizationEndpoint,z,e.S256,w,U)}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(this.tokenEndpoint,z,w)}async refreshAccessToken(z){return await this.client.refreshAccessToken(this.tokenEndpoint,z,[])}async revokeToken(z){await this.client.revokeToken(this.tokenRevocationEndpoint,z)}}var OA="https://shikimori.one/oauth/authorize",sw="https://shikimori.one/oauth/token";class i8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z){let w=new URL(OA);return w.searchParams.set("response_type","code"),w.searchParams.set("client_id",this.clientId),w.searchParams.set("state",z),w.searchParams.set("redirect_uri",this.redirectURI),w}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(sw,w);return await i(U)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(sw,w);return await i(U)}}var RA="https://slack.com/openid/connect/authorize",CA="https://slack.com/api/openid.connect.token";class y8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w){return this.client.createAuthorizationURL(RA,z,w)}async validateAuthorizationCode(z){return await this.client.validateAuthorizationCode(CA,z,null)}}var rw="https://accounts.spotify.com/authorize",aw="https://accounts.spotify.com/api/token";class v8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w,U){let W;if(w!==null)W=this.client.createAuthorizationURLWithPKCE(rw,z,e.S256,w,U);else W=this.client.createAuthorizationURL(rw,z,U);return W}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(aw,z,w)}async refreshAccessToken(z){return await this.client.refreshAccessToken(aw,z,[])}}var bA="https://www.strava.com/oauth/authorize",ew="https://www.strava.com/api/v3/oauth/token";class n8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(bA);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(","));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(ew,w);return await i(U)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(ew,w);return await i(U)}}var KA="https://v5api.tiltify.com/oauth/authorizeze",z9="https://v5api.tiltify.com/oauth/token";class u8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(KA);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(z9,w);return await i(U)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(z9,w);return await i(U)}}var FA="https://www.tumblr.com/oauth2/authorize",w9="https://api.tumblr.com/v2/oauth2/token";class m8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w){return this.client.createAuthorizationURL(FA,z,w)}async validateAuthorizationCode(z){return await this.client.validateAuthorizationCode(w9,z,null)}async refreshAccessToken(z){return await this.client.refreshAccessToken(w9,z,[])}}var jA="https://id.twitch.tv/oauth2/authorize",U9="https://id.twitch.tv/oauth2/token";class t8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(jA);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(U9,w);return await i(U)}async refreshAccessToken(z){let w=new URLSearchParams;w.set("grant_type","refresh_token"),w.set("refresh_token",z),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(U9,w);return await i(U)}}var EA="https://twitter.com/i/oauth2/authorize",W9="https://api.twitter.com/2/oauth2/token",IA="https://api.twitter.com/2/oauth2/revoke";class o8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w,U){return this.client.createAuthorizationURLWithPKCE(EA,z,e.S256,w,U)}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(W9,z,w)}async refreshAccessToken(z){return await this.client.refreshAccessToken(W9,z,[])}async revokeToken(z){await this.client.revokeToken(IA,z)}}var xA="https://oauth.vk.com/authorize",VA="https://oauth.vk.com/access_token";class p8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(xA);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(VA,w);return await i(U)}}var kA="https://api.workos.com/sso/authorize",TA="https://api.workos.com/sso/token";class l8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(kA);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),U.searchParams.set("redirect_uri",this.redirectURI),w!==null){let W=V2(w);U.searchParams.set("code_challenge_method","S256"),U.searchParams.set("code_challenge",W)}return U}async validateAuthorizationCode(z,w){let U=new URLSearchParams;if(U.set("grant_type","authorization_code"),U.set("code",z),U.set("redirect_uri",this.redirectURI),U.set("client_id",this.clientId),this.clientSecret!==null)U.set("client_secret",this.clientSecret);if(w!==null)U.set("code_verifier",w);let W=g(TA,U);return await i(W)}}var gA="https://api.login.yahoo.com/oauth2/request_auth",X9="https://api.login.yahoo.com/oauth2/get_token";class s8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w){return this.client.createAuthorizationURL(gA,z,w)}async validateAuthorizationCode(z){return await this.client.validateAuthorizationCode(X9,z,null)}async refreshAccessToken(z){return await this.client.refreshAccessToken(X9,z,[])}}var fA="https://oauth.yandex.com/authorize",A9="https://oauth.yandex.com/token";class r8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w){return this.client.createAuthorizationURL(fA,z,w)}async validateAuthorizationCode(z){return await this.client.validateAuthorizationCode(A9,z,null)}async refreshAccessToken(z){return await this.client.refreshAccessToken(A9,z,[])}}var dA="https://zoom.us/oauth/authorize",Z9="https://zoom.us/oauth/token",hA="https://zoom.us/oauth/revoke";class a8{client;constructor(z,w,U){this.client=new y(z,w,U)}createAuthorizationURL(z,w,U){return this.client.createAuthorizationURLWithPKCE(dA,z,e.S256,w,U)}async validateAuthorizationCode(z,w){return await this.client.validateAuthorizationCode(Z9,z,w)}async refreshAccessToken(z){return await this.client.refreshAccessToken(Z9,z,[])}async revokeToken(z){await this.client.revokeToken(hA,z)}}var cA="https://api.intra.42.fr/oauth/authorize",iA="https://api.intra.42.fr/oauth/token";class e8{clientId;clientSecret;redirectURI;constructor(z,w,U){this.clientId=z,this.clientSecret=w,this.redirectURI=U}createAuthorizationURL(z,w){let U=new URL(cA);if(U.searchParams.set("response_type","code"),U.searchParams.set("client_id",this.clientId),U.searchParams.set("state",z),w.length>0)U.searchParams.set("scope",w.join(" "));return U.searchParams.set("redirect_uri",this.redirectURI),U}async validateAuthorizationCode(z){let w=new URLSearchParams;w.set("grant_type","authorization_code"),w.set("code",z),w.set("redirect_uri",this.redirectURI),w.set("client_id",this.clientId),w.set("client_secret",this.clientSecret);let U=g(iA,w);return await i(U)}}function $z(z){try{return Fw(z)}catch(w){throw new Error("Invalid ID token",{cause:w})}}var p6=(z,w)=>{let U=w?.length?{}:null;if(U)for(let W of w)U[W.part.charCodeAt(0)]=W;return{part:z,store:null,inert:U,params:null,wildcardStore:null}},$9=(z,w)=>({...z,part:w}),Y9=(z)=>({name:z,store:null,inert:null});class j6{config;root={};history=[];deferred=[];constructor(z={}){if(this.config=z,z.lazy)this.find=this.lazyFind}static regex={static:/:.+?(?=\/|$)/,params:/:.+?(?=\/|$)/g,optionalParams:/:.+?\?(?=\/|$)/g};lazyFind=(z,w)=>{if(!this.config.lazy)return this.find;return this.build(),this.find(z,w)};build(){if(!this.config.lazy)return;for(let[z,w,U]of this.deferred)this.add(z,w,U,{lazy:!1,ignoreHistory:!0});this.deferred=[],this.find=(z,w)=>{let U=this.root[z];if(!U)return null;return z5(w,w.length,U,0)}}add(z,w,U,{ignoreError:W=!1,ignoreHistory:X=!1,lazy:A=this.config.lazy}={}){if(A)return this.find=this.lazyFind,this.deferred.push([z,w,U]),U;if(typeof w!=="string")throw new TypeError("Route path must be a string");if(w==="")w="/";else if(w[0]!=="/")w=`/${w}`;let Z=w[w.length-1]==="*",$=w.match(j6.regex.optionalParams);if($){let S=w.replaceAll("?","");this.add(z,S,U,{ignoreError:W,ignoreHistory:X,lazy:A});for(let G=0;G<$.length;G++){let O=w.replace("/"+$[G],"");this.add(z,O,U,{ignoreError:!0,ignoreHistory:X,lazy:A})}return U}if($)w=w.replaceAll("?","");if(this.history.find(([S,G,O])=>S===z&&G===w))return U;if(Z||$&&w.charCodeAt(w.length-1)===63)w=w.slice(0,-1);if(!X)this.history.push([z,w,U]);let Y=w.split(j6.regex.static),Q=w.match(j6.regex.params)||[];if(Y[Y.length-1]==="")Y.pop();let J;if(!this.root[z])J=this.root[z]=p6("/");else J=this.root[z];let N=0;for(let S=0;S<Y.length;++S){let G=Y[S];if(S>0){let O=Q[N++].slice(1);if(J.params===null)J.params=Y9(O);else if(J.params.name!==O)if(W)return U;else throw new Error(`Cannot create route "${w}" with parameter "${O}" because a route already exists with a different parameter name ("${J.params.name}") in the same location`);let M=J.params;if(M.inert===null){J=M.inert=p6(G);continue}J=M.inert}for(let O=0;;){if(O===G.length){if(O<J.part.length){let M=$9(J,J.part.slice(O));Object.assign(J,p6(G,[M]))}break}if(O===J.part.length){if(J.inert===null)J.inert={};let M=J.inert[G.charCodeAt(O)];if(M){J=M,G=G.slice(O),O=0;continue}let C=p6(G.slice(O));J.inert[G.charCodeAt(O)]=C,J=C;break}if(G[O]!==J.part[O]){let M=$9(J,J.part.slice(O)),C=p6(G.slice(O));Object.assign(J,p6(J.part.slice(0,O),[M,C])),J=C;break}++O}}if(N<Q.length){let S=Q[N].slice(1);if(J.params===null)J.params=Y9(S);else if(J.params.name!==S)if(W)return U;else throw new Error(`Cannot create route "${w}" with parameter "${S}" because a route already exists with a different parameter name ("${J.params.name}") in the same location`);if(J.params.store===null)J.params.store=U;return J.params.store}if(Z){if(J.wildcardStore===null)J.wildcardStore=U;return J.wildcardStore}if(J.store===null)J.store=U;return J.store}find(z,w){let U=this.root[z];if(!U)return null;return z5(w,w.length,U,0)}}var z5=(z,w,U,W)=>{let X=U.part,A=X.length,Z=W+A;if(A>1){if(Z>w)return null;if(A<15){for(let $=1,Y=W+1;$<A;++$,++Y)if(X.charCodeAt($)!==z.charCodeAt(Y))return null}else if(z.slice(W,Z)!==X)return null}if(Z===w){if(U.store!==null)return{store:U.store,params:{}};if(U.wildcardStore!==null)return{store:U.wildcardStore,params:{"*":""}};return null}if(U.inert!==null){let $=U.inert[z.charCodeAt(Z)];if($!==void 0){let Y=z5(z,w,$,Z);if(Y!==null)return Y}}if(U.params!==null){let{store:$,name:Y,inert:Q}=U.params,J=z.indexOf("/",Z);if(J!==Z){if(J===-1||J>=w){if($!==null){let N={};return N[Y]=z.substring(Z,w),{store:$,params:N}}}else if(Q!==null){let N=z5(z,w,Q,J);if(N!==null)return N.params[Y]=z.substring(Z,J),N}}}if(U.wildcardStore!==null)return{store:U.wildcardStore,params:{"*":z.substring(Z,w)}};return null};var Q2={};K6(Q2,{IsUndefined:()=>t0,IsUint8Array:()=>i1,IsSymbol:()=>Mz,IsString:()=>F0,IsRegExp:()=>I4,IsObject:()=>P0,IsNumber:()=>k2,IsNull:()=>Bz,IsIterator:()=>Jz,IsFunction:()=>Qz,IsDate:()=>E6,IsBoolean:()=>c1,IsBigInt:()=>E4,IsAsyncIterator:()=>Yz,IsArray:()=>m0,HasPropertyKey:()=>w5});function w5(z,w){return w in z}function Yz(z){return P0(z)&&!m0(z)&&!i1(z)&&Symbol.asyncIterator in z}function m0(z){return Array.isArray(z)}function E4(z){return typeof z==="bigint"}function c1(z){return typeof z==="boolean"}function E6(z){return z instanceof globalThis.Date}function Qz(z){return typeof z==="function"}function Jz(z){return P0(z)&&!m0(z)&&!i1(z)&&Symbol.iterator in z}function Bz(z){return z===null}function k2(z){return typeof z==="number"}function P0(z){return typeof z==="object"&&z!==null}function I4(z){return z instanceof globalThis.RegExp}function F0(z){return typeof z==="string"}function Mz(z){return typeof z==="symbol"}function i1(z){return z instanceof globalThis.Uint8Array}function t0(z){return z===void 0}function yA(z){return z.map((w)=>U5(w))}function vA(z){return new Date(z.getTime())}function nA(z){return new Uint8Array(z)}function uA(z){return new RegExp(z.source,z.flags)}function mA(z){let w={};for(let U of Object.getOwnPropertyNames(z))w[U]=U5(z[U]);for(let U of Object.getOwnPropertySymbols(z))w[U]=U5(z[U]);return w}function U5(z){return m0(z)?yA(z):E6(z)?vA(z):i1(z)?nA(z):I4(z)?uA(z):P0(z)?mA(z):z}function V0(z){return U5(z)}function l6(z,w){return w===void 0?V0(z):V0({...w,...z})}function W5(z){return l(z)&&globalThis.Symbol.asyncIterator in z}function X5(z){return l(z)&&globalThis.Symbol.iterator in z}function qz(z){return l(z)&&(globalThis.Object.getPrototypeOf(z)===Object.prototype||globalThis.Object.getPrototypeOf(z)===null)}function A5(z){return z instanceof globalThis.Promise}function N2(z){return z instanceof Date&&globalThis.Number.isFinite(z.getTime())}function Q9(z){return z instanceof globalThis.Map}function J9(z){return z instanceof globalThis.Set}function n2(z){return globalThis.ArrayBuffer.isView(z)}function s6(z){return z instanceof globalThis.Uint8Array}function u(z,w){return w in z}function l(z){return z!==null&&typeof z==="object"}function m(z){return globalThis.Array.isArray(z)&&!globalThis.ArrayBuffer.isView(z)}function k0(z){return z===void 0}function y1(z){return z===null}function I1(z){return typeof z==="boolean"}function v(z){return typeof z==="number"}function Z5(z){return globalThis.Number.isInteger(z)}function X2(z){return typeof z==="bigint"}function $0(z){return typeof z==="string"}function Y6(z){return typeof z==="function"}function v1(z){return typeof z==="symbol"}function T2(z){return X2(z)||I1(z)||y1(z)||v(z)||$0(z)||v1(z)||k0(z)}var I0;(function(z){z.InstanceMode="default",z.ExactOptionalPropertyTypes=!1,z.AllowArrayObject=!1,z.AllowNaN=!1,z.AllowNullVoid=!1;function w(Z,$){return z.ExactOptionalPropertyTypes?$ in Z:Z[$]!==void 0}z.IsExactOptionalProperty=w;function U(Z){let $=l(Z);return z.AllowArrayObject?$:$&&!m(Z)}z.IsObjectLike=U;function W(Z){return U(Z)&&!(Z instanceof Date)&&!(Z instanceof Uint8Array)}z.IsRecordLike=W;function X(Z){return z.AllowNaN?v(Z):Number.isFinite(Z)}z.IsNumberLike=X;function A(Z){let $=k0(Z);return z.AllowNullVoid?$||Z===null:$}z.IsVoidLike=A})(I0||(I0={}));function tA(z){return globalThis.Object.freeze(z).map((w)=>x4(w))}function oA(z){return z}function pA(z){return z}function lA(z){return z}function sA(z){let w={};for(let U of Object.getOwnPropertyNames(z))w[U]=x4(z[U]);for(let U of Object.getOwnPropertySymbols(z))w[U]=x4(z[U]);return globalThis.Object.freeze(w)}function x4(z){return m0(z)?tA(z):E6(z)?oA(z):i1(z)?pA(z):I4(z)?lA(z):P0(z)?sA(z):z}function D(z,w){let U=w!==void 0?{...w,...z}:z;switch(I0.InstanceMode){case"freeze":return x4(U);case"clone":return V0(U);default:return U}}class n extends Error{constructor(z){super(z)}}var j0=Symbol.for("TypeBox.Transform"),$1=Symbol.for("TypeBox.Readonly"),A2=Symbol.for("TypeBox.Optional"),u2=Symbol.for("TypeBox.Hint"),H=Symbol.for("TypeBox.Kind");function r6(z){return P0(z)&&z[$1]==="Readonly"}function S2(z){return P0(z)&&z[A2]==="Optional"}function Lz(z){return X0(z,"Any")}function Nz(z){return X0(z,"Argument")}function Y1(z){return X0(z,"Array")}function I6(z){return X0(z,"AsyncIterator")}function x6(z){return X0(z,"BigInt")}function n1(z){return X0(z,"Boolean")}function Q1(z){return X0(z,"Computed")}function J1(z){return X0(z,"Constructor")}function rA(z){return X0(z,"Date")}function B1(z){return X0(z,"Function")}function M1(z){return X0(z,"Integer")}function i0(z){return X0(z,"Intersect")}function V6(z){return X0(z,"Iterator")}function X0(z,w){return P0(z)&&H in z&&z[H]===w}function $5(z){return c1(z)||k2(z)||F0(z)}function g2(z){return X0(z,"Literal")}function f2(z){return X0(z,"MappedKey")}function T0(z){return X0(z,"MappedResult")}function Q6(z){return X0(z,"Never")}function aA(z){return X0(z,"Not")}function V4(z){return X0(z,"Null")}function q1(z){return X0(z,"Number")}function o0(z){return X0(z,"Object")}function k6(z){return X0(z,"Promise")}function T6(z){return X0(z,"Record")}function u0(z){return X0(z,"Ref")}function Gz(z){return X0(z,"RegExp")}function u1(z){return X0(z,"String")}function k4(z){return X0(z,"Symbol")}function d2(z){return X0(z,"TemplateLiteral")}function eA(z){return X0(z,"This")}function L0(z){return P0(z)&&j0 in z}function h2(z){return X0(z,"Tuple")}function m1(z){return X0(z,"Undefined")}function Y0(z){return X0(z,"Union")}function zZ(z){return X0(z,"Uint8Array")}function wZ(z){return X0(z,"Unknown")}function UZ(z){return X0(z,"Unsafe")}function WZ(z){return X0(z,"Void")}function J6(z){return P0(z)&&H in z&&F0(z[H])}function f0(z){return Lz(z)||Nz(z)||Y1(z)||n1(z)||x6(z)||I6(z)||Q1(z)||J1(z)||rA(z)||B1(z)||M1(z)||i0(z)||V6(z)||g2(z)||f2(z)||T0(z)||Q6(z)||aA(z)||V4(z)||q1(z)||o0(z)||k6(z)||T6(z)||u0(z)||Gz(z)||u1(z)||k4(z)||d2(z)||eA(z)||h2(z)||m1(z)||Y0(z)||zZ(z)||wZ(z)||UZ(z)||WZ(z)||J6(z)}var q={};K6(q,{TypeGuardUnknownTypeError:()=>B9,IsVoid:()=>a9,IsUnsafe:()=>r9,IsUnknown:()=>s9,IsUnionLiteral:()=>MZ,IsUnion:()=>Sz,IsUndefined:()=>p9,IsUint8Array:()=>l9,IsTuple:()=>o9,IsTransform:()=>t9,IsThis:()=>m9,IsTemplateLiteral:()=>u9,IsSymbol:()=>n9,IsString:()=>v9,IsSchema:()=>g0,IsRegExp:()=>y9,IsRef:()=>i9,IsRecursive:()=>BZ,IsRecord:()=>c9,IsReadonly:()=>$Z,IsProperties:()=>Y5,IsPromise:()=>h9,IsOptional:()=>YZ,IsObject:()=>d9,IsNumber:()=>f9,IsNull:()=>g9,IsNot:()=>T9,IsNever:()=>k9,IsMappedResult:()=>V9,IsMappedKey:()=>x9,IsLiteralValue:()=>I9,IsLiteralString:()=>j9,IsLiteralNumber:()=>E9,IsLiteralBoolean:()=>JZ,IsLiteral:()=>g4,IsKindOf:()=>z0,IsKind:()=>e9,IsIterator:()=>F9,IsIntersect:()=>K9,IsInteger:()=>b9,IsImport:()=>QZ,IsFunction:()=>C9,IsDate:()=>R9,IsConstructor:()=>O9,IsComputed:()=>P9,IsBoolean:()=>D9,IsBigInt:()=>S9,IsAsyncIterator:()=>_9,IsArray:()=>H9,IsArgument:()=>G9,IsAny:()=>N9});class B9 extends n{}var XZ=["Argument","Any","Array","AsyncIterator","BigInt","Boolean","Computed","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function M9(z){try{return new RegExp(z),!0}catch{return!1}}function Hz(z){if(!F0(z))return!1;for(let w=0;w<z.length;w++){let U=z.charCodeAt(w);if(U>=7&&U<=13||U===27||U===127)return!1}return!0}function q9(z){return _z(z)||g0(z)}function T4(z){return t0(z)||E4(z)}function E0(z){return t0(z)||k2(z)}function _z(z){return t0(z)||c1(z)}function O0(z){return t0(z)||F0(z)}function AZ(z){return t0(z)||F0(z)&&Hz(z)&&M9(z)}function ZZ(z){return t0(z)||F0(z)&&Hz(z)}function L9(z){return t0(z)||g0(z)}function $Z(z){return P0(z)&&z[$1]==="Readonly"}function YZ(z){return P0(z)&&z[A2]==="Optional"}function N9(z){return z0(z,"Any")&&O0(z.$id)}function G9(z){return z0(z,"Argument")&&k2(z.index)}function H9(z){return z0(z,"Array")&&z.type==="array"&&O0(z.$id)&&g0(z.items)&&E0(z.minItems)&&E0(z.maxItems)&&_z(z.uniqueItems)&&L9(z.contains)&&E0(z.minContains)&&E0(z.maxContains)}function _9(z){return z0(z,"AsyncIterator")&&z.type==="AsyncIterator"&&O0(z.$id)&&g0(z.items)}function S9(z){return z0(z,"BigInt")&&z.type==="bigint"&&O0(z.$id)&&T4(z.exclusiveMaximum)&&T4(z.exclusiveMinimum)&&T4(z.maximum)&&T4(z.minimum)&&T4(z.multipleOf)}function D9(z){return z0(z,"Boolean")&&z.type==="boolean"&&O0(z.$id)}function P9(z){return z0(z,"Computed")&&F0(z.target)&&m0(z.parameters)&&z.parameters.every((w)=>g0(w))}function O9(z){return z0(z,"Constructor")&&z.type==="Constructor"&&O0(z.$id)&&m0(z.parameters)&&z.parameters.every((w)=>g0(w))&&g0(z.returns)}function R9(z){return z0(z,"Date")&&z.type==="Date"&&O0(z.$id)&&E0(z.exclusiveMaximumTimestamp)&&E0(z.exclusiveMinimumTimestamp)&&E0(z.maximumTimestamp)&&E0(z.minimumTimestamp)&&E0(z.multipleOfTimestamp)}function C9(z){return z0(z,"Function")&&z.type==="Function"&&O0(z.$id)&&m0(z.parameters)&&z.parameters.every((w)=>g0(w))&&g0(z.returns)}function QZ(z){return z0(z,"Import")&&w5(z,"$defs")&&P0(z.$defs)&&Y5(z.$defs)&&w5(z,"$ref")&&F0(z.$ref)&&z.$ref in z.$defs}function b9(z){return z0(z,"Integer")&&z.type==="integer"&&O0(z.$id)&&E0(z.exclusiveMaximum)&&E0(z.exclusiveMinimum)&&E0(z.maximum)&&E0(z.minimum)&&E0(z.multipleOf)}function Y5(z){return P0(z)&&Object.entries(z).every(([w,U])=>Hz(w)&&g0(U))}function K9(z){return z0(z,"Intersect")&&(F0(z.type)&&z.type!=="object"?!1:!0)&&m0(z.allOf)&&z.allOf.every((w)=>g0(w)&&!t9(w))&&O0(z.type)&&(_z(z.unevaluatedProperties)||L9(z.unevaluatedProperties))&&O0(z.$id)}function F9(z){return z0(z,"Iterator")&&z.type==="Iterator"&&O0(z.$id)&&g0(z.items)}function z0(z,w){return P0(z)&&H in z&&z[H]===w}function j9(z){return g4(z)&&F0(z.const)}function E9(z){return g4(z)&&k2(z.const)}function JZ(z){return g4(z)&&c1(z.const)}function g4(z){return z0(z,"Literal")&&O0(z.$id)&&I9(z.const)}function I9(z){return c1(z)||k2(z)||F0(z)}function x9(z){return z0(z,"MappedKey")&&m0(z.keys)&&z.keys.every((w)=>k2(w)||F0(w))}function V9(z){return z0(z,"MappedResult")&&Y5(z.properties)}function k9(z){return z0(z,"Never")&&P0(z.not)&&Object.getOwnPropertyNames(z.not).length===0}function T9(z){return z0(z,"Not")&&g0(z.not)}function g9(z){return z0(z,"Null")&&z.type==="null"&&O0(z.$id)}function f9(z){return z0(z,"Number")&&z.type==="number"&&O0(z.$id)&&E0(z.exclusiveMaximum)&&E0(z.exclusiveMinimum)&&E0(z.maximum)&&E0(z.minimum)&&E0(z.multipleOf)}function d9(z){return z0(z,"Object")&&z.type==="object"&&O0(z.$id)&&Y5(z.properties)&&q9(z.additionalProperties)&&E0(z.minProperties)&&E0(z.maxProperties)}function h9(z){return z0(z,"Promise")&&z.type==="Promise"&&O0(z.$id)&&g0(z.item)}function c9(z){return z0(z,"Record")&&z.type==="object"&&O0(z.$id)&&q9(z.additionalProperties)&&P0(z.patternProperties)&&((w)=>{let U=Object.getOwnPropertyNames(w.patternProperties);return U.length===1&&M9(U[0])&&P0(w.patternProperties)&&g0(w.patternProperties[U[0]])})(z)}function BZ(z){return P0(z)&&u2 in z&&z[u2]==="Recursive"}function i9(z){return z0(z,"Ref")&&O0(z.$id)&&F0(z.$ref)}function y9(z){return z0(z,"RegExp")&&O0(z.$id)&&F0(z.source)&&F0(z.flags)&&E0(z.maxLength)&&E0(z.minLength)}function v9(z){return z0(z,"String")&&z.type==="string"&&O0(z.$id)&&E0(z.minLength)&&E0(z.maxLength)&&AZ(z.pattern)&&ZZ(z.format)}function n9(z){return z0(z,"Symbol")&&z.type==="symbol"&&O0(z.$id)}function u9(z){return z0(z,"TemplateLiteral")&&z.type==="string"&&F0(z.pattern)&&z.pattern[0]==="^"&&z.pattern[z.pattern.length-1]==="$"}function m9(z){return z0(z,"This")&&O0(z.$id)&&F0(z.$ref)}function t9(z){return P0(z)&&j0 in z}function o9(z){return z0(z,"Tuple")&&z.type==="array"&&O0(z.$id)&&k2(z.minItems)&&k2(z.maxItems)&&z.minItems===z.maxItems&&(t0(z.items)&&t0(z.additionalItems)&&z.minItems===0||m0(z.items)&&z.items.every((w)=>g0(w)))}function p9(z){return z0(z,"Undefined")&&z.type==="undefined"&&O0(z.$id)}function MZ(z){return Sz(z)&&z.anyOf.every((w)=>j9(w)||E9(w))}function Sz(z){return z0(z,"Union")&&O0(z.$id)&&P0(z)&&m0(z.anyOf)&&z.anyOf.every((w)=>g0(w))}function l9(z){return z0(z,"Uint8Array")&&z.type==="Uint8Array"&&O0(z.$id)&&E0(z.minByteLength)&&E0(z.maxByteLength)}function s9(z){return z0(z,"Unknown")&&O0(z.$id)}function r9(z){return z0(z,"Unsafe")}function a9(z){return z0(z,"Void")&&z.type==="void"&&O0(z.$id)}function e9(z){return P0(z)&&H in z&&F0(z[H])&&!XZ.includes(z[H])}function g0(z){return P0(z)&&(N9(z)||G9(z)||H9(z)||D9(z)||S9(z)||_9(z)||P9(z)||O9(z)||R9(z)||C9(z)||b9(z)||K9(z)||F9(z)||g4(z)||x9(z)||V9(z)||k9(z)||T9(z)||g9(z)||f9(z)||d9(z)||h9(z)||c9(z)||i9(z)||y9(z)||v9(z)||n9(z)||u9(z)||m9(z)||o9(z)||p9(z)||Sz(z)||l9(z)||s9(z)||r9(z)||a9(z)||e9(z))}var z7="(true|false)",Q5="(0|[1-9][0-9]*)",w7="(.*)";var x1="^(0|[1-9][0-9]*)$",V1="^(.*)$",U7="^(?!.*)$";var D0={};K6(D0,{Set:()=>HZ,Has:()=>GZ,Get:()=>_Z,Entries:()=>qZ,Delete:()=>NZ,Clear:()=>LZ});var a6=new Map;function qZ(){return new Map(a6)}function LZ(){return a6.clear()}function NZ(z){return a6.delete(z)}function GZ(z){return a6.has(z)}function HZ(z,w){a6.set(z,w)}function _Z(z){return a6.get(z)}var p0={};K6(p0,{Set:()=>RZ,Has:()=>OZ,Get:()=>CZ,Entries:()=>SZ,Delete:()=>PZ,Clear:()=>DZ});var e6=new Map;function SZ(){return new Map(e6)}function DZ(){return e6.clear()}function PZ(z){return e6.delete(z)}function OZ(z){return e6.has(z)}function RZ(z,w){e6.set(z,w)}function CZ(z){return e6.get(z)}function W7(z,w){return z.includes(w)}function X7(z){return[...new Set(z)]}function bZ(z,w){return z.filter((U)=>w.includes(U))}function KZ(z,w){return z.reduce((U,W)=>{return bZ(U,W)},w)}function A7(z){return z.length===1?z[0]:z.length>1?KZ(z.slice(1),z[0]):[]}function Z7(z){let w=[];for(let U of z)w.push(...U);return w}function B6(z){return D({[H]:"Any"},z)}function z4(z,w){return D({[H]:"Array",type:"array",items:z},w)}function $7(z){return D({[H]:"Argument",index:z})}function w4(z,w){return D({[H]:"AsyncIterator",type:"AsyncIterator",items:z},w)}function x0(z,w,U){return D({[H]:"Computed",target:z,parameters:w},U)}function FZ(z,w){let{[w]:U,...W}=z;return W}function y0(z,w){return w.reduce((U,W)=>FZ(U,W),z)}function p(z){return D({[H]:"Never",not:{}},z)}function Q0(z){return D({[H]:"MappedResult",properties:z})}function U4(z,w,U){return D({[H]:"Constructor",type:"Constructor",parameters:z,returns:w},U)}function k1(z,w,U){return D({[H]:"Function",type:"Function",parameters:z,returns:w},U)}function f4(z,w){return D({[H]:"Union",anyOf:z},w)}function jZ(z){return z.some((w)=>S2(w))}function Y7(z){return z.map((w)=>S2(w)?EZ(w):w)}function EZ(z){return y0(z,[A2])}function IZ(z,w){return jZ(z)?J2(f4(Y7(z),w)):f4(Y7(z),w)}function T1(z,w){return z.length===1?D(z[0],w):z.length===0?p(w):IZ(z,w)}function N0(z,w){return z.length===0?p(w):z.length===1?D(z[0],w):f4(z,w)}class Dz extends n{}function xZ(z){return z.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function Pz(z,w,U){return z[w]===U&&z.charCodeAt(w-1)!==92}function o1(z,w){return Pz(z,w,"(")}function d4(z,w){return Pz(z,w,")")}function Q7(z,w){return Pz(z,w,"|")}function VZ(z){if(!(o1(z,0)&&d4(z,z.length-1)))return!1;let w=0;for(let U=0;U<z.length;U++){if(o1(z,U))w+=1;if(d4(z,U))w-=1;if(w===0&&U!==z.length-1)return!1}return!0}function kZ(z){return z.slice(1,z.length-1)}function TZ(z){let w=0;for(let U=0;U<z.length;U++){if(o1(z,U))w+=1;if(d4(z,U))w-=1;if(Q7(z,U)&&w===0)return!0}return!1}function gZ(z){for(let w=0;w<z.length;w++)if(o1(z,w))return!0;return!1}function fZ(z){let[w,U]=[0,0],W=[];for(let A=0;A<z.length;A++){if(o1(z,A))w+=1;if(d4(z,A))w-=1;if(Q7(z,A)&&w===0){let Z=z.slice(U,A);if(Z.length>0)W.push(W4(Z));U=A+1}}let X=z.slice(U);if(X.length>0)W.push(W4(X));if(W.length===0)return{type:"const",const:""};if(W.length===1)return W[0];return{type:"or",expr:W}}function dZ(z){function w(X,A){if(!o1(X,A))throw new Dz("TemplateLiteralParser: Index must point to open parens");let Z=0;for(let $=A;$<X.length;$++){if(o1(X,$))Z+=1;if(d4(X,$))Z-=1;if(Z===0)return[A,$]}throw new Dz("TemplateLiteralParser: Unclosed group parens in expression")}function U(X,A){for(let Z=A;Z<X.length;Z++)if(o1(X,Z))return[A,Z];return[A,X.length]}let W=[];for(let X=0;X<z.length;X++)if(o1(z,X)){let[A,Z]=w(z,X),$=z.slice(A,Z+1);W.push(W4($)),X=Z}else{let[A,Z]=U(z,X),$=z.slice(A,Z);if($.length>0)W.push(W4($));X=Z-1}return W.length===0?{type:"const",const:""}:W.length===1?W[0]:{type:"and",expr:W}}function W4(z){return VZ(z)?W4(kZ(z)):TZ(z)?fZ(z):gZ(z)?dZ(z):{type:"const",const:xZ(z)}}function X4(z){return W4(z.slice(1,z.length-1))}class J7 extends n{}function hZ(z){return z.type==="or"&&z.expr.length===2&&z.expr[0].type==="const"&&z.expr[0].const==="0"&&z.expr[1].type==="const"&&z.expr[1].const==="[1-9][0-9]*"}function cZ(z){return z.type==="or"&&z.expr.length===2&&z.expr[0].type==="const"&&z.expr[0].const==="true"&&z.expr[1].type==="const"&&z.expr[1].const==="false"}function iZ(z){return z.type==="const"&&z.const===".*"}function g6(z){return hZ(z)||iZ(z)?!1:cZ(z)?!0:z.type==="and"?z.expr.every((w)=>g6(w)):z.type==="or"?z.expr.every((w)=>g6(w)):z.type==="const"?!0:(()=>{throw new J7("Unknown expression type")})()}function J5(z){let w=X4(z.pattern);return g6(w)}class B7 extends n{}function*M7(z){if(z.length===1)return yield*z[0];for(let w of z[0])for(let U of M7(z.slice(1)))yield`${w}${U}`}function*yZ(z){return yield*M7(z.expr.map((w)=>[...h4(w)]))}function*vZ(z){for(let w of z.expr)yield*h4(w)}function*nZ(z){return yield z.const}function*h4(z){return z.type==="and"?yield*yZ(z):z.type==="or"?yield*vZ(z):z.type==="const"?yield*nZ(z):(()=>{throw new B7("Unknown expression")})()}function A4(z){let w=X4(z.pattern);return g6(w)?[...h4(w)]:[]}function A0(z,w){return D({[H]:"Literal",const:z,type:typeof z},w)}function B5(z){return D({[H]:"Boolean",type:"boolean"},z)}function Z4(z){return D({[H]:"BigInt",type:"bigint"},z)}function m2(z){return D({[H]:"Number",type:"number"},z)}function G2(z){return D({[H]:"String",type:"string"},z)}function*uZ(z){let w=z.trim().replace(/"|'/g,"");return w==="boolean"?yield B5():w==="number"?yield m2():w==="bigint"?yield Z4():w==="string"?yield G2():yield(()=>{let U=w.split("|").map((W)=>A0(W.trim()));return U.length===0?p():U.length===1?U[0]:T1(U)})()}function*mZ(z){if(z[1]!=="{"){let w=A0("$"),U=Oz(z.slice(1));return yield*[w,...U]}for(let w=2;w<z.length;w++)if(z[w]==="}"){let U=uZ(z.slice(2,w)),W=Oz(z.slice(w+1));return yield*[...U,...W]}yield A0(z)}function*Oz(z){for(let w=0;w<z.length;w++)if(z[w]==="$"){let U=A0(z.slice(0,w)),W=mZ(z.slice(w));return yield*[U,...W]}yield A0(z)}function q7(z){return[...Oz(z)]}class L7 extends n{}function tZ(z){return z.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function N7(z,w){return d2(z)?z.pattern.slice(1,z.pattern.length-1):Y0(z)?`(${z.anyOf.map((U)=>N7(U,w)).join("|")})`:q1(z)?`${w}${Q5}`:M1(z)?`${w}${Q5}`:x6(z)?`${w}${Q5}`:u1(z)?`${w}${w7}`:g2(z)?`${w}${tZ(z.const.toString())}`:n1(z)?`${w}${z7}`:(()=>{throw new L7(`Unexpected Kind '${z[H]}'`)})()}function Rz(z){return`^${z.map((w)=>N7(w,"")).join("")}$`}function f6(z){let U=A4(z).map((W)=>A0(W));return T1(U)}function M5(z,w){let U=F0(z)?Rz(q7(z)):Rz(z);return D({[H]:"TemplateLiteral",type:"string",pattern:U},w)}function oZ(z){return A4(z).map((U)=>U.toString())}function pZ(z){let w=[];for(let U of z)w.push(...D2(U));return w}function lZ(z){return[z.toString()]}function D2(z){return[...new Set(d2(z)?oZ(z):Y0(z)?pZ(z.anyOf):g2(z)?lZ(z.const):q1(z)?["[number]"]:M1(z)?["[number]"]:[])]}function sZ(z,w,U){let W={};for(let X of Object.getOwnPropertyNames(w))W[X]=M6(z,D2(w[X]),U);return W}function rZ(z,w,U){return sZ(z,w.properties,U)}function G7(z,w,U){let W=rZ(z,w,U);return Q0(W)}function _7(z,w){return z.map((U)=>S7(U,w))}function aZ(z){return z.filter((w)=>!Q6(w))}function eZ(z,w){return q5(aZ(_7(z,w)))}function z$(z){return z.some((w)=>Q6(w))?[]:z}function w$(z,w){return T1(z$(_7(z,w)))}function U$(z,w){return w in z?z[w]:w==="[number]"?T1(z):p()}function W$(z,w){return w==="[number]"?z:p()}function X$(z,w){return w in z?z[w]:p()}function S7(z,w){return i0(z)?eZ(z.allOf,w):Y0(z)?w$(z.anyOf,w):h2(z)?U$(z.items??[],w):Y1(z)?W$(z.items,w):o0(z)?X$(z.properties,w):p()}function c4(z,w){return w.map((U)=>S7(z,U))}function H7(z,w){return T1(c4(z,w))}function M6(z,w,U){if(u0(z)||u0(w)){if(!f0(z)||!f0(w))throw new n("Index types using Ref parameters require both Type and Key to be of TSchema");return x0("Index",[z,w])}if(T0(w))return G7(z,w,U);if(f2(w))return D7(z,w,U);return D(f0(w)?H7(z,D2(w)):H7(z,w),U)}function A$(z,w,U){return{[w]:M6(z,[w],V0(U))}}function Z$(z,w,U){return w.reduce((W,X)=>{return{...W,...A$(z,X,U)}},{})}function $$(z,w,U){return Z$(z,w.keys,U)}function D7(z,w,U){let W=$$(z,w,U);return Q0(W)}function $4(z,w){return D({[H]:"Iterator",type:"Iterator",items:z},w)}function Y$(z){let w=[];for(let U in z)if(!S2(z[U]))w.push(U);return w}function Q$(z,w){let U=Y$(z),W=U.length>0?{[H]:"Object",type:"object",properties:z,required:U}:{[H]:"Object",type:"object",properties:z};return D(W,w)}var G0=Q$;function L5(z,w){return D({[H]:"Promise",type:"Promise",item:z},w)}function J$(z){return D(y0(z,[$1]))}function B$(z){return D({...z,[$1]:"Readonly"})}function M$(z,w){return w===!1?J$(z):B$(z)}function P2(z,w){let U=w??!0;return T0(z)?P7(z,U):M$(z,U)}function q$(z,w){let U={};for(let W of globalThis.Object.getOwnPropertyNames(z))U[W]=P2(z[W],w);return U}function L$(z,w){return q$(z.properties,w)}function P7(z,w){let U=L$(z,w);return Q0(U)}function t2(z,w){return D(z.length>0?{[H]:"Tuple",type:"array",items:z,additionalItems:!1,minItems:z.length,maxItems:z.length}:{[H]:"Tuple",type:"array",minItems:z.length,maxItems:z.length},w)}function O7(z,w){return z in w?o2(z,w[z]):Q0(w)}function N$(z){return{[z]:A0(z)}}function G$(z){let w={};for(let U of z)w[U]=A0(U);return w}function H$(z,w){return W7(w,z)?N$(z):G$(w)}function _$(z,w){let U=H$(z,w);return O7(z,U)}function i4(z,w){return w.map((U)=>o2(z,U))}function S$(z,w){let U={};for(let W of globalThis.Object.getOwnPropertyNames(w))U[W]=o2(z,w[W]);return U}function o2(z,w){let U={...w};return S2(w)?J2(o2(z,y0(w,[A2]))):r6(w)?P2(o2(z,y0(w,[$1]))):T0(w)?O7(z,w.properties):f2(w)?_$(z,w.keys):J1(w)?U4(i4(z,w.parameters),o2(z,w.returns),U):B1(w)?k1(i4(z,w.parameters),o2(z,w.returns),U):I6(w)?w4(o2(z,w.items),U):V6(w)?$4(o2(z,w.items),U):i0(w)?B2(i4(z,w.allOf),U):Y0(w)?N0(i4(z,w.anyOf),U):h2(w)?t2(i4(z,w.items??[]),U):o0(w)?G0(S$(z,w.properties),U):Y1(w)?z4(o2(z,w.items),U):k6(w)?L5(o2(z,w.item),U):w}function D$(z,w){let U={};for(let W of z)U[W]=o2(W,w);return U}function R7(z,w,U){let W=f0(z)?D2(z):z,X=w({[H]:"MappedKey",keys:W}),A=D$(W,X);return G0(A,U)}function P$(z){return D(y0(z,[A2]))}function O$(z){return D({...z,[A2]:"Optional"})}function R$(z,w){return w===!1?P$(z):O$(z)}function J2(z,w){let U=w??!0;return T0(z)?C7(z,U):R$(z,U)}function C$(z,w){let U={};for(let W of globalThis.Object.getOwnPropertyNames(z))U[W]=J2(z[W],w);return U}function b$(z,w){return C$(z.properties,w)}function C7(z,w){let U=b$(z,w);return Q0(U)}function y4(z,w={}){let U=z.every((X)=>o0(X)),W=f0(w.unevaluatedProperties)?{unevaluatedProperties:w.unevaluatedProperties}:{};return D(w.unevaluatedProperties===!1||f0(w.unevaluatedProperties)||U?{...W,[H]:"Intersect",type:"object",allOf:z}:{...W,[H]:"Intersect",allOf:z},w)}function K$(z){return z.every((w)=>S2(w))}function F$(z){return y0(z,[A2])}function b7(z){return z.map((w)=>S2(w)?F$(w):w)}function j$(z,w){return K$(z)?J2(y4(b7(z),w)):y4(b7(z),w)}function q5(z,w={}){if(z.length===1)return D(z[0],w);if(z.length===0)return p(w);if(z.some((U)=>L0(U)))throw new Error("Cannot intersect transform types");return j$(z,w)}function B2(z,w){if(z.length===1)return D(z[0],w);if(z.length===0)return p(w);if(z.some((U)=>L0(U)))throw new Error("Cannot intersect transform types");return y4(z,w)}function p2(...z){let[w,U]=typeof z[0]==="string"?[z[0],z[1]]:[z[0].$id,z[1]];if(typeof w!=="string")throw new n("Ref: $ref must be a string");return D({[H]:"Ref",$ref:w},U)}function E$(z,w){return x0("Awaited",[x0(z,w)])}function I$(z){return x0("Awaited",[p2(z)])}function x$(z){return B2(K7(z))}function V$(z){return N0(K7(z))}function k$(z){return Y4(z)}function K7(z){return z.map((w)=>Y4(w))}function Y4(z,w){return D(Q1(z)?E$(z.target,z.parameters):i0(z)?x$(z.allOf):Y0(z)?V$(z.anyOf):k6(z)?k$(z.item):u0(z)?I$(z.$ref):z,w)}function F7(z){let w=[];for(let U of z)w.push(O2(U));return w}function T$(z){let w=F7(z);return Z7(w)}function g$(z){let w=F7(z);return A7(w)}function f$(z){return z.map((w,U)=>U.toString())}function d$(z){return["[number]"]}function h$(z){return globalThis.Object.getOwnPropertyNames(z)}function c$(z){if(!Cz)return[];return globalThis.Object.getOwnPropertyNames(z).map((U)=>{return U[0]==="^"&&U[U.length-1]==="$"?U.slice(1,U.length-1):U})}function O2(z){return i0(z)?T$(z.allOf):Y0(z)?g$(z.anyOf):h2(z)?f$(z.items??[]):Y1(z)?d$(z.items):o0(z)?h$(z.properties):T6(z)?c$(z.patternProperties):[]}var Cz=!1;function p1(z){Cz=!0;let w=O2(z);return Cz=!1,`^(${w.map((W)=>`(${W})`).join("|")})$`}function i$(z,w){return x0("KeyOf",[x0(z,w)])}function y$(z){return x0("KeyOf",[p2(z)])}function v$(z,w){let U=O2(z),W=n$(U),X=T1(W);return D(X,w)}function n$(z){return z.map((w)=>w==="[number]"?m2():A0(w))}function Q4(z,w){return Q1(z)?i$(z.target,z.parameters):u0(z)?y$(z.$ref):T0(z)?j7(z,w):v$(z,w)}function u$(z,w){let U={};for(let W of globalThis.Object.getOwnPropertyNames(z))U[W]=Q4(z[W],V0(w));return U}function m$(z,w){return u$(z.properties,w)}function j7(z,w){let U=m$(z,w);return Q0(U)}function N5(z){let w=O2(z),U=c4(z,w);return w.map((W,X)=>[w[X],U[X]])}function t$(z){let w=[];for(let U of z)w.push(...O2(U));return X7(w)}function o$(z){return z.filter((w)=>!Q6(w))}function p$(z,w){let U=[];for(let W of z)U.push(...c4(W,[w]));return o$(U)}function l$(z,w){let U={};for(let W of w)U[W]=q5(p$(z,W));return U}function E7(z,w){let U=t$(z),W=l$(z,U);return G0(W,w)}function G5(z){return D({[H]:"Date",type:"Date"},z)}function H5(z){return D({[H]:"Null",type:"null"},z)}function _5(z){return D({[H]:"Symbol",type:"symbol"},z)}function S5(z){return D({[H]:"Undefined",type:"undefined"},z)}function D5(z){return D({[H]:"Uint8Array",type:"Uint8Array"},z)}function L1(z){return D({[H]:"Unknown"},z)}function s$(z){return z.map((w)=>bz(w,!1))}function r$(z){let w={};for(let U of globalThis.Object.getOwnPropertyNames(z))w[U]=P2(bz(z[U],!1));return w}function P5(z,w){return w===!0?z:P2(z)}function bz(z,w){return Yz(z)?P5(B6(),w):Jz(z)?P5(B6(),w):m0(z)?P2(t2(s$(z))):i1(z)?D5():E6(z)?G5():P0(z)?P5(G0(r$(z)),w):Qz(z)?P5(k1([],L1()),w):t0(z)?S5():Bz(z)?H5():Mz(z)?_5():E4(z)?Z4():k2(z)?A0(z):c1(z)?A0(z):F0(z)?A0(z):G0({})}function I7(z,w){return D(bz(z,!0),w)}function x7(z,w){return J1(z)?t2(z.parameters,w):p(w)}function V7(z,w){if(t0(z))throw new Error("Enum undefined or empty");let U=globalThis.Object.getOwnPropertyNames(z).filter((A)=>isNaN(A)).map((A)=>z[A]),X=[...new Set(U)].map((A)=>A0(A));return N0(X,{...w,[u2]:"Enum"})}class d7 extends n{}var P;(function(z){z[z.Union=0]="Union",z[z.True=1]="True",z[z.False=2]="False"})(P||(P={}));function l2(z){return z===P.False?z:P.True}function J4(z){throw new d7(z)}function l0(z){return q.IsNever(z)||q.IsIntersect(z)||q.IsUnion(z)||q.IsUnknown(z)||q.IsAny(z)}function s0(z,w){return q.IsNever(w)?i7(z,w):q.IsIntersect(w)?O5(z,w):q.IsUnion(w)?Iz(z,w):q.IsUnknown(w)?u7(z,w):q.IsAny(w)?Ez(z,w):J4("StructuralRight")}function Ez(z,w){return P.True}function a$(z,w){return q.IsIntersect(w)?O5(z,w):q.IsUnion(w)&&w.anyOf.some((U)=>q.IsAny(U)||q.IsUnknown(U))?P.True:q.IsUnion(w)?P.Union:q.IsUnknown(w)?P.True:q.IsAny(w)?P.True:P.Union}function e$(z,w){return q.IsUnknown(z)?P.False:q.IsAny(z)?P.Union:q.IsNever(z)?P.True:P.False}function zY(z,w){return q.IsObject(w)&&R5(w)?P.True:l0(w)?s0(z,w):!q.IsArray(w)?P.False:l2(R0(z.items,w.items))}function wY(z,w){return l0(w)?s0(z,w):!q.IsAsyncIterator(w)?P.False:l2(R0(z.items,w.items))}function UY(z,w){return l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):q.IsRecord(w)?s2(z,w):q.IsBigInt(w)?P.True:P.False}function h7(z,w){return q.IsLiteralBoolean(z)?P.True:q.IsBoolean(z)?P.True:P.False}function WY(z,w){return l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):q.IsRecord(w)?s2(z,w):q.IsBoolean(w)?P.True:P.False}function XY(z,w){return l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):!q.IsConstructor(w)?P.False:z.parameters.length>w.parameters.length?P.False:!z.parameters.every((U,W)=>l2(R0(w.parameters[W],U))===P.True)?P.False:l2(R0(z.returns,w.returns))}function AY(z,w){return l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):q.IsRecord(w)?s2(z,w):q.IsDate(w)?P.True:P.False}function ZY(z,w){return l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):!q.IsFunction(w)?P.False:z.parameters.length>w.parameters.length?P.False:!z.parameters.every((U,W)=>l2(R0(w.parameters[W],U))===P.True)?P.False:l2(R0(z.returns,w.returns))}function c7(z,w){return q.IsLiteral(z)&&Q2.IsNumber(z.const)?P.True:q.IsNumber(z)||q.IsInteger(z)?P.True:P.False}function $Y(z,w){return q.IsInteger(w)||q.IsNumber(w)?P.True:l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):q.IsRecord(w)?s2(z,w):P.False}function O5(z,w){return w.allOf.every((U)=>R0(z,U)===P.True)?P.True:P.False}function YY(z,w){return z.allOf.some((U)=>R0(U,w)===P.True)?P.True:P.False}function QY(z,w){return l0(w)?s0(z,w):!q.IsIterator(w)?P.False:l2(R0(z.items,w.items))}function JY(z,w){return q.IsLiteral(w)&&w.const===z.const?P.True:l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):q.IsRecord(w)?s2(z,w):q.IsString(w)?n7(z,w):q.IsNumber(w)?y7(z,w):q.IsInteger(w)?c7(z,w):q.IsBoolean(w)?h7(z,w):P.False}function i7(z,w){return P.False}function BY(z,w){return P.True}function k7(z){let[w,U]=[z,0];while(!0){if(!q.IsNot(w))break;w=w.not,U+=1}return U%2===0?w:L1()}function MY(z,w){return q.IsNot(z)?R0(k7(z),w):q.IsNot(w)?R0(z,k7(w)):J4("Invalid fallthrough for Not")}function qY(z,w){return l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):q.IsRecord(w)?s2(z,w):q.IsNull(w)?P.True:P.False}function y7(z,w){return q.IsLiteralNumber(z)?P.True:q.IsNumber(z)||q.IsInteger(z)?P.True:P.False}function LY(z,w){return l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):q.IsRecord(w)?s2(z,w):q.IsInteger(w)||q.IsNumber(w)?P.True:P.False}function R2(z,w){return Object.getOwnPropertyNames(z.properties).length===w}function T7(z){return R5(z)}function g7(z){return R2(z,0)||R2(z,1)&&"description"in z.properties&&q.IsUnion(z.properties.description)&&z.properties.description.anyOf.length===2&&(q.IsString(z.properties.description.anyOf[0])&&q.IsUndefined(z.properties.description.anyOf[1])||q.IsString(z.properties.description.anyOf[1])&&q.IsUndefined(z.properties.description.anyOf[0]))}function Kz(z){return R2(z,0)}function f7(z){return R2(z,0)}function NY(z){return R2(z,0)}function GY(z){return R2(z,0)}function HY(z){return R5(z)}function _Y(z){let w=m2();return R2(z,0)||R2(z,1)&&"length"in z.properties&&l2(R0(z.properties.length,w))===P.True}function SY(z){return R2(z,0)}function R5(z){let w=m2();return R2(z,0)||R2(z,1)&&"length"in z.properties&&l2(R0(z.properties.length,w))===P.True}function DY(z){let w=k1([B6()],B6());return R2(z,0)||R2(z,1)&&"then"in z.properties&&l2(R0(z.properties.then,w))===P.True}function v7(z,w){return R0(z,w)===P.False?P.False:q.IsOptional(z)&&!q.IsOptional(w)?P.False:P.True}function M2(z,w){return q.IsUnknown(z)?P.False:q.IsAny(z)?P.Union:q.IsNever(z)||q.IsLiteralString(z)&&T7(w)||q.IsLiteralNumber(z)&&Kz(w)||q.IsLiteralBoolean(z)&&f7(w)||q.IsSymbol(z)&&g7(w)||q.IsBigInt(z)&&NY(w)||q.IsString(z)&&T7(w)||q.IsSymbol(z)&&g7(w)||q.IsNumber(z)&&Kz(w)||q.IsInteger(z)&&Kz(w)||q.IsBoolean(z)&&f7(w)||q.IsUint8Array(z)&&HY(w)||q.IsDate(z)&&GY(w)||q.IsConstructor(z)&&SY(w)||q.IsFunction(z)&&_Y(w)?P.True:q.IsRecord(z)&&q.IsString(Fz(z))?(()=>{return w[u2]==="Record"?P.True:P.False})():q.IsRecord(z)&&q.IsNumber(Fz(z))?(()=>{return R2(w,0)?P.True:P.False})():P.False}function PY(z,w){return l0(w)?s0(z,w):q.IsRecord(w)?s2(z,w):!q.IsObject(w)?P.False:(()=>{for(let U of Object.getOwnPropertyNames(w.properties)){if(!(U in z.properties)&&!q.IsOptional(w.properties[U]))return P.False;if(q.IsOptional(w.properties[U]))return P.True;if(v7(z.properties[U],w.properties[U])===P.False)return P.False}return P.True})()}function OY(z,w){return l0(w)?s0(z,w):q.IsObject(w)&&DY(w)?P.True:!q.IsPromise(w)?P.False:l2(R0(z.item,w.item))}function Fz(z){return x1 in z.patternProperties?m2():(V1 in z.patternProperties)?G2():J4("Unknown record key pattern")}function jz(z){return x1 in z.patternProperties?z.patternProperties[x1]:(V1 in z.patternProperties)?z.patternProperties[V1]:J4("Unable to get record value schema")}function s2(z,w){let[U,W]=[Fz(w),jz(w)];return q.IsLiteralString(z)&&q.IsNumber(U)&&l2(R0(z,W))===P.True?P.True:q.IsUint8Array(z)&&q.IsNumber(U)?R0(z,W):q.IsString(z)&&q.IsNumber(U)?R0(z,W):q.IsArray(z)&&q.IsNumber(U)?R0(z,W):q.IsObject(z)?(()=>{for(let X of Object.getOwnPropertyNames(z.properties))if(v7(W,z.properties[X])===P.False)return P.False;return P.True})():P.False}function RY(z,w){return l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):!q.IsRecord(w)?P.False:R0(jz(z),jz(w))}function CY(z,w){let U=q.IsRegExp(z)?G2():z,W=q.IsRegExp(w)?G2():w;return R0(U,W)}function n7(z,w){return q.IsLiteral(z)&&Q2.IsString(z.const)?P.True:q.IsString(z)?P.True:P.False}function bY(z,w){return l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):q.IsRecord(w)?s2(z,w):q.IsString(w)?P.True:P.False}function KY(z,w){return l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):q.IsRecord(w)?s2(z,w):q.IsSymbol(w)?P.True:P.False}function FY(z,w){return q.IsTemplateLiteral(z)?R0(f6(z),w):q.IsTemplateLiteral(w)?R0(z,f6(w)):J4("Invalid fallthrough for TemplateLiteral")}function jY(z,w){return q.IsArray(w)&&z.items!==void 0&&z.items.every((U)=>R0(U,w.items)===P.True)}function EY(z,w){return q.IsNever(z)?P.True:q.IsUnknown(z)?P.False:q.IsAny(z)?P.Union:P.False}function IY(z,w){return l0(w)?s0(z,w):q.IsObject(w)&&R5(w)?P.True:q.IsArray(w)&&jY(z,w)?P.True:!q.IsTuple(w)?P.False:Q2.IsUndefined(z.items)&&!Q2.IsUndefined(w.items)||!Q2.IsUndefined(z.items)&&Q2.IsUndefined(w.items)?P.False:Q2.IsUndefined(z.items)&&!Q2.IsUndefined(w.items)?P.True:z.items.every((U,W)=>R0(U,w.items[W])===P.True)?P.True:P.False}function xY(z,w){return l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):q.IsRecord(w)?s2(z,w):q.IsUint8Array(w)?P.True:P.False}function VY(z,w){return l0(w)?s0(z,w):q.IsObject(w)?M2(z,w):q.IsRecord(w)?s2(z,w):q.IsVoid(w)?gY(z,w):q.IsUndefined(w)?P.True:P.False}function Iz(z,w){return w.anyOf.some((U)=>R0(z,U)===P.True)?P.True:P.False}function kY(z,w){return z.anyOf.every((U)=>R0(U,w)===P.True)?P.True:P.False}function u7(z,w){return P.True}function TY(z,w){return q.IsNever(w)?i7(z,w):q.IsIntersect(w)?O5(z,w):q.IsUnion(w)?Iz(z,w):q.IsAny(w)?Ez(z,w):q.IsString(w)?n7(z,w):q.IsNumber(w)?y7(z,w):q.IsInteger(w)?c7(z,w):q.IsBoolean(w)?h7(z,w):q.IsArray(w)?e$(z,w):q.IsTuple(w)?EY(z,w):q.IsObject(w)?M2(z,w):q.IsUnknown(w)?P.True:P.False}function gY(z,w){return q.IsUndefined(z)?P.True:q.IsUndefined(z)?P.True:P.False}function fY(z,w){return q.IsIntersect(w)?O5(z,w):q.IsUnion(w)?Iz(z,w):q.IsUnknown(w)?u7(z,w):q.IsAny(w)?Ez(z,w):q.IsObject(w)?M2(z,w):q.IsVoid(w)?P.True:P.False}function R0(z,w){return q.IsTemplateLiteral(z)||q.IsTemplateLiteral(w)?FY(z,w):q.IsRegExp(z)||q.IsRegExp(w)?CY(z,w):q.IsNot(z)||q.IsNot(w)?MY(z,w):q.IsAny(z)?a$(z,w):q.IsArray(z)?zY(z,w):q.IsBigInt(z)?UY(z,w):q.IsBoolean(z)?WY(z,w):q.IsAsyncIterator(z)?wY(z,w):q.IsConstructor(z)?XY(z,w):q.IsDate(z)?AY(z,w):q.IsFunction(z)?ZY(z,w):q.IsInteger(z)?$Y(z,w):q.IsIntersect(z)?YY(z,w):q.IsIterator(z)?QY(z,w):q.IsLiteral(z)?JY(z,w):q.IsNever(z)?BY(z,w):q.IsNull(z)?qY(z,w):q.IsNumber(z)?LY(z,w):q.IsObject(z)?PY(z,w):q.IsRecord(z)?RY(z,w):q.IsString(z)?bY(z,w):q.IsSymbol(z)?KY(z,w):q.IsTuple(z)?IY(z,w):q.IsPromise(z)?OY(z,w):q.IsUint8Array(z)?xY(z,w):q.IsUndefined(z)?VY(z,w):q.IsUnion(z)?kY(z,w):q.IsUnknown(z)?TY(z,w):q.IsVoid(z)?fY(z,w):J4(`Unknown left type operand '${z[H]}'`)}function q6(z,w){return R0(z,w)}function dY(z,w,U,W,X){let A={};for(let Z of globalThis.Object.getOwnPropertyNames(z))A[Z]=B4(z[Z],w,U,W,V0(X));return A}function hY(z,w,U,W,X){return dY(z.properties,w,U,W,X)}function m7(z,w,U,W,X){let A=hY(z,w,U,W,X);return Q0(A)}function cY(z,w,U,W){let X=q6(z,w);return X===P.Union?N0([U,W]):X===P.True?U:W}function B4(z,w,U,W,X){return T0(z)?m7(z,w,U,W,X):f2(z)?D(t7(z,w,U,W,X)):D(cY(z,w,U,W),X)}function iY(z,w,U,W,X){return{[z]:B4(A0(z),w,U,W,V0(X))}}function yY(z,w,U,W,X){return z.reduce((A,Z)=>{return{...A,...iY(Z,w,U,W,X)}},{})}function vY(z,w,U,W,X){return yY(z.keys,w,U,W,X)}function t7(z,w,U,W,X){let A=vY(z,w,U,W,X);return Q0(A)}function nY(z){return z.allOf.every((w)=>l1(w))}function uY(z){return z.anyOf.some((w)=>l1(w))}function mY(z){return!l1(z.not)}function l1(z){return z[H]==="Intersect"?nY(z):z[H]==="Union"?uY(z):z[H]==="Not"?mY(z):z[H]==="Undefined"?!0:!1}function o7(z,w){return M4(f6(z),w)}function tY(z,w){let U=z.filter((W)=>q6(W,w)===P.False);return U.length===1?U[0]:N0(U)}function M4(z,w,U={}){if(d2(z))return D(o7(z,w),U);if(T0(z))return D(p7(z,w),U);return D(Y0(z)?tY(z.anyOf,w):q6(z,w)!==P.False?p():z,U)}function oY(z,w){let U={};for(let W of globalThis.Object.getOwnPropertyNames(z))U[W]=M4(z[W],w);return U}function pY(z,w){return oY(z.properties,w)}function p7(z,w){let U=pY(z,w);return Q0(U)}function l7(z,w){return q4(f6(z),w)}function lY(z,w){let U=z.filter((W)=>q6(W,w)!==P.False);return U.length===1?U[0]:N0(U)}function q4(z,w,U){if(d2(z))return D(l7(z,w),U);if(T0(z))return D(s7(z,w),U);return D(Y0(z)?lY(z.anyOf,w):q6(z,w)!==P.False?z:p(),U)}function sY(z,w){let U={};for(let W of globalThis.Object.getOwnPropertyNames(z))U[W]=q4(z[W],w);return U}function rY(z,w){return sY(z.properties,w)}function s7(z,w){let U=rY(z,w);return Q0(U)}function r7(z,w){return J1(z)?D(z.returns,w):p(w)}function C5(z){return P2(J2(z))}function d6(z,w,U){return D({[H]:"Record",type:"object",patternProperties:{[z]:w}},U)}function xz(z,w,U){let W={};for(let X of z)W[X]=w;return G0(W,{...U,[u2]:"Record"})}function aY(z,w,U){return J5(z)?xz(D2(z),w,U):d6(z.pattern,w,U)}function eY(z,w,U){return xz(D2(N0(z)),w,U)}function zQ(z,w,U){return xz([z.toString()],w,U)}function wQ(z,w,U){return d6(z.source,w,U)}function UQ(z,w,U){let W=t0(z.pattern)?V1:z.pattern;return d6(W,w,U)}function WQ(z,w,U){return d6(V1,w,U)}function XQ(z,w,U){return d6(U7,w,U)}function AQ(z,w,U){return G0({true:w,false:w},U)}function ZQ(z,w,U){return d6(x1,w,U)}function $Q(z,w,U){return d6(x1,w,U)}function b5(z,w,U={}){return Y0(z)?eY(z.anyOf,w,U):d2(z)?aY(z,w,U):g2(z)?zQ(z.const,w,U):n1(z)?AQ(z,w,U):M1(z)?ZQ(z,w,U):q1(z)?$Q(z,w,U):Gz(z)?wQ(z,w,U):u1(z)?UQ(z,w,U):Lz(z)?WQ(z,w,U):Q6(z)?XQ(z,w,U):p(U)}function K5(z){return globalThis.Object.getOwnPropertyNames(z.patternProperties)[0]}function a7(z){let w=K5(z);return w===V1?G2():w===x1?m2():G2({pattern:w})}function F5(z){return z.patternProperties[K5(z)]}function YQ(z,w){return w.parameters=v4(z,w.parameters),w.returns=N1(z,w.returns),w}function QQ(z,w){return w.parameters=v4(z,w.parameters),w.returns=N1(z,w.returns),w}function JQ(z,w){return w.allOf=v4(z,w.allOf),w}function BQ(z,w){return w.anyOf=v4(z,w.anyOf),w}function MQ(z,w){if(t0(w.items))return w;return w.items=v4(z,w.items),w}function qQ(z,w){return w.items=N1(z,w.items),w}function LQ(z,w){return w.items=N1(z,w.items),w}function NQ(z,w){return w.items=N1(z,w.items),w}function GQ(z,w){return w.item=N1(z,w.item),w}function HQ(z,w){let U=PQ(z,w.properties);return{...w,...G0(U)}}function _Q(z,w){let U=N1(z,a7(w)),W=N1(z,F5(w)),X=b5(U,W);return{...w,...X}}function SQ(z,w){return w.index in z?z[w.index]:L1()}function DQ(z,w){let U=r6(w),W=S2(w),X=N1(z,w);return U&&W?C5(X):U&&!W?P2(X):!U&&W?J2(X):X}function PQ(z,w){return globalThis.Object.getOwnPropertyNames(w).reduce((U,W)=>{return{...U,[W]:DQ(z,w[W])}},{})}function v4(z,w){return w.map((U)=>N1(z,U))}function N1(z,w){return J1(w)?YQ(z,w):B1(w)?QQ(z,w):i0(w)?JQ(z,w):Y0(w)?BQ(z,w):h2(w)?MQ(z,w):Y1(w)?qQ(z,w):I6(w)?LQ(z,w):V6(w)?NQ(z,w):k6(w)?GQ(z,w):o0(w)?HQ(z,w):T6(w)?_Q(z,w):Nz(w)?SQ(z,w):w}function e7(z,w){return N1(w,l6(z))}function zU(z){return D({[H]:"Integer",type:"integer"},z)}function OQ(z,w,U){return{[z]:G1(A0(z),w,V0(U))}}function RQ(z,w,U){return z.reduce((X,A)=>{return{...X,...OQ(A,w,U)}},{})}function CQ(z,w,U){return RQ(z.keys,w,U)}function wU(z,w,U){let W=CQ(z,w,U);return Q0(W)}function bQ(z){let[w,U]=[z.slice(0,1),z.slice(1)];return[w.toLowerCase(),U].join("")}function KQ(z){let[w,U]=[z.slice(0,1),z.slice(1)];return[w.toUpperCase(),U].join("")}function FQ(z){return z.toUpperCase()}function jQ(z){return z.toLowerCase()}function EQ(z,w,U){let W=X4(z.pattern);if(!g6(W))return{...z,pattern:UU(z.pattern,w)};let Z=[...h4(W)].map((Q)=>A0(Q)),$=WU(Z,w),Y=N0($);return M5([Y],U)}function UU(z,w){return typeof z==="string"?w==="Uncapitalize"?bQ(z):w==="Capitalize"?KQ(z):w==="Uppercase"?FQ(z):w==="Lowercase"?jQ(z):z:z.toString()}function WU(z,w){return z.map((U)=>G1(U,w))}function G1(z,w,U={}){return f2(z)?wU(z,w,U):d2(z)?EQ(z,w,U):Y0(z)?N0(WU(z.anyOf,w),U):g2(z)?A0(UU(z.const,w),U):D(z,U)}function XU(z,w={}){return G1(z,"Capitalize",w)}function AU(z,w={}){return G1(z,"Lowercase",w)}function ZU(z,w={}){return G1(z,"Uncapitalize",w)}function $U(z,w={}){return G1(z,"Uppercase",w)}function IQ(z,w,U){let W={};for(let X of globalThis.Object.getOwnPropertyNames(z))W[X]=L6(z[X],w,V0(U));return W}function xQ(z,w,U){return IQ(z.properties,w,U)}function YU(z,w,U){let W=xQ(z,w,U);return Q0(W)}function VQ(z,w){return z.map((U)=>Vz(U,w))}function kQ(z,w){return z.map((U)=>Vz(U,w))}function TQ(z,w){let{[w]:U,...W}=z;return W}function gQ(z,w){return w.reduce((U,W)=>TQ(U,W),z)}function fQ(z,w){let U=y0(z,[j0,"$id","required","properties"]),W=gQ(z.properties,w);return G0(W,U)}function dQ(z){let w=z.reduce((U,W)=>$5(W)?[...U,A0(W)]:U,[]);return N0(w)}function Vz(z,w){return i0(z)?B2(VQ(z.allOf,w)):Y0(z)?N0(kQ(z.anyOf,w)):o0(z)?fQ(z,w):G0({})}function L6(z,w,U){let W=m0(w)?dQ(w):w,X=f0(w)?D2(w):w,A=u0(z),Z=u0(w);return T0(z)?YU(z,X,U):f2(w)?QU(z,w,U):A&&Z?x0("Omit",[z,W],U):!A&&Z?x0("Omit",[z,W],U):A&&!Z?x0("Omit",[z,W],U):D({...Vz(z,X),...U})}function hQ(z,w,U){return{[w]:L6(z,[w],V0(U))}}function cQ(z,w,U){return w.reduce((W,X)=>{return{...W,...hQ(z,X,U)}},{})}function iQ(z,w,U){return cQ(z,w.keys,U)}function QU(z,w,U){let W=iQ(z,w,U);return Q0(W)}function yQ(z,w,U){let W={};for(let X of globalThis.Object.getOwnPropertyNames(z))W[X]=N6(z[X],w,V0(U));return W}function vQ(z,w,U){return yQ(z.properties,w,U)}function JU(z,w,U){let W=vQ(z,w,U);return Q0(W)}function nQ(z,w){return z.map((U)=>kz(U,w))}function uQ(z,w){return z.map((U)=>kz(U,w))}function mQ(z,w){let U={};for(let W of w)if(W in z)U[W]=z[W];return U}function tQ(z,w){let U=y0(z,[j0,"$id","required","properties"]),W=mQ(z.properties,w);return G0(W,U)}function oQ(z){let w=z.reduce((U,W)=>$5(W)?[...U,A0(W)]:U,[]);return N0(w)}function kz(z,w){return i0(z)?B2(nQ(z.allOf,w)):Y0(z)?N0(uQ(z.anyOf,w)):o0(z)?tQ(z,w):G0({})}function N6(z,w,U){let W=m0(w)?oQ(w):w,X=f0(w)?D2(w):w,A=u0(z),Z=u0(w);return T0(z)?JU(z,X,U):f2(w)?BU(z,w,U):A&&Z?x0("Pick",[z,W],U):!A&&Z?x0("Pick",[z,W],U):A&&!Z?x0("Pick",[z,W],U):D({...kz(z,X),...U})}function pQ(z,w,U){return{[w]:N6(z,[w],V0(U))}}function lQ(z,w,U){return w.reduce((W,X)=>{return{...W,...pQ(z,X,U)}},{})}function sQ(z,w,U){return lQ(z,w.keys,U)}function BU(z,w,U){let W=sQ(z,w,U);return Q0(W)}function rQ(z,w){return x0("Partial",[x0(z,w)])}function aQ(z){return x0("Partial",[p2(z)])}function eQ(z){let w={};for(let U of globalThis.Object.getOwnPropertyNames(z))w[U]=J2(z[U]);return w}function zJ(z){let w=y0(z,[j0,"$id","required","properties"]),U=eQ(z.properties);return G0(U,w)}function MU(z){return z.map((w)=>qU(w))}function qU(z){return Q1(z)?rQ(z.target,z.parameters):u0(z)?aQ(z.$ref):i0(z)?B2(MU(z.allOf)):Y0(z)?N0(MU(z.anyOf)):o0(z)?zJ(z):x6(z)?z:n1(z)?z:M1(z)?z:g2(z)?z:V4(z)?z:q1(z)?z:u1(z)?z:k4(z)?z:m1(z)?z:G0({})}function L4(z,w){if(T0(z))return LU(z,w);else return D({...qU(z),...w})}function wJ(z,w){let U={};for(let W of globalThis.Object.getOwnPropertyNames(z))U[W]=L4(z[W],V0(w));return U}function UJ(z,w){return wJ(z.properties,w)}function LU(z,w){let U=UJ(z,w);return Q0(U)}function WJ(z,w){return x0("Required",[x0(z,w)])}function XJ(z){return x0("Required",[p2(z)])}function AJ(z){let w={};for(let U of globalThis.Object.getOwnPropertyNames(z))w[U]=y0(z[U],[A2]);return w}function ZJ(z){let w=y0(z,[j0,"$id","required","properties"]),U=AJ(z.properties);return G0(U,w)}function NU(z){return z.map((w)=>GU(w))}function GU(z){return Q1(z)?WJ(z.target,z.parameters):u0(z)?XJ(z.$ref):i0(z)?B2(NU(z.allOf)):Y0(z)?N0(NU(z.anyOf)):o0(z)?ZJ(z):x6(z)?z:n1(z)?z:M1(z)?z:g2(z)?z:V4(z)?z:q1(z)?z:u1(z)?z:k4(z)?z:m1(z)?z:G0({})}function N4(z,w){if(T0(z))return HU(z,w);else return D({...GU(z),...w})}function $J(z,w){let U={};for(let W of globalThis.Object.getOwnPropertyNames(z))U[W]=N4(z[W],w);return U}function YJ(z,w){return $J(z.properties,w)}function HU(z,w){let U=YJ(z,w);return Q0(U)}function QJ(z,w){return w.map((U)=>{return u0(U)?Tz(z,U.$ref):c2(z,U)})}function Tz(z,w){return w in z?u0(z[w])?Tz(z,z[w].$ref):c2(z,z[w]):p()}function JJ(z){return Y4(z[0])}function BJ(z){return M6(z[0],z[1])}function MJ(z){return Q4(z[0])}function qJ(z){return L4(z[0])}function LJ(z){return L6(z[0],z[1])}function NJ(z){return N6(z[0],z[1])}function GJ(z){return N4(z[0])}function HJ(z,w,U){let W=QJ(z,U);return w==="Awaited"?JJ(W):w==="Index"?BJ(W):w==="KeyOf"?MJ(W):w==="Partial"?qJ(W):w==="Omit"?LJ(W):w==="Pick"?NJ(W):w==="Required"?GJ(W):p()}function _J(z,w){return z4(c2(z,w))}function SJ(z,w){return w4(c2(z,w))}function DJ(z,w,U){return U4(n4(z,w),c2(z,U))}function PJ(z,w,U){return k1(n4(z,w),c2(z,U))}function OJ(z,w){return B2(n4(z,w))}function RJ(z,w){return $4(c2(z,w))}function CJ(z,w){return G0(globalThis.Object.keys(w).reduce((U,W)=>{return{...U,[W]:c2(z,w[W])}},{}))}function bJ(z,w){let[U,W]=[c2(z,F5(w)),K5(w)],X=l6(w);return X.patternProperties[W]=U,X}function KJ(z,w){return u0(w)?{...Tz(z,w.$ref),[j0]:w[j0]}:w}function FJ(z,w){return t2(n4(z,w))}function jJ(z,w){return N0(n4(z,w))}function n4(z,w){return w.map((U)=>c2(z,U))}function c2(z,w){return S2(w)?D(c2(z,y0(w,[A2])),w):r6(w)?D(c2(z,y0(w,[$1])),w):L0(w)?D(KJ(z,w),w):Y1(w)?D(_J(z,w.items),w):I6(w)?D(SJ(z,w.items),w):Q1(w)?D(HJ(z,w.target,w.parameters)):J1(w)?D(DJ(z,w.parameters,w.returns),w):B1(w)?D(PJ(z,w.parameters,w.returns),w):i0(w)?D(OJ(z,w.allOf),w):V6(w)?D(RJ(z,w.items),w):o0(w)?D(CJ(z,w.properties),w):T6(w)?D(bJ(z,w)):h2(w)?D(FJ(z,w.items||[]),w):Y0(w)?D(jJ(z,w.anyOf),w):w}function EJ(z,w){return w in z?c2(z,z[w]):p()}function _U(z){return globalThis.Object.getOwnPropertyNames(z).reduce((w,U)=>{return{...w,[U]:EJ(z,U)}},{})}class SU{constructor(z){let w=_U(z),U=this.WithIdentifiers(w);this.$defs=U}Import(z,w){let U={...this.$defs,[z]:D(this.$defs[z],w)};return D({[H]:"Import",$defs:U,$ref:z})}WithIdentifiers(z){return globalThis.Object.getOwnPropertyNames(z).reduce((w,U)=>{return{...w,[U]:{...z[U],$id:U}}},{})}}function DU(z){return new SU(z)}function PU(z,w){return D({[H]:"Not",not:z},w)}function OU(z,w){return B1(z)?t2(z.parameters,w):p()}var IJ=0;function RU(z,w={}){if(t0(w.$id))w.$id=`T${IJ++}`;let U=l6(z({[H]:"This",$ref:`${w.$id}`}));return U.$id=w.$id,D({[u2]:"Recursive",...U},w)}function CU(z,w){let U=F0(z)?new globalThis.RegExp(z):z;return D({[H]:"RegExp",type:"RegExp",source:U.source,flags:U.flags},w)}function xJ(z){return i0(z)?z.allOf:Y0(z)?z.anyOf:h2(z)?z.items??[]:[]}function bU(z){return xJ(z)}function KU(z,w){return B1(z)?D(z.returns,w):p(w)}class FU{constructor(z){this.schema=z}Decode(z){return new jU(this.schema,z)}}class jU{constructor(z,w){this.schema=z,this.decode=w}EncodeTransform(z,w){let X={Encode:(A)=>w[j0].Encode(z(A)),Decode:(A)=>this.decode(w[j0].Decode(A))};return{...w,[j0]:X}}EncodeSchema(z,w){let U={Decode:this.decode,Encode:z};return{...w,[j0]:U}}Encode(z){return L0(this.schema)?this.EncodeTransform(z,this.schema):this.EncodeSchema(z,this.schema)}}function EU(z){return new FU(z)}function j5(z={}){return D({[H]:z[H]??"Unsafe"},z)}function IU(z){return D({[H]:"Void",type:"void"},z)}var gz={};K6(gz,{Void:()=>IU,Uppercase:()=>$U,Unsafe:()=>j5,Unknown:()=>L1,Union:()=>N0,Undefined:()=>S5,Uncapitalize:()=>ZU,Uint8Array:()=>D5,Tuple:()=>t2,Transform:()=>EU,TemplateLiteral:()=>M5,Symbol:()=>_5,String:()=>G2,ReturnType:()=>KU,Rest:()=>bU,Required:()=>N4,RegExp:()=>CU,Ref:()=>p2,Recursive:()=>RU,Record:()=>b5,ReadonlyOptional:()=>C5,Readonly:()=>P2,Promise:()=>L5,Pick:()=>N6,Partial:()=>L4,Parameters:()=>OU,Optional:()=>J2,Omit:()=>L6,Object:()=>G0,Number:()=>m2,Null:()=>H5,Not:()=>PU,Never:()=>p,Module:()=>DU,Mapped:()=>R7,Lowercase:()=>AU,Literal:()=>A0,KeyOf:()=>Q4,Iterator:()=>$4,Intersect:()=>B2,Integer:()=>zU,Instantiate:()=>e7,InstanceType:()=>r7,Index:()=>M6,Function:()=>k1,Extract:()=>q4,Extends:()=>B4,Exclude:()=>M4,Enum:()=>V7,Date:()=>G5,ConstructorParameters:()=>x7,Constructor:()=>U4,Const:()=>I7,Composite:()=>E7,Capitalize:()=>XU,Boolean:()=>B5,BigInt:()=>Z4,Awaited:()=>Y4,AsyncIterator:()=>w4,Array:()=>z4,Argument:()=>$7,Any:()=>B6});var G6=gz;function VJ(z){switch(z.errorType){case _.ArrayContains:return"Expected array to contain at least one matching value";case _.ArrayMaxContains:return`Expected array to contain no more than ${z.schema.maxContains} matching values`;case _.ArrayMinContains:return`Expected array to contain at least ${z.schema.minContains} matching values`;case _.ArrayMaxItems:return`Expected array length to be less or equal to ${z.schema.maxItems}`;case _.ArrayMinItems:return`Expected array length to be greater or equal to ${z.schema.minItems}`;case _.ArrayUniqueItems:return"Expected array elements to be unique";case _.Array:return"Expected array";case _.AsyncIterator:return"Expected AsyncIterator";case _.BigIntExclusiveMaximum:return`Expected bigint to be less than ${z.schema.exclusiveMaximum}`;case _.BigIntExclusiveMinimum:return`Expected bigint to be greater than ${z.schema.exclusiveMinimum}`;case _.BigIntMaximum:return`Expected bigint to be less or equal to ${z.schema.maximum}`;case _.BigIntMinimum:return`Expected bigint to be greater or equal to ${z.schema.minimum}`;case _.BigIntMultipleOf:return`Expected bigint to be a multiple of ${z.schema.multipleOf}`;case _.BigInt:return"Expected bigint";case _.Boolean:return"Expected boolean";case _.DateExclusiveMinimumTimestamp:return`Expected Date timestamp to be greater than ${z.schema.exclusiveMinimumTimestamp}`;case _.DateExclusiveMaximumTimestamp:return`Expected Date timestamp to be less than ${z.schema.exclusiveMaximumTimestamp}`;case _.DateMinimumTimestamp:return`Expected Date timestamp to be greater or equal to ${z.schema.minimumTimestamp}`;case _.DateMaximumTimestamp:return`Expected Date timestamp to be less or equal to ${z.schema.maximumTimestamp}`;case _.DateMultipleOfTimestamp:return`Expected Date timestamp to be a multiple of ${z.schema.multipleOfTimestamp}`;case _.Date:return"Expected Date";case _.Function:return"Expected function";case _.IntegerExclusiveMaximum:return`Expected integer to be less than ${z.schema.exclusiveMaximum}`;case _.IntegerExclusiveMinimum:return`Expected integer to be greater than ${z.schema.exclusiveMinimum}`;case _.IntegerMaximum:return`Expected integer to be less or equal to ${z.schema.maximum}`;case _.IntegerMinimum:return`Expected integer to be greater or equal to ${z.schema.minimum}`;case _.IntegerMultipleOf:return`Expected integer to be a multiple of ${z.schema.multipleOf}`;case _.Integer:return"Expected integer";case _.IntersectUnevaluatedProperties:return"Unexpected property";case _.Intersect:return"Expected all values to match";case _.Iterator:return"Expected Iterator";case _.Literal:return`Expected ${typeof z.schema.const==="string"?`'${z.schema.const}'`:z.schema.const}`;case _.Never:return"Never";case _.Not:return"Value should not match";case _.Null:return"Expected null";case _.NumberExclusiveMaximum:return`Expected number to be less than ${z.schema.exclusiveMaximum}`;case _.NumberExclusiveMinimum:return`Expected number to be greater than ${z.schema.exclusiveMinimum}`;case _.NumberMaximum:return`Expected number to be less or equal to ${z.schema.maximum}`;case _.NumberMinimum:return`Expected number to be greater or equal to ${z.schema.minimum}`;case _.NumberMultipleOf:return`Expected number to be a multiple of ${z.schema.multipleOf}`;case _.Number:return"Expected number";case _.Object:return"Expected object";case _.ObjectAdditionalProperties:return"Unexpected property";case _.ObjectMaxProperties:return`Expected object to have no more than ${z.schema.maxProperties} properties`;case _.ObjectMinProperties:return`Expected object to have at least ${z.schema.minProperties} properties`;case _.ObjectRequiredProperty:return"Expected required property";case _.Promise:return"Expected Promise";case _.RegExp:return"Expected string to match regular expression";case _.StringFormatUnknown:return`Unknown format '${z.schema.format}'`;case _.StringFormat:return`Expected string to match '${z.schema.format}' format`;case _.StringMaxLength:return`Expected string length less or equal to ${z.schema.maxLength}`;case _.StringMinLength:return`Expected string length greater or equal to ${z.schema.minLength}`;case _.StringPattern:return`Expected string to match '${z.schema.pattern}'`;case _.String:return"Expected string";case _.Symbol:return"Expected symbol";case _.TupleLength:return`Expected tuple to have ${z.schema.maxItems||0} elements`;case _.Tuple:return"Expected tuple";case _.Uint8ArrayMaxByteLength:return`Expected byte length less or equal to ${z.schema.maxByteLength}`;case _.Uint8ArrayMinByteLength:return`Expected byte length greater or equal to ${z.schema.minByteLength}`;case _.Uint8Array:return"Expected Uint8Array";case _.Undefined:return"Expected undefined";case _.Union:return"Expected union value";case _.Void:return"Expected void";case _.Kind:return`Expected kind '${z.schema[H]}'`;default:return"Unknown error type"}}var kJ=VJ;function xU(){return kJ}class VU extends n{constructor(z){super(`Unable to dereference schema with $id '${z.$ref}'`);this.schema=z}}function TJ(z,w){let U=w.find((W)=>W.$id===z.$ref);if(U===void 0)throw new VU(z);return J0(U,w)}function z2(z,w){if(!$0(z.$id)||w.some((U)=>U.$id===z.$id))return w;return w.push(z),w}function J0(z,w){return z[H]==="This"||z[H]==="Ref"?TJ(z,w):z}class kU extends n{constructor(z){super("Unable to hash value");this.value=z}}var i2;(function(z){z[z.Undefined=0]="Undefined",z[z.Null=1]="Null",z[z.Boolean=2]="Boolean",z[z.Number=3]="Number",z[z.String=4]="String",z[z.Object=5]="Object",z[z.Array=6]="Array",z[z.Date=7]="Date",z[z.Uint8Array=8]="Uint8Array",z[z.Symbol=9]="Symbol",z[z.BigInt=10]="BigInt"})(i2||(i2={}));var G4=BigInt("14695981039346656037"),[gJ,fJ]=[BigInt("1099511628211"),BigInt("18446744073709551616")],dJ=Array.from({length:256}).map((z,w)=>BigInt(w)),TU=new Float64Array(1),gU=new DataView(TU.buffer),fU=new Uint8Array(TU.buffer);function*hJ(z){let w=z===0?1:Math.ceil(Math.floor(Math.log2(z)+1)/8);for(let U=0;U<w;U++)yield z>>8*(w-1-U)&255}function cJ(z){q2(i2.Array);for(let w of z)H4(w)}function iJ(z){q2(i2.Boolean),q2(z?1:0)}function yJ(z){q2(i2.BigInt),gU.setBigInt64(0,z);for(let w of fU)q2(w)}function vJ(z){q2(i2.Date),H4(z.getTime())}function nJ(z){q2(i2.Null)}function uJ(z){q2(i2.Number),gU.setFloat64(0,z);for(let w of fU)q2(w)}function mJ(z){q2(i2.Object);for(let w of globalThis.Object.getOwnPropertyNames(z).sort())H4(w),H4(z[w])}function tJ(z){q2(i2.String);for(let w=0;w<z.length;w++)for(let U of hJ(z.charCodeAt(w)))q2(U)}function oJ(z){q2(i2.Symbol),H4(z.description)}function pJ(z){q2(i2.Uint8Array);for(let w=0;w<z.length;w++)q2(z[w])}function lJ(z){return q2(i2.Undefined)}function H4(z){if(m(z))return cJ(z);if(I1(z))return iJ(z);if(X2(z))return yJ(z);if(N2(z))return vJ(z);if(y1(z))return nJ(z);if(v(z))return uJ(z);if(l(z))return mJ(z);if($0(z))return tJ(z);if(v1(z))return oJ(z);if(s6(z))return pJ(z);if(k0(z))return lJ(z);throw new kU(z)}function q2(z){G4=G4^dJ[z],G4=G4*gJ%fJ}function H6(z){return G4=BigInt("14695981039346656037"),H4(z),G4}class dU extends n{constructor(z){super("Unknown type");this.schema=z}}function sJ(z){return z[H]==="Any"||z[H]==="Unknown"}function U0(z){return z!==void 0}function rJ(z,w,U){return!0}function aJ(z,w,U){return!0}function eJ(z,w,U){if(!m(U))return!1;if(U0(z.minItems)&&!(U.length>=z.minItems))return!1;if(U0(z.maxItems)&&!(U.length<=z.maxItems))return!1;if(!U.every((A)=>w2(z.items,w,A)))return!1;if(z.uniqueItems===!0&&!function(){let A=new Set;for(let Z of U){let $=H6(Z);if(A.has($))return!1;else A.add($)}return!0}())return!1;if(!(U0(z.contains)||v(z.minContains)||v(z.maxContains)))return!0;let W=U0(z.contains)?z.contains:p(),X=U.reduce((A,Z)=>w2(W,w,Z)?A+1:A,0);if(X===0)return!1;if(v(z.minContains)&&X<z.minContains)return!1;if(v(z.maxContains)&&X>z.maxContains)return!1;return!0}function zB(z,w,U){return W5(U)}function wB(z,w,U){if(!X2(U))return!1;if(U0(z.exclusiveMaximum)&&!(U<z.exclusiveMaximum))return!1;if(U0(z.exclusiveMinimum)&&!(U>z.exclusiveMinimum))return!1;if(U0(z.maximum)&&!(U<=z.maximum))return!1;if(U0(z.minimum)&&!(U>=z.minimum))return!1;if(U0(z.multipleOf)&&U%z.multipleOf!==BigInt(0))return!1;return!0}function UB(z,w,U){return I1(U)}function WB(z,w,U){return w2(z.returns,w,U.prototype)}function XB(z,w,U){if(!N2(U))return!1;if(U0(z.exclusiveMaximumTimestamp)&&!(U.getTime()<z.exclusiveMaximumTimestamp))return!1;if(U0(z.exclusiveMinimumTimestamp)&&!(U.getTime()>z.exclusiveMinimumTimestamp))return!1;if(U0(z.maximumTimestamp)&&!(U.getTime()<=z.maximumTimestamp))return!1;if(U0(z.minimumTimestamp)&&!(U.getTime()>=z.minimumTimestamp))return!1;if(U0(z.multipleOfTimestamp)&&U.getTime()%z.multipleOfTimestamp!==0)return!1;return!0}function AB(z,w,U){return Y6(U)}function ZB(z,w,U){let W=globalThis.Object.values(z.$defs),X=z.$defs[z.$ref];return w2(X,[...w,...W],U)}function $B(z,w,U){if(!Z5(U))return!1;if(U0(z.exclusiveMaximum)&&!(U<z.exclusiveMaximum))return!1;if(U0(z.exclusiveMinimum)&&!(U>z.exclusiveMinimum))return!1;if(U0(z.maximum)&&!(U<=z.maximum))return!1;if(U0(z.minimum)&&!(U>=z.minimum))return!1;if(U0(z.multipleOf)&&U%z.multipleOf!==0)return!1;return!0}function YB(z,w,U){let W=z.allOf.every((X)=>w2(X,w,U));if(z.unevaluatedProperties===!1){let X=new RegExp(p1(z)),A=Object.getOwnPropertyNames(U).every((Z)=>X.test(Z));return W&&A}else if(f0(z.unevaluatedProperties)){let X=new RegExp(p1(z)),A=Object.getOwnPropertyNames(U).every((Z)=>X.test(Z)||w2(z.unevaluatedProperties,w,U[Z]));return W&&A}else return W}function QB(z,w,U){return X5(U)}function JB(z,w,U){return U===z.const}function BB(z,w,U){return!1}function MB(z,w,U){return!w2(z.not,w,U)}function qB(z,w,U){return y1(U)}function LB(z,w,U){if(!I0.IsNumberLike(U))return!1;if(U0(z.exclusiveMaximum)&&!(U<z.exclusiveMaximum))return!1;if(U0(z.exclusiveMinimum)&&!(U>z.exclusiveMinimum))return!1;if(U0(z.minimum)&&!(U>=z.minimum))return!1;if(U0(z.maximum)&&!(U<=z.maximum))return!1;if(U0(z.multipleOf)&&U%z.multipleOf!==0)return!1;return!0}function NB(z,w,U){if(!I0.IsObjectLike(U))return!1;if(U0(z.minProperties)&&!(Object.getOwnPropertyNames(U).length>=z.minProperties))return!1;if(U0(z.maxProperties)&&!(Object.getOwnPropertyNames(U).length<=z.maxProperties))return!1;let W=Object.getOwnPropertyNames(z.properties);for(let X of W){let A=z.properties[X];if(z.required&&z.required.includes(X)){if(!w2(A,w,U[X]))return!1;if((l1(A)||sJ(A))&&!(X in U))return!1}else if(I0.IsExactOptionalProperty(U,X)&&!w2(A,w,U[X]))return!1}if(z.additionalProperties===!1){let X=Object.getOwnPropertyNames(U);if(z.required&&z.required.length===W.length&&X.length===W.length)return!0;else return X.every((A)=>W.includes(A))}else if(typeof z.additionalProperties==="object")return Object.getOwnPropertyNames(U).every((A)=>W.includes(A)||w2(z.additionalProperties,w,U[A]));else return!0}function GB(z,w,U){return A5(U)}function HB(z,w,U){if(!I0.IsRecordLike(U))return!1;if(U0(z.minProperties)&&!(Object.getOwnPropertyNames(U).length>=z.minProperties))return!1;if(U0(z.maxProperties)&&!(Object.getOwnPropertyNames(U).length<=z.maxProperties))return!1;let[W,X]=Object.entries(z.patternProperties)[0],A=new RegExp(W),Z=Object.entries(U).every(([Q,J])=>{return A.test(Q)?w2(X,w,J):!0}),$=typeof z.additionalProperties==="object"?Object.entries(U).every(([Q,J])=>{return!A.test(Q)?w2(z.additionalProperties,w,J):!0}):!0,Y=z.additionalProperties===!1?Object.getOwnPropertyNames(U).every((Q)=>{return A.test(Q)}):!0;return Z&&$&&Y}function _B(z,w,U){return w2(J0(z,w),w,U)}function SB(z,w,U){let W=new RegExp(z.source,z.flags);if(U0(z.minLength)){if(!(U.length>=z.minLength))return!1}if(U0(z.maxLength)){if(!(U.length<=z.maxLength))return!1}return W.test(U)}function DB(z,w,U){if(!$0(U))return!1;if(U0(z.minLength)){if(!(U.length>=z.minLength))return!1}if(U0(z.maxLength)){if(!(U.length<=z.maxLength))return!1}if(U0(z.pattern)){if(!new RegExp(z.pattern).test(U))return!1}if(U0(z.format)){if(!D0.Has(z.format))return!1;return D0.Get(z.format)(U)}return!0}function PB(z,w,U){return v1(U)}function OB(z,w,U){return $0(U)&&new RegExp(z.pattern).test(U)}function RB(z,w,U){return w2(J0(z,w),w,U)}function CB(z,w,U){if(!m(U))return!1;if(z.items===void 0&&U.length!==0)return!1;if(U.length!==z.maxItems)return!1;if(!z.items)return!0;for(let W=0;W<z.items.length;W++)if(!w2(z.items[W],w,U[W]))return!1;return!0}function bB(z,w,U){return k0(U)}function KB(z,w,U){return z.anyOf.some((W)=>w2(W,w,U))}function FB(z,w,U){if(!s6(U))return!1;if(U0(z.maxByteLength)&&!(U.length<=z.maxByteLength))return!1;if(U0(z.minByteLength)&&!(U.length>=z.minByteLength))return!1;return!0}function jB(z,w,U){return!0}function EB(z,w,U){return I0.IsVoidLike(U)}function IB(z,w,U){if(!p0.Has(z[H]))return!1;return p0.Get(z[H])(z,U)}function w2(z,w,U){let W=U0(z.$id)?z2(z,w):w,X=z;switch(X[H]){case"Any":return rJ(X,W,U);case"Argument":return aJ(X,W,U);case"Array":return eJ(X,W,U);case"AsyncIterator":return zB(X,W,U);case"BigInt":return wB(X,W,U);case"Boolean":return UB(X,W,U);case"Constructor":return WB(X,W,U);case"Date":return XB(X,W,U);case"Function":return AB(X,W,U);case"Import":return ZB(X,W,U);case"Integer":return $B(X,W,U);case"Intersect":return YB(X,W,U);case"Iterator":return QB(X,W,U);case"Literal":return JB(X,W,U);case"Never":return BB(X,W,U);case"Not":return MB(X,W,U);case"Null":return qB(X,W,U);case"Number":return LB(X,W,U);case"Object":return NB(X,W,U);case"Promise":return GB(X,W,U);case"Record":return HB(X,W,U);case"Ref":return _B(X,W,U);case"RegExp":return SB(X,W,U);case"String":return DB(X,W,U);case"Symbol":return PB(X,W,U);case"TemplateLiteral":return OB(X,W,U);case"This":return RB(X,W,U);case"Tuple":return CB(X,W,U);case"Undefined":return bB(X,W,U);case"Union":return KB(X,W,U);case"Uint8Array":return FB(X,W,U);case"Unknown":return jB(X,W,U);case"Void":return EB(X,W,U);default:if(!p0.Has(X[H]))throw new dU(X);return IB(X,W,U)}}function s(...z){return z.length===3?w2(z[0],z[1],z[2]):w2(z[0],[],z[1])}var _;(function(z){z[z.ArrayContains=0]="ArrayContains",z[z.ArrayMaxContains=1]="ArrayMaxContains",z[z.ArrayMaxItems=2]="ArrayMaxItems",z[z.ArrayMinContains=3]="ArrayMinContains",z[z.ArrayMinItems=4]="ArrayMinItems",z[z.ArrayUniqueItems=5]="ArrayUniqueItems",z[z.Array=6]="Array",z[z.AsyncIterator=7]="AsyncIterator",z[z.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",z[z.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",z[z.BigIntMaximum=10]="BigIntMaximum",z[z.BigIntMinimum=11]="BigIntMinimum",z[z.BigIntMultipleOf=12]="BigIntMultipleOf",z[z.BigInt=13]="BigInt",z[z.Boolean=14]="Boolean",z[z.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",z[z.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",z[z.DateMaximumTimestamp=17]="DateMaximumTimestamp",z[z.DateMinimumTimestamp=18]="DateMinimumTimestamp",z[z.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",z[z.Date=20]="Date",z[z.Function=21]="Function",z[z.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",z[z.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",z[z.IntegerMaximum=24]="IntegerMaximum",z[z.IntegerMinimum=25]="IntegerMinimum",z[z.IntegerMultipleOf=26]="IntegerMultipleOf",z[z.Integer=27]="Integer",z[z.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",z[z.Intersect=29]="Intersect",z[z.Iterator=30]="Iterator",z[z.Kind=31]="Kind",z[z.Literal=32]="Literal",z[z.Never=33]="Never",z[z.Not=34]="Not",z[z.Null=35]="Null",z[z.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",z[z.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",z[z.NumberMaximum=38]="NumberMaximum",z[z.NumberMinimum=39]="NumberMinimum",z[z.NumberMultipleOf=40]="NumberMultipleOf",z[z.Number=41]="Number",z[z.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",z[z.ObjectMaxProperties=43]="ObjectMaxProperties",z[z.ObjectMinProperties=44]="ObjectMinProperties",z[z.ObjectRequiredProperty=45]="ObjectRequiredProperty",z[z.Object=46]="Object",z[z.Promise=47]="Promise",z[z.RegExp=48]="RegExp",z[z.StringFormatUnknown=49]="StringFormatUnknown",z[z.StringFormat=50]="StringFormat",z[z.StringMaxLength=51]="StringMaxLength",z[z.StringMinLength=52]="StringMinLength",z[z.StringPattern=53]="StringPattern",z[z.String=54]="String",z[z.Symbol=55]="Symbol",z[z.TupleLength=56]="TupleLength",z[z.Tuple=57]="Tuple",z[z.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",z[z.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",z[z.Uint8Array=60]="Uint8Array",z[z.Undefined=61]="Undefined",z[z.Union=62]="Union",z[z.Void=63]="Void"})(_||(_={}));class hU extends n{constructor(z){super("Unknown type");this.schema=z}}function s1(z){return z.replace(/~/g,"~0").replace(/\//g,"~1")}function W0(z){return z!==void 0}class h6{constructor(z){this.iterator=z}[Symbol.iterator](){return this.iterator}First(){let z=this.iterator.next();return z.done?void 0:z.value}}function V(z,w,U,W,X=[]){return{type:z,schema:w,path:U,value:W,message:xU()({errorType:z,path:U,schema:w,value:W,errors:X}),errors:X}}function*xB(z,w,U,W){}function*VB(z,w,U,W){}function*kB(z,w,U,W){if(!m(W))return yield V(_.Array,z,U,W);if(W0(z.minItems)&&!(W.length>=z.minItems))yield V(_.ArrayMinItems,z,U,W);if(W0(z.maxItems)&&!(W.length<=z.maxItems))yield V(_.ArrayMaxItems,z,U,W);for(let Z=0;Z<W.length;Z++)yield*U2(z.items,w,`${U}/${Z}`,W[Z]);if(z.uniqueItems===!0&&!function(){let Z=new Set;for(let $ of W){let Y=H6($);if(Z.has(Y))return!1;else Z.add(Y)}return!0}())yield V(_.ArrayUniqueItems,z,U,W);if(!(W0(z.contains)||W0(z.minContains)||W0(z.maxContains)))return;let X=W0(z.contains)?z.contains:p(),A=W.reduce((Z,$,Y)=>U2(X,w,`${U}${Y}`,$).next().done===!0?Z+1:Z,0);if(A===0)yield V(_.ArrayContains,z,U,W);if(v(z.minContains)&&A<z.minContains)yield V(_.ArrayMinContains,z,U,W);if(v(z.maxContains)&&A>z.maxContains)yield V(_.ArrayMaxContains,z,U,W)}function*TB(z,w,U,W){if(!W5(W))yield V(_.AsyncIterator,z,U,W)}function*gB(z,w,U,W){if(!X2(W))return yield V(_.BigInt,z,U,W);if(W0(z.exclusiveMaximum)&&!(W<z.exclusiveMaximum))yield V(_.BigIntExclusiveMaximum,z,U,W);if(W0(z.exclusiveMinimum)&&!(W>z.exclusiveMinimum))yield V(_.BigIntExclusiveMinimum,z,U,W);if(W0(z.maximum)&&!(W<=z.maximum))yield V(_.BigIntMaximum,z,U,W);if(W0(z.minimum)&&!(W>=z.minimum))yield V(_.BigIntMinimum,z,U,W);if(W0(z.multipleOf)&&W%z.multipleOf!==BigInt(0))yield V(_.BigIntMultipleOf,z,U,W)}function*fB(z,w,U,W){if(!I1(W))yield V(_.Boolean,z,U,W)}function*dB(z,w,U,W){yield*U2(z.returns,w,U,W.prototype)}function*hB(z,w,U,W){if(!N2(W))return yield V(_.Date,z,U,W);if(W0(z.exclusiveMaximumTimestamp)&&!(W.getTime()<z.exclusiveMaximumTimestamp))yield V(_.DateExclusiveMaximumTimestamp,z,U,W);if(W0(z.exclusiveMinimumTimestamp)&&!(W.getTime()>z.exclusiveMinimumTimestamp))yield V(_.DateExclusiveMinimumTimestamp,z,U,W);if(W0(z.maximumTimestamp)&&!(W.getTime()<=z.maximumTimestamp))yield V(_.DateMaximumTimestamp,z,U,W);if(W0(z.minimumTimestamp)&&!(W.getTime()>=z.minimumTimestamp))yield V(_.DateMinimumTimestamp,z,U,W);if(W0(z.multipleOfTimestamp)&&W.getTime()%z.multipleOfTimestamp!==0)yield V(_.DateMultipleOfTimestamp,z,U,W)}function*cB(z,w,U,W){if(!Y6(W))yield V(_.Function,z,U,W)}function*iB(z,w,U,W){let X=globalThis.Object.values(z.$defs),A=z.$defs[z.$ref];yield*U2(A,[...w,...X],U,W)}function*yB(z,w,U,W){if(!Z5(W))return yield V(_.Integer,z,U,W);if(W0(z.exclusiveMaximum)&&!(W<z.exclusiveMaximum))yield V(_.IntegerExclusiveMaximum,z,U,W);if(W0(z.exclusiveMinimum)&&!(W>z.exclusiveMinimum))yield V(_.IntegerExclusiveMinimum,z,U,W);if(W0(z.maximum)&&!(W<=z.maximum))yield V(_.IntegerMaximum,z,U,W);if(W0(z.minimum)&&!(W>=z.minimum))yield V(_.IntegerMinimum,z,U,W);if(W0(z.multipleOf)&&W%z.multipleOf!==0)yield V(_.IntegerMultipleOf,z,U,W)}function*vB(z,w,U,W){let X=!1;for(let A of z.allOf)for(let Z of U2(A,w,U,W))X=!0,yield Z;if(X)return yield V(_.Intersect,z,U,W);if(z.unevaluatedProperties===!1){let A=new RegExp(p1(z));for(let Z of Object.getOwnPropertyNames(W))if(!A.test(Z))yield V(_.IntersectUnevaluatedProperties,z,`${U}/${Z}`,W)}if(typeof z.unevaluatedProperties==="object"){let A=new RegExp(p1(z));for(let Z of Object.getOwnPropertyNames(W))if(!A.test(Z)){let $=U2(z.unevaluatedProperties,w,`${U}/${Z}`,W[Z]).next();if(!$.done)yield $.value}}}function*nB(z,w,U,W){if(!X5(W))yield V(_.Iterator,z,U,W)}function*uB(z,w,U,W){if(W!==z.const)yield V(_.Literal,z,U,W)}function*mB(z,w,U,W){yield V(_.Never,z,U,W)}function*tB(z,w,U,W){if(U2(z.not,w,U,W).next().done===!0)yield V(_.Not,z,U,W)}function*oB(z,w,U,W){if(!y1(W))yield V(_.Null,z,U,W)}function*pB(z,w,U,W){if(!I0.IsNumberLike(W))return yield V(_.Number,z,U,W);if(W0(z.exclusiveMaximum)&&!(W<z.exclusiveMaximum))yield V(_.NumberExclusiveMaximum,z,U,W);if(W0(z.exclusiveMinimum)&&!(W>z.exclusiveMinimum))yield V(_.NumberExclusiveMinimum,z,U,W);if(W0(z.maximum)&&!(W<=z.maximum))yield V(_.NumberMaximum,z,U,W);if(W0(z.minimum)&&!(W>=z.minimum))yield V(_.NumberMinimum,z,U,W);if(W0(z.multipleOf)&&W%z.multipleOf!==0)yield V(_.NumberMultipleOf,z,U,W)}function*lB(z,w,U,W){if(!I0.IsObjectLike(W))return yield V(_.Object,z,U,W);if(W0(z.minProperties)&&!(Object.getOwnPropertyNames(W).length>=z.minProperties))yield V(_.ObjectMinProperties,z,U,W);if(W0(z.maxProperties)&&!(Object.getOwnPropertyNames(W).length<=z.maxProperties))yield V(_.ObjectMaxProperties,z,U,W);let X=Array.isArray(z.required)?z.required:[],A=Object.getOwnPropertyNames(z.properties),Z=Object.getOwnPropertyNames(W);for(let $ of X){if(Z.includes($))continue;yield V(_.ObjectRequiredProperty,z.properties[$],`${U}/${s1($)}`,void 0)}if(z.additionalProperties===!1){for(let $ of Z)if(!A.includes($))yield V(_.ObjectAdditionalProperties,z,`${U}/${s1($)}`,W[$])}if(typeof z.additionalProperties==="object")for(let $ of Z){if(A.includes($))continue;yield*U2(z.additionalProperties,w,`${U}/${s1($)}`,W[$])}for(let $ of A){let Y=z.properties[$];if(z.required&&z.required.includes($)){if(yield*U2(Y,w,`${U}/${s1($)}`,W[$]),l1(z)&&!($ in W))yield V(_.ObjectRequiredProperty,Y,`${U}/${s1($)}`,void 0)}else if(I0.IsExactOptionalProperty(W,$))yield*U2(Y,w,`${U}/${s1($)}`,W[$])}}function*sB(z,w,U,W){if(!A5(W))yield V(_.Promise,z,U,W)}function*rB(z,w,U,W){if(!I0.IsRecordLike(W))return yield V(_.Object,z,U,W);if(W0(z.minProperties)&&!(Object.getOwnPropertyNames(W).length>=z.minProperties))yield V(_.ObjectMinProperties,z,U,W);if(W0(z.maxProperties)&&!(Object.getOwnPropertyNames(W).length<=z.maxProperties))yield V(_.ObjectMaxProperties,z,U,W);let[X,A]=Object.entries(z.patternProperties)[0],Z=new RegExp(X);for(let[$,Y]of Object.entries(W))if(Z.test($))yield*U2(A,w,`${U}/${s1($)}`,Y);if(typeof z.additionalProperties==="object"){for(let[$,Y]of Object.entries(W))if(!Z.test($))yield*U2(z.additionalProperties,w,`${U}/${s1($)}`,Y)}if(z.additionalProperties===!1)for(let[$,Y]of Object.entries(W)){if(Z.test($))continue;return yield V(_.ObjectAdditionalProperties,z,`${U}/${s1($)}`,Y)}}function*aB(z,w,U,W){yield*U2(J0(z,w),w,U,W)}function*eB(z,w,U,W){if(!$0(W))return yield V(_.String,z,U,W);if(W0(z.minLength)&&!(W.length>=z.minLength))yield V(_.StringMinLength,z,U,W);if(W0(z.maxLength)&&!(W.length<=z.maxLength))yield V(_.StringMaxLength,z,U,W);if(!new RegExp(z.source,z.flags).test(W))return yield V(_.RegExp,z,U,W)}function*zM(z,w,U,W){if(!$0(W))return yield V(_.String,z,U,W);if(W0(z.minLength)&&!(W.length>=z.minLength))yield V(_.StringMinLength,z,U,W);if(W0(z.maxLength)&&!(W.length<=z.maxLength))yield V(_.StringMaxLength,z,U,W);if($0(z.pattern)){if(!new RegExp(z.pattern).test(W))yield V(_.StringPattern,z,U,W)}if($0(z.format)){if(!D0.Has(z.format))yield V(_.StringFormatUnknown,z,U,W);else if(!D0.Get(z.format)(W))yield V(_.StringFormat,z,U,W)}}function*wM(z,w,U,W){if(!v1(W))yield V(_.Symbol,z,U,W)}function*UM(z,w,U,W){if(!$0(W))return yield V(_.String,z,U,W);if(!new RegExp(z.pattern).test(W))yield V(_.StringPattern,z,U,W)}function*WM(z,w,U,W){yield*U2(J0(z,w),w,U,W)}function*XM(z,w,U,W){if(!m(W))return yield V(_.Tuple,z,U,W);if(z.items===void 0&&W.length!==0)return yield V(_.TupleLength,z,U,W);if(W.length!==z.maxItems)return yield V(_.TupleLength,z,U,W);if(!z.items)return;for(let X=0;X<z.items.length;X++)yield*U2(z.items[X],w,`${U}/${X}`,W[X])}function*AM(z,w,U,W){if(!k0(W))yield V(_.Undefined,z,U,W)}function*ZM(z,w,U,W){if(s(z,w,W))return;let X=z.anyOf.map((A)=>new h6(U2(A,w,U,W)));yield V(_.Union,z,U,W,X)}function*$M(z,w,U,W){if(!s6(W))return yield V(_.Uint8Array,z,U,W);if(W0(z.maxByteLength)&&!(W.length<=z.maxByteLength))yield V(_.Uint8ArrayMaxByteLength,z,U,W);if(W0(z.minByteLength)&&!(W.length>=z.minByteLength))yield V(_.Uint8ArrayMinByteLength,z,U,W)}function*YM(z,w,U,W){}function*QM(z,w,U,W){if(!I0.IsVoidLike(W))yield V(_.Void,z,U,W)}function*JM(z,w,U,W){if(!p0.Get(z[H])(z,W))yield V(_.Kind,z,U,W)}function*U2(z,w,U,W){let X=W0(z.$id)?[...w,z]:w,A=z;switch(A[H]){case"Any":return yield*xB(A,X,U,W);case"Argument":return yield*VB(A,X,U,W);case"Array":return yield*kB(A,X,U,W);case"AsyncIterator":return yield*TB(A,X,U,W);case"BigInt":return yield*gB(A,X,U,W);case"Boolean":return yield*fB(A,X,U,W);case"Constructor":return yield*dB(A,X,U,W);case"Date":return yield*hB(A,X,U,W);case"Function":return yield*cB(A,X,U,W);case"Import":return yield*iB(A,X,U,W);case"Integer":return yield*yB(A,X,U,W);case"Intersect":return yield*vB(A,X,U,W);case"Iterator":return yield*nB(A,X,U,W);case"Literal":return yield*uB(A,X,U,W);case"Never":return yield*mB(A,X,U,W);case"Not":return yield*tB(A,X,U,W);case"Null":return yield*oB(A,X,U,W);case"Number":return yield*pB(A,X,U,W);case"Object":return yield*lB(A,X,U,W);case"Promise":return yield*sB(A,X,U,W);case"Record":return yield*rB(A,X,U,W);case"Ref":return yield*aB(A,X,U,W);case"RegExp":return yield*eB(A,X,U,W);case"String":return yield*zM(A,X,U,W);case"Symbol":return yield*wM(A,X,U,W);case"TemplateLiteral":return yield*UM(A,X,U,W);case"This":return yield*WM(A,X,U,W);case"Tuple":return yield*XM(A,X,U,W);case"Undefined":return yield*AM(A,X,U,W);case"Union":return yield*ZM(A,X,U,W);case"Uint8Array":return yield*$M(A,X,U,W);case"Unknown":return yield*YM(A,X,U,W);case"Void":return yield*QM(A,X,U,W);default:if(!p0.Has(A[H]))throw new hU(z);return yield*JM(A,X,U,W)}}function g1(...z){let w=z.length===3?U2(z[0],z[1],"",z[2]):U2(z[0],[],"",z[1]);return new h6(w)}class u4 extends n{constructor(z,w,U){super("Unable to decode value as it does not match the expected schema");this.schema=z,this.value=w,this.error=U}}class E5 extends n{constructor(z,w,U,W){super(W instanceof Error?W.message:"Unknown error");this.schema=z,this.path=w,this.value=U,this.error=W}}function d0(z,w,U){try{return L0(z)?z[j0].Decode(U):U}catch(W){throw new E5(z,w,U,W)}}function BM(z,w,U,W){return m(W)?d0(z,U,W.map((X,A)=>H1(z.items,w,`${U}/${A}`,X))):d0(z,U,W)}function MM(z,w,U,W){if(!l(W)||T2(W))return d0(z,U,W);let X=N5(z),A=X.map((J)=>J[0]),Z={...W};for(let[J,N]of X)if(J in Z)Z[J]=H1(N,w,`${U}/${J}`,Z[J]);if(!L0(z.unevaluatedProperties))return d0(z,U,Z);let $=Object.getOwnPropertyNames(Z),Y=z.unevaluatedProperties,Q={...Z};for(let J of $)if(!A.includes(J))Q[J]=d0(Y,`${U}/${J}`,Q[J]);return d0(z,U,Q)}function qM(z,w,U,W){let X=globalThis.Object.values(z.$defs),A=z.$defs[z.$ref],Z=H1(A,[...w,...X],U,W);return d0(z,U,Z)}function LM(z,w,U,W){return d0(z,U,H1(z.not,w,U,W))}function NM(z,w,U,W){if(!l(W))return d0(z,U,W);let X=O2(z),A={...W};for(let Q of X){if(!u(A,Q))continue;if(k0(A[Q])&&(!m1(z.properties[Q])||I0.IsExactOptionalProperty(A,Q)))continue;A[Q]=H1(z.properties[Q],w,`${U}/${Q}`,A[Q])}if(!f0(z.additionalProperties))return d0(z,U,A);let Z=Object.getOwnPropertyNames(A),$=z.additionalProperties,Y={...A};for(let Q of Z)if(!X.includes(Q))Y[Q]=d0($,`${U}/${Q}`,Y[Q]);return d0(z,U,Y)}function GM(z,w,U,W){if(!l(W))return d0(z,U,W);let X=Object.getOwnPropertyNames(z.patternProperties)[0],A=new RegExp(X),Z={...W};for(let J of Object.getOwnPropertyNames(W))if(A.test(J))Z[J]=H1(z.patternProperties[X],w,`${U}/${J}`,Z[J]);if(!f0(z.additionalProperties))return d0(z,U,Z);let $=Object.getOwnPropertyNames(Z),Y=z.additionalProperties,Q={...Z};for(let J of $)if(!A.test(J))Q[J]=d0(Y,`${U}/${J}`,Q[J]);return d0(z,U,Q)}function HM(z,w,U,W){let X=J0(z,w);return d0(z,U,H1(X,w,U,W))}function _M(z,w,U,W){let X=J0(z,w);return d0(z,U,H1(X,w,U,W))}function SM(z,w,U,W){return m(W)&&m(z.items)?d0(z,U,z.items.map((X,A)=>H1(X,w,`${U}/${A}`,W[A]))):d0(z,U,W)}function DM(z,w,U,W){for(let X of z.anyOf){if(!s(X,w,W))continue;let A=H1(X,w,U,W);return d0(z,U,A)}return d0(z,U,W)}function H1(z,w,U,W){let X=z2(z,w),A=z;switch(z[H]){case"Array":return BM(A,X,U,W);case"Import":return qM(A,X,U,W);case"Intersect":return MM(A,X,U,W);case"Not":return LM(A,X,U,W);case"Object":return NM(A,X,U,W);case"Record":return GM(A,X,U,W);case"Ref":return HM(A,X,U,W);case"Symbol":return d0(A,U,W);case"This":return _M(A,X,U,W);case"Tuple":return SM(A,X,U,W);case"Union":return DM(A,X,U,W);default:return d0(A,U,W)}}function _4(z,w,U){return H1(z,w,"",U)}class m4 extends n{constructor(z,w,U){super("The encoded value does not match the expected schema");this.schema=z,this.value=w,this.error=U}}class cU extends n{constructor(z,w,U,W){super(`${W instanceof Error?W.message:"Unknown error"}`);this.schema=z,this.path=w,this.value=U,this.error=W}}function Z2(z,w,U){try{return L0(z)?z[j0].Encode(U):U}catch(W){throw new cU(z,w,U,W)}}function PM(z,w,U,W){let X=Z2(z,U,W);return m(X)?X.map((A,Z)=>_1(z.items,w,`${U}/${Z}`,A)):X}function OM(z,w,U,W){let X=globalThis.Object.values(z.$defs),A=z.$defs[z.$ref],Z=Z2(z,U,W);return _1(A,[...w,...X],U,Z)}function RM(z,w,U,W){let X=Z2(z,U,W);if(!l(W)||T2(W))return X;let A=N5(z),Z=A.map((N)=>N[0]),$={...X};for(let[N,S]of A)if(N in $)$[N]=_1(S,w,`${U}/${N}`,$[N]);if(!L0(z.unevaluatedProperties))return $;let Y=Object.getOwnPropertyNames($),Q=z.unevaluatedProperties,J={...$};for(let N of Y)if(!Z.includes(N))J[N]=Z2(Q,`${U}/${N}`,J[N]);return J}function CM(z,w,U,W){return Z2(z.not,U,Z2(z,U,W))}function bM(z,w,U,W){let X=Z2(z,U,W);if(!l(X))return X;let A=O2(z),Z={...X};for(let J of A){if(!u(Z,J))continue;if(k0(Z[J])&&(!m1(z.properties[J])||I0.IsExactOptionalProperty(Z,J)))continue;Z[J]=_1(z.properties[J],w,`${U}/${J}`,Z[J])}if(!f0(z.additionalProperties))return Z;let $=Object.getOwnPropertyNames(Z),Y=z.additionalProperties,Q={...Z};for(let J of $)if(!A.includes(J))Q[J]=Z2(Y,`${U}/${J}`,Q[J]);return Q}function KM(z,w,U,W){let X=Z2(z,U,W);if(!l(W))return X;let A=Object.getOwnPropertyNames(z.patternProperties)[0],Z=new RegExp(A),$={...X};for(let N of Object.getOwnPropertyNames(W))if(Z.test(N))$[N]=_1(z.patternProperties[A],w,`${U}/${N}`,$[N]);if(!f0(z.additionalProperties))return $;let Y=Object.getOwnPropertyNames($),Q=z.additionalProperties,J={...$};for(let N of Y)if(!Z.test(N))J[N]=Z2(Q,`${U}/${N}`,J[N]);return J}function FM(z,w,U,W){let X=J0(z,w),A=_1(X,w,U,W);return Z2(z,U,A)}function jM(z,w,U,W){let X=J0(z,w),A=_1(X,w,U,W);return Z2(z,U,A)}function EM(z,w,U,W){let X=Z2(z,U,W);return m(z.items)?z.items.map((A,Z)=>_1(A,w,`${U}/${Z}`,X[Z])):[]}function IM(z,w,U,W){for(let X of z.anyOf){if(!s(X,w,W))continue;let A=_1(X,w,U,W);return Z2(z,U,A)}for(let X of z.anyOf){let A=_1(X,w,U,W);if(!s(z,w,A))continue;return Z2(z,U,A)}return Z2(z,U,W)}function _1(z,w,U,W){let X=z2(z,w),A=z;switch(z[H]){case"Array":return PM(A,X,U,W);case"Import":return OM(A,X,U,W);case"Intersect":return RM(A,X,U,W);case"Not":return CM(A,X,U,W);case"Object":return bM(A,X,U,W);case"Record":return KM(A,X,U,W);case"Ref":return FM(A,X,U,W);case"This":return jM(A,X,U,W);case"Tuple":return EM(A,X,U,W);case"Union":return IM(A,X,U,W);default:return Z2(A,U,W)}}function S4(z,w,U){return _1(z,w,"",U)}function xM(z,w){return L0(z)||a0(z.items,w)}function VM(z,w){return L0(z)||a0(z.items,w)}function kM(z,w){return L0(z)||a0(z.returns,w)||z.parameters.some((U)=>a0(U,w))}function TM(z,w){return L0(z)||a0(z.returns,w)||z.parameters.some((U)=>a0(U,w))}function gM(z,w){return L0(z)||L0(z.unevaluatedProperties)||z.allOf.some((U)=>a0(U,w))}function fM(z,w){let U=globalThis.Object.getOwnPropertyNames(z.$defs).reduce((X,A)=>[...X,z.$defs[A]],[]),W=z.$defs[z.$ref];return L0(z)||a0(W,[...U,...w])}function dM(z,w){return L0(z)||a0(z.items,w)}function hM(z,w){return L0(z)||a0(z.not,w)}function cM(z,w){return L0(z)||Object.values(z.properties).some((U)=>a0(U,w))||f0(z.additionalProperties)&&a0(z.additionalProperties,w)}function iM(z,w){return L0(z)||a0(z.item,w)}function yM(z,w){let U=Object.getOwnPropertyNames(z.patternProperties)[0],W=z.patternProperties[U];return L0(z)||a0(W,w)||f0(z.additionalProperties)&&L0(z.additionalProperties)}function vM(z,w){if(L0(z))return!0;return a0(J0(z,w),w)}function nM(z,w){if(L0(z))return!0;return a0(J0(z,w),w)}function uM(z,w){return L0(z)||!k0(z.items)&&z.items.some((U)=>a0(U,w))}function mM(z,w){return L0(z)||z.anyOf.some((U)=>a0(U,w))}function a0(z,w){let U=z2(z,w),W=z;if(z.$id&&fz.has(z.$id))return!1;if(z.$id)fz.add(z.$id);switch(z[H]){case"Array":return xM(W,U);case"AsyncIterator":return VM(W,U);case"Constructor":return kM(W,U);case"Function":return TM(W,U);case"Import":return fM(W,U);case"Intersect":return gM(W,U);case"Iterator":return dM(W,U);case"Not":return hM(W,U);case"Object":return cM(W,U);case"Promise":return iM(W,U);case"Record":return yM(W,U);case"Ref":return vM(W,U);case"This":return nM(W,U);case"Tuple":return uM(W,U);case"Union":return mM(W,U);default:return L0(z)}}var fz=new Set;function r1(z,w){return fz.clear(),a0(z,w)}class iU{constructor(z,w,U,W){this.schema=z,this.references=w,this.checkFunc=U,this.code=W,this.hasTransform=r1(z,w)}Code(){return this.code}Schema(){return this.schema}References(){return this.references}Errors(z){return g1(this.schema,this.references,z)}Check(z){return this.checkFunc(z)}Decode(z){if(!this.checkFunc(z))throw new u4(this.schema,z,this.Errors(z).First());return this.hasTransform?_4(this.schema,this.references,z):z}Encode(z){let w=this.hasTransform?S4(this.schema,this.references,z):z;if(!this.checkFunc(w))throw new m4(this.schema,z,this.Errors(z).First());return w}}var a1;(function(z){function w(A){return A===36}z.DollarSign=w;function U(A){return A===95}z.IsUnderscore=U;function W(A){return A>=65&&A<=90||A>=97&&A<=122}z.IsAlpha=W;function X(A){return A>=48&&A<=57}z.IsNumeric=X})(a1||(a1={}));var I5;(function(z){function w(A){if(A.length===0)return!1;return a1.IsNumeric(A.charCodeAt(0))}function U(A){if(w(A))return!1;for(let Z=0;Z<A.length;Z++){let $=A.charCodeAt(Z);if(!(a1.IsAlpha($)||a1.IsNumeric($)||a1.DollarSign($)||a1.IsUnderscore($)))return!1}return!0}function W(A){return A.replace(/'/g,"\\'")}function X(A,Z){return U(Z)?`${A}.${Z}`:`${A}['${W(Z)}']`}z.Encode=X})(I5||(I5={}));var dz;(function(z){function w(U){let W=[];for(let X=0;X<U.length;X++){let A=U.charCodeAt(X);if(a1.IsNumeric(A)||a1.IsAlpha(A))W.push(U.charAt(X));else W.push(`_${A}_`)}return W.join("").replace(/__/g,"_")}z.Encode=w})(dz||(dz={}));var hz;(function(z){function w(U){return U.replace(/'/g,"\\'")}z.Escape=w})(hz||(hz={}));class yU extends n{constructor(z){super("Unknown type");this.schema=z}}class cz extends n{constructor(z){super("Preflight validation check failed to guard for the given schema");this.schema=z}}var c6;(function(z){function w(Z,$,Y){return I0.ExactOptionalPropertyTypes?`('${$}' in ${Z} ? ${Y} : true)`:`(${I5.Encode(Z,$)} !== undefined ? ${Y} : true)`}z.IsExactOptionalProperty=w;function U(Z){return!I0.AllowArrayObject?`(typeof ${Z} === 'object' && ${Z} !== null && !Array.isArray(${Z}))`:`(typeof ${Z} === 'object' && ${Z} !== null)`}z.IsObjectLike=U;function W(Z){return!I0.AllowArrayObject?`(typeof ${Z} === 'object' && ${Z} !== null && !Array.isArray(${Z}) && !(${Z} instanceof Date) && !(${Z} instanceof Uint8Array))`:`(typeof ${Z} === 'object' && ${Z} !== null && !(${Z} instanceof Date) && !(${Z} instanceof Uint8Array))`}z.IsRecordLike=W;function X(Z){return I0.AllowNaN?`typeof ${Z} === 'number'`:`Number.isFinite(${Z})`}z.IsNumberLike=X;function A(Z){return I0.AllowNullVoid?`(${Z} === undefined || ${Z} === null)`:`${Z} === undefined`}z.IsVoidLike=A})(c6||(c6={}));var _6;(function(z){function w(B){return B[H]==="Any"||B[H]==="Unknown"}function*U(B,K,L){yield"true"}function*W(B,K,L){yield"true"}function*X(B,K,L){yield`Array.isArray(${L})`;let[d,x]=[j("value","any"),j("acc","number")];if(v(B.maxItems))yield`${L}.length <= ${B.maxItems}`;if(v(B.minItems))yield`${L}.length >= ${B.minItems}`;let h=x2(B.items,K,"value");if(yield`${L}.every((${d}) => ${h})`,g0(B.contains)||v(B.minContains)||v(B.maxContains)){let b0=g0(B.contains)?B.contains:p(),_2=x2(b0,K,"value"),f1=v(B.minContains)?[`(count >= ${B.minContains})`]:[],A1=v(B.maxContains)?[`(count <= ${B.maxContains})`]:[],F1=`const count = value.reduce((${x}, ${d}) => ${_2} ? acc + 1 : acc, 0)`,X8=["(count > 0)",...f1,...A1].join(" && ");yield`((${d}) => { ${F1}; return ${X8}})(${L})`}if(B.uniqueItems===!0)yield`((${d}) => { const set = new Set(); for(const element of value) { const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true } )(${L})`}function*A(B,K,L){yield`(typeof value === 'object' && Symbol.asyncIterator in ${L})`}function*Z(B,K,L){if(yield`(typeof ${L} === 'bigint')`,X2(B.exclusiveMaximum))yield`${L} < BigInt(${B.exclusiveMaximum})`;if(X2(B.exclusiveMinimum))yield`${L} > BigInt(${B.exclusiveMinimum})`;if(X2(B.maximum))yield`${L} <= BigInt(${B.maximum})`;if(X2(B.minimum))yield`${L} >= BigInt(${B.minimum})`;if(X2(B.multipleOf))yield`(${L} % BigInt(${B.multipleOf})) === 0`}function*$(B,K,L){yield`(typeof ${L} === 'boolean')`}function*Y(B,K,L){yield*W1(B.returns,K,`${L}.prototype`)}function*Q(B,K,L){if(yield`(${L} instanceof Date) && Number.isFinite(${L}.getTime())`,v(B.exclusiveMaximumTimestamp))yield`${L}.getTime() < ${B.exclusiveMaximumTimestamp}`;if(v(B.exclusiveMinimumTimestamp))yield`${L}.getTime() > ${B.exclusiveMinimumTimestamp}`;if(v(B.maximumTimestamp))yield`${L}.getTime() <= ${B.maximumTimestamp}`;if(v(B.minimumTimestamp))yield`${L}.getTime() >= ${B.minimumTimestamp}`;if(v(B.multipleOfTimestamp))yield`(${L}.getTime() % ${B.multipleOfTimestamp}) === 0`}function*J(B,K,L){yield`(typeof ${L} === 'function')`}function*N(B,K,L){let d=globalThis.Object.getOwnPropertyNames(B.$defs).reduce((x,h)=>{return[...x,B.$defs[h]]},[]);yield*W1(p2(B.$ref),[...K,...d],L)}function*S(B,K,L){if(yield`Number.isInteger(${L})`,v(B.exclusiveMaximum))yield`${L} < ${B.exclusiveMaximum}`;if(v(B.exclusiveMinimum))yield`${L} > ${B.exclusiveMinimum}`;if(v(B.maximum))yield`${L} <= ${B.maximum}`;if(v(B.minimum))yield`${L} >= ${B.minimum}`;if(v(B.multipleOf))yield`(${L} % ${B.multipleOf}) === 0`}function*G(B,K,L){let d=B.allOf.map((x)=>x2(x,K,L)).join(" && ");if(B.unevaluatedProperties===!1){let x=A6(`${new RegExp(p1(B))};`),h=`Object.getOwnPropertyNames(${L}).every(key => ${x}.test(key))`;yield`(${d} && ${h})`}else if(g0(B.unevaluatedProperties)){let x=A6(`${new RegExp(p1(B))};`),h=`Object.getOwnPropertyNames(${L}).every(key => ${x}.test(key) || ${x2(B.unevaluatedProperties,K,`${L}[key]`)})`;yield`(${d} && ${h})`}else yield`(${d})`}function*O(B,K,L){yield`(typeof value === 'object' && Symbol.iterator in ${L})`}function*M(B,K,L){if(typeof B.const==="number"||typeof B.const==="boolean")yield`(${L} === ${B.const})`;else yield`(${L} === '${hz.Escape(B.const)}')`}function*C(B,K,L){yield"false"}function*k(B,K,L){yield`(!${x2(B.not,K,L)})`}function*q0(B,K,L){yield`(${L} === null)`}function*w0(B,K,L){if(yield c6.IsNumberLike(L),v(B.exclusiveMaximum))yield`${L} < ${B.exclusiveMaximum}`;if(v(B.exclusiveMinimum))yield`${L} > ${B.exclusiveMinimum}`;if(v(B.maximum))yield`${L} <= ${B.maximum}`;if(v(B.minimum))yield`${L} >= ${B.minimum}`;if(v(B.multipleOf))yield`(${L} % ${B.multipleOf}) === 0`}function*_0(B,K,L){if(yield c6.IsObjectLike(L),v(B.minProperties))yield`Object.getOwnPropertyNames(${L}).length >= ${B.minProperties}`;if(v(B.maxProperties))yield`Object.getOwnPropertyNames(${L}).length <= ${B.maxProperties}`;let d=Object.getOwnPropertyNames(B.properties);for(let x of d){let h=I5.Encode(L,x),b0=B.properties[x];if(B.required&&B.required.includes(x)){if(yield*W1(b0,K,h),l1(b0)||w(b0))yield`('${x}' in ${L})`}else{let _2=x2(b0,K,h);yield c6.IsExactOptionalProperty(L,x,_2)}}if(B.additionalProperties===!1)if(B.required&&B.required.length===d.length)yield`Object.getOwnPropertyNames(${L}).length === ${d.length}`;else{let x=`[${d.map((h)=>`'${h}'`).join(", ")}]`;yield`Object.getOwnPropertyNames(${L}).every(key => ${x}.includes(key))`}if(typeof B.additionalProperties==="object"){let x=x2(B.additionalProperties,K,`${L}[key]`),h=`[${d.map((b0)=>`'${b0}'`).join(", ")}]`;yield`(Object.getOwnPropertyNames(${L}).every(key => ${h}.includes(key) || ${x}))`}}function*C0(B,K,L){yield`${L} instanceof Promise`}function*f(B,K,L){if(yield c6.IsRecordLike(L),v(B.minProperties))yield`Object.getOwnPropertyNames(${L}).length >= ${B.minProperties}`;if(v(B.maxProperties))yield`Object.getOwnPropertyNames(${L}).length <= ${B.maxProperties}`;let[d,x]=Object.entries(B.patternProperties)[0],h=A6(`${new RegExp(d)}`),b0=x2(x,K,"value"),_2=g0(B.additionalProperties)?x2(B.additionalProperties,K,L):B.additionalProperties===!1?"false":"true",f1=`(${h}.test(key) ? ${b0} : ${_2})`;yield`(Object.entries(${L}).every(([key, value]) => ${f1}))`}function*E(B,K,L){let d=J0(B,K);if(S0.functions.has(B.$ref))return yield`${X6(B.$ref)}(${L})`;yield*W1(d,K,L)}function*T(B,K,L){let d=A6(`${new RegExp(B.source,B.flags)};`);if(yield`(typeof ${L} === 'string')`,v(B.maxLength))yield`${L}.length <= ${B.maxLength}`;if(v(B.minLength))yield`${L}.length >= ${B.minLength}`;yield`${d}.test(${L})`}function*F(B,K,L){if(yield`(typeof ${L} === 'string')`,v(B.maxLength))yield`${L}.length <= ${B.maxLength}`;if(v(B.minLength))yield`${L}.length >= ${B.minLength}`;if(B.pattern!==void 0)yield`${A6(`${new RegExp(B.pattern)};`)}.test(${L})`;if(B.format!==void 0)yield`format('${B.format}', ${L})`}function*a(B,K,L){yield`(typeof ${L} === 'symbol')`}function*Z0(B,K,L){yield`(typeof ${L} === 'string')`,yield`${A6(`${new RegExp(B.pattern)};`)}.test(${L})`}function*H0(B,K,L){yield`${X6(B.$ref)}(${L})`}function*h0(B,K,L){if(yield`Array.isArray(${L})`,B.items===void 0)return yield`${L}.length === 0`;yield`(${L}.length === ${B.maxItems})`;for(let d=0;d<B.items.length;d++)yield`${x2(B.items[d],K,`${L}[${d}]`)}`}function*U6(B,K,L){yield`${L} === undefined`}function*n0(B,K,L){yield`(${B.anyOf.map((x)=>x2(x,K,L)).join(" || ")})`}function*W6(B,K,L){if(yield`${L} instanceof Uint8Array`,v(B.maxByteLength))yield`(${L}.length <= ${B.maxByteLength})`;if(v(B.minByteLength))yield`(${L}.length >= ${B.minByteLength})`}function*I2(B,K,L){yield"true"}function*b6(B,K,L){yield c6.IsVoidLike(L)}function*a5(B,K,L){let d=S0.instances.size;S0.instances.set(d,B),yield`kind('${B[H]}', ${d}, ${L})`}function*W1(B,K,L,d=!0){let x=$0(B.$id)?[...K,B]:K,h=B;if(d&&$0(B.$id)){let b0=X6(B.$id);if(S0.functions.has(b0))return yield`${b0}(${L})`;else{S0.functions.set(b0,"<deferred>");let _2=X1(b0,B,K,"value",!1);return S0.functions.set(b0,_2),yield`${b0}(${L})`}}switch(h[H]){case"Any":return yield*U(h,x,L);case"Argument":return yield*W(h,x,L);case"Array":return yield*X(h,x,L);case"AsyncIterator":return yield*A(h,x,L);case"BigInt":return yield*Z(h,x,L);case"Boolean":return yield*$(h,x,L);case"Constructor":return yield*Y(h,x,L);case"Date":return yield*Q(h,x,L);case"Function":return yield*J(h,x,L);case"Import":return yield*N(h,x,L);case"Integer":return yield*S(h,x,L);case"Intersect":return yield*G(h,x,L);case"Iterator":return yield*O(h,x,L);case"Literal":return yield*M(h,x,L);case"Never":return yield*C(h,x,L);case"Not":return yield*k(h,x,L);case"Null":return yield*q0(h,x,L);case"Number":return yield*w0(h,x,L);case"Object":return yield*_0(h,x,L);case"Promise":return yield*C0(h,x,L);case"Record":return yield*f(h,x,L);case"Ref":return yield*E(h,x,L);case"RegExp":return yield*T(h,x,L);case"String":return yield*F(h,x,L);case"Symbol":return yield*a(h,x,L);case"TemplateLiteral":return yield*Z0(h,x,L);case"This":return yield*H0(h,x,L);case"Tuple":return yield*h0(h,x,L);case"Undefined":return yield*U6(h,x,L);case"Union":return yield*n0(h,x,L);case"Uint8Array":return yield*W6(h,x,L);case"Unknown":return yield*I2(h,x,L);case"Void":return yield*b6(h,x,L);default:if(!p0.Has(h[H]))throw new yU(B);return yield*a5(h,x,L)}}let S0={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function x2(B,K,L,d=!0){return`(${[...W1(B,K,L,d)].join(" && ")})`}function X6(B){return`check_${dz.Encode(B)}`}function A6(B){let K=`local_${S0.variables.size}`;return S0.variables.set(K,`const ${K} = ${B}`),K}function X1(B,K,L,d,x=!0){let[h,b0]=[`
`,(F1)=>"".padStart(F1," ")],_2=j("value","any"),f1=R("boolean"),A1=[...W1(K,L,d,x)].map((F1)=>`${b0(4)}${F1}`).join(` &&${h}`);return`function ${B}(${_2})${f1} {${h}${b0(2)}return (${h}${A1}${h}${b0(2)})
}`}function j(B,K){let L=S0.language==="typescript"?`: ${K}`:"";return`${B}${L}`}function R(B){return S0.language==="typescript"?`: ${B}`:""}function b(B,K,L){let d=X1("check",B,K,"value"),x=j("value","any"),h=R("boolean"),b0=[...S0.functions.values()],_2=[...S0.variables.values()],f1=$0(B.$id)?`return function check(${x})${h} {
  return ${X6(B.$id)}(value)
}`:`return ${d}`;return[..._2,...b0,f1].join(`
`)}function c(...B){let K={language:"javascript"},[L,d,x]=B.length===2&&m(B[1])?[B[0],B[1],K]:B.length===2&&!m(B[1])?[B[0],[],B[1]]:B.length===3?[B[0],B[1],B[2]]:B.length===1?[B[0],[],K]:[null,[],K];if(S0.language=x.language,S0.variables.clear(),S0.functions.clear(),S0.instances.clear(),!g0(L))throw new cz(L);for(let h of d)if(!g0(h))throw new cz(h);return b(L,d,x)}z.Code=c;function t(B,K=[]){let L=c(B,K,{language:"javascript"}),d=globalThis.Function("kind","format","hash",L),x=new Map(S0.instances);function h(A1,F1,X8){if(!p0.Has(A1)||!x.has(F1))return!1;let GX=p0.Get(A1),HX=x.get(F1);return GX(HX,X8)}function b0(A1,F1){if(!D0.Has(A1))return!1;return D0.Get(A1)(F1)}function _2(A1){return H6(A1)}let f1=d(h,b0,_2);return new iU(B,K,f1,L)}z.Compile=t})(_6||(_6={}));var tM=function(z,w,U,W,X){if(W==="m")throw new TypeError("Private method is not writable");if(W==="a"&&!X)throw new TypeError("Private accessor was defined without a setter");if(typeof w==="function"?z!==w||!X:!w.has(z))throw new TypeError("Cannot write private member to an object whose class did not declare it");return W==="a"?X.call(z,U):X?X.value=U:w.set(z,U),U},nU=function(z,w,U,W){if(U==="a"&&!W)throw new TypeError("Private accessor was defined without a getter");if(typeof w==="function"?z!==w||!W:!w.has(z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return U==="m"?W:U==="a"?W.call(z):W?W.value:w.get(z)},iz,x5,uU;class mU extends n{constructor(z){let w=z.First();super(w===void 0?"Invalid Value":w.message);iz.add(this),x5.set(this,void 0),tM(this,x5,z,"f"),this.error=w}Errors(){return new h6(nU(this,iz,"m",uU).call(this))}}x5=new WeakMap,iz=new WeakSet,uU=function*z(){if(this.error)yield this.error;yield*nU(this,x5,"f")};function vU(z,w,U){if(s(z,w,U))return;throw new mU(g1(z,w,U))}function V5(...z){return z.length===3?vU(z[0],z[1],z[2]):vU(z[0],[],z[1])}function oM(z){let w={};for(let U of Object.getOwnPropertyNames(z))w[U]=B0(z[U]);for(let U of Object.getOwnPropertySymbols(z))w[U]=B0(z[U]);return w}function pM(z){return z.map((w)=>B0(w))}function lM(z){return z.slice()}function sM(z){return new Map(B0([...z.entries()]))}function rM(z){return new Set(B0([...z.entries()]))}function aM(z){return new Date(z.toISOString())}function eM(z){return z}function B0(z){if(m(z))return pM(z);if(N2(z))return aM(z);if(n2(z))return lM(z);if(Q9(z))return sM(z);if(J9(z))return rM(z);if(l(z))return oM(z);if(T2(z))return eM(z);throw new Error("ValueClone: Unable to clone value")}class r2 extends n{constructor(z,w){super(w);this.schema=z}}function M0(z){return Y6(z)?z():B0(z)}function zq(z,w){if(u(z,"default"))return M0(z.default);else return{}}function wq(z,w){return{}}function Uq(z,w){if(z.uniqueItems===!0&&!u(z,"default"))throw new r2(z,"Array with the uniqueItems constraint requires a default value");else if("contains"in z&&!u(z,"default"))throw new r2(z,"Array with the contains constraint requires a default value");else if("default"in z)return M0(z.default);else if(z.minItems!==void 0)return Array.from({length:z.minItems}).map((U)=>{return C2(z.items,w)});else return[]}function Wq(z,w){if(u(z,"default"))return M0(z.default);else return async function*(){}()}function Xq(z,w){if(u(z,"default"))return M0(z.default);else return BigInt(0)}function Aq(z,w){if(u(z,"default"))return M0(z.default);else return!1}function Zq(z,w){if(u(z,"default"))return M0(z.default);else{let U=C2(z.returns,w);if(typeof U==="object"&&!Array.isArray(U))return class{constructor(){for(let[W,X]of Object.entries(U)){let A=this;A[W]=X}}};else return class{}}}function $q(z,w){if(u(z,"default"))return M0(z.default);else if(z.minimumTimestamp!==void 0)return new Date(z.minimumTimestamp);else return new Date}function Yq(z,w){if(u(z,"default"))return M0(z.default);else return()=>C2(z.returns,w)}function Qq(z,w){let U=globalThis.Object.values(z.$defs),W=z.$defs[z.$ref];return C2(W,[...w,...U])}function Jq(z,w){if(u(z,"default"))return M0(z.default);else if(z.minimum!==void 0)return z.minimum;else return 0}function Bq(z,w){if(u(z,"default"))return M0(z.default);else{let U=z.allOf.reduce((W,X)=>{let A=C2(X,w);return typeof A==="object"?{...W,...A}:A},{});if(!s(z,w,U))throw new r2(z,"Intersect produced invalid value. Consider using a default value.");return U}}function Mq(z,w){if(u(z,"default"))return M0(z.default);else return function*(){}()}function qq(z,w){if(u(z,"default"))return M0(z.default);else return z.const}function Lq(z,w){if(u(z,"default"))return M0(z.default);else throw new r2(z,"Never types cannot be created. Consider using a default value.")}function Nq(z,w){if(u(z,"default"))return M0(z.default);else throw new r2(z,"Not types must have a default value")}function Gq(z,w){if(u(z,"default"))return M0(z.default);else return null}function Hq(z,w){if(u(z,"default"))return M0(z.default);else if(z.minimum!==void 0)return z.minimum;else return 0}function _q(z,w){if(u(z,"default"))return M0(z.default);else{let U=new Set(z.required),W={};for(let[X,A]of Object.entries(z.properties)){if(!U.has(X))continue;W[X]=C2(A,w)}return W}}function Sq(z,w){if(u(z,"default"))return M0(z.default);else return Promise.resolve(C2(z.item,w))}function Dq(z,w){let[U,W]=Object.entries(z.patternProperties)[0];if(u(z,"default"))return M0(z.default);else if(!(U===V1||U===x1)){let X=U.slice(1,U.length-1).split("|"),A={};for(let Z of X)A[Z]=C2(W,w);return A}else return{}}function Pq(z,w){if(u(z,"default"))return M0(z.default);else return C2(J0(z,w),w)}function Oq(z,w){if(u(z,"default"))return M0(z.default);else throw new r2(z,"RegExp types cannot be created. Consider using a default value.")}function Rq(z,w){if(z.pattern!==void 0)if(!u(z,"default"))throw new r2(z,"String types with patterns must specify a default value");else return M0(z.default);else if(z.format!==void 0)if(!u(z,"default"))throw new r2(z,"String types with formats must specify a default value");else return M0(z.default);else if(u(z,"default"))return M0(z.default);else if(z.minLength!==void 0)return Array.from({length:z.minLength}).map(()=>" ").join("");else return""}function Cq(z,w){if(u(z,"default"))return M0(z.default);else if("value"in z)return Symbol.for(z.value);else return Symbol()}function bq(z,w){if(u(z,"default"))return M0(z.default);if(!J5(z))throw new r2(z,"Can only create template literals that produce a finite variants. Consider using a default value.");return A4(z)[0]}function Kq(z,w){if(tU++>Tq)throw new r2(z,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");if(u(z,"default"))return M0(z.default);else return C2(J0(z,w),w)}function Fq(z,w){if(u(z,"default"))return M0(z.default);if(z.items===void 0)return[];else return Array.from({length:z.minItems}).map((U,W)=>C2(z.items[W],w))}function jq(z,w){if(u(z,"default"))return M0(z.default);else return}function Eq(z,w){if(u(z,"default"))return M0(z.default);else if(z.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");else return C2(z.anyOf[0],w)}function Iq(z,w){if(u(z,"default"))return M0(z.default);else if(z.minByteLength!==void 0)return new Uint8Array(z.minByteLength);else return new Uint8Array(0)}function xq(z,w){if(u(z,"default"))return M0(z.default);else return{}}function Vq(z,w){if(u(z,"default"))return M0(z.default);else return}function kq(z,w){if(u(z,"default"))return M0(z.default);else throw new Error("User defined types must specify a default value")}function C2(z,w){let U=z2(z,w),W=z;switch(W[H]){case"Any":return zq(W,U);case"Argument":return wq(W,U);case"Array":return Uq(W,U);case"AsyncIterator":return Wq(W,U);case"BigInt":return Xq(W,U);case"Boolean":return Aq(W,U);case"Constructor":return Zq(W,U);case"Date":return $q(W,U);case"Function":return Yq(W,U);case"Import":return Qq(W,U);case"Integer":return Jq(W,U);case"Intersect":return Bq(W,U);case"Iterator":return Mq(W,U);case"Literal":return qq(W,U);case"Never":return Lq(W,U);case"Not":return Nq(W,U);case"Null":return Gq(W,U);case"Number":return Hq(W,U);case"Object":return _q(W,U);case"Promise":return Sq(W,U);case"Record":return Dq(W,U);case"Ref":return Pq(W,U);case"RegExp":return Oq(W,U);case"String":return Rq(W,U);case"Symbol":return Cq(W,U);case"TemplateLiteral":return bq(W,U);case"This":return Kq(W,U);case"Tuple":return Fq(W,U);case"Undefined":return jq(W,U);case"Union":return Eq(W,U);case"Uint8Array":return Iq(W,U);case"Unknown":return xq(W,U);case"Void":return Vq(W,U);default:if(!p0.Has(W[H]))throw new r2(W,"Unknown type");return kq(W,U)}}var Tq=512,tU=0;function a2(...z){return tU=0,z.length===2?C2(z[0],z[1]):C2(z[0],[])}class yz extends n{constructor(z,w){super(w);this.schema=z}}function gq(z,w,U){if(z[H]==="Object"&&typeof U==="object"&&!y1(U)){let W=z,X=Object.getOwnPropertyNames(U),A=Object.entries(W.properties),[Z,$]=[1/A.length,A.length];return A.reduce((Y,[Q,J])=>{let N=J[H]==="Literal"&&J.const===U[Q]?$:0,S=s(J,w,U[Q])?Z:0,G=X.includes(Q)?Z:0;return Y+(N+S+G)},0)}else return s(z,w,U)?1:0}function fq(z,w,U){let W=z.anyOf.map((Z)=>J0(Z,w)),[X,A]=[W[0],0];for(let Z of W){let $=gq(Z,w,U);if($>A)X=Z,A=$}return X}function dq(z,w,U){if("default"in z)return typeof U==="function"?z.default:B0(z.default);else{let W=fq(z,w,U);return t4(W,w,U)}}function hq(z,w,U){return s(z,w,U)?B0(U):a2(z,w)}function cq(z,w,U){return s(z,w,U)?U:a2(z,w)}function iq(z,w,U){if(s(z,w,U))return B0(U);let W=m(U)?B0(U):a2(z,w),X=v(z.minItems)&&W.length<z.minItems?[...W,...Array.from({length:z.minItems-W.length},()=>null)]:W,Z=(v(z.maxItems)&&X.length>z.maxItems?X.slice(0,z.maxItems):X).map((Y)=>S1(z.items,w,Y));if(z.uniqueItems!==!0)return Z;let $=[...new Set(Z)];if(!s(z,w,$))throw new yz(z,"Array cast produced invalid data due to uniqueItems constraint");return $}function yq(z,w,U){if(s(z,w,U))return a2(z,w);let W=new Set(z.returns.required||[]),X=function(){};for(let[A,Z]of Object.entries(z.returns.properties)){if(!W.has(A)&&U.prototype[A]===void 0)continue;X.prototype[A]=S1(Z,w,U.prototype[A])}return X}function vq(z,w,U){let W=globalThis.Object.values(z.$defs),X=z.$defs[z.$ref];return S1(X,[...w,...W],U)}function nq(z,w,U){let W=a2(z,w),X=l(W)&&l(U)?{...W,...U}:U;return s(z,w,X)?X:a2(z,w)}function uq(z,w,U){throw new yz(z,"Never types cannot be cast")}function mq(z,w,U){if(s(z,w,U))return U;if(U===null||typeof U!=="object")return a2(z,w);let W=new Set(z.required||[]),X={};for(let[A,Z]of Object.entries(z.properties)){if(!W.has(A)&&U[A]===void 0)continue;X[A]=S1(Z,w,U[A])}if(typeof z.additionalProperties==="object"){let A=Object.getOwnPropertyNames(z.properties);for(let Z of Object.getOwnPropertyNames(U)){if(A.includes(Z))continue;X[Z]=S1(z.additionalProperties,w,U[Z])}}return X}function tq(z,w,U){if(s(z,w,U))return B0(U);if(U===null||typeof U!=="object"||Array.isArray(U)||U instanceof Date)return a2(z,w);let W=Object.getOwnPropertyNames(z.patternProperties)[0],X=z.patternProperties[W],A={};for(let[Z,$]of Object.entries(U))A[Z]=S1(X,w,$);return A}function oq(z,w,U){return S1(J0(z,w),w,U)}function pq(z,w,U){return S1(J0(z,w),w,U)}function lq(z,w,U){if(s(z,w,U))return B0(U);if(!m(U))return a2(z,w);if(z.items===void 0)return[];return z.items.map((W,X)=>S1(W,w,U[X]))}function sq(z,w,U){return s(z,w,U)?B0(U):dq(z,w,U)}function S1(z,w,U){let W=$0(z.$id)?z2(z,w):w,X=z;switch(z[H]){case"Array":return iq(X,W,U);case"Constructor":return yq(X,W,U);case"Import":return vq(X,W,U);case"Intersect":return nq(X,W,U);case"Never":return uq(X,W,U);case"Object":return mq(X,W,U);case"Record":return tq(X,W,U);case"Ref":return oq(X,W,U);case"This":return pq(X,W,U);case"Tuple":return lq(X,W,U);case"Union":return sq(X,W,U);case"Date":case"Symbol":case"Uint8Array":return hq(z,w,U);default:return cq(X,W,U)}}function t4(...z){return z.length===3?S1(z[0],z[1],z[2]):S1(z[0],[],z[1])}function rq(z){return J6(z)&&z[H]!=="Unsafe"}function aq(z,w,U){if(!m(U))return U;return U.map((W)=>b2(z.items,w,W))}function eq(z,w,U){let W=globalThis.Object.values(z.$defs),X=z.$defs[z.$ref];return b2(X,[...w,...W],U)}function zL(z,w,U){let W=z.unevaluatedProperties,A=z.allOf.map(($)=>b2($,w,B0(U))).reduce(($,Y)=>l(Y)?{...$,...Y}:Y,{});if(!l(U)||!l(A)||!J6(W))return A;let Z=O2(z);for(let $ of Object.getOwnPropertyNames(U)){if(Z.includes($))continue;if(s(W,w,U[$]))A[$]=b2(W,w,U[$])}return A}function wL(z,w,U){if(!l(U)||m(U))return U;let W=z.additionalProperties;for(let X of Object.getOwnPropertyNames(U)){if(u(z.properties,X)){U[X]=b2(z.properties[X],w,U[X]);continue}if(J6(W)&&s(W,w,U[X])){U[X]=b2(W,w,U[X]);continue}delete U[X]}return U}function UL(z,w,U){if(!l(U))return U;let W=z.additionalProperties,X=Object.getOwnPropertyNames(U),[A,Z]=Object.entries(z.patternProperties)[0],$=new RegExp(A);for(let Y of X){if($.test(Y)){U[Y]=b2(Z,w,U[Y]);continue}if(J6(W)&&s(W,w,U[Y])){U[Y]=b2(W,w,U[Y]);continue}delete U[Y]}return U}function WL(z,w,U){return b2(J0(z,w),w,U)}function XL(z,w,U){return b2(J0(z,w),w,U)}function AL(z,w,U){if(!m(U))return U;if(k0(z.items))return[];let W=Math.min(U.length,z.items.length);for(let X=0;X<W;X++)U[X]=b2(z.items[X],w,U[X]);return U.length>W?U.slice(0,W):U}function ZL(z,w,U){for(let W of z.anyOf)if(rq(W)&&s(W,w,U))return b2(W,w,U);return U}function b2(z,w,U){let W=$0(z.$id)?z2(z,w):w,X=z;switch(X[H]){case"Array":return aq(X,W,U);case"Import":return eq(X,W,U);case"Intersect":return zL(X,W,U);case"Object":return wL(X,W,U);case"Record":return UL(X,W,U);case"Ref":return WL(X,W,U);case"This":return XL(X,W,U);case"Tuple":return AL(X,W,U);case"Union":return ZL(X,W,U);default:return U}}function k5(...z){return z.length===3?b2(z[0],z[1],z[2]):b2(z[0],[],z[1])}function T5(z){return $0(z)&&!isNaN(z)&&!isNaN(parseFloat(z))}function $L(z){return X2(z)||I1(z)||v(z)}function o4(z){return z===!0||v(z)&&z===1||X2(z)&&z===BigInt("1")||$0(z)&&(z.toLowerCase()==="true"||z==="1")}function p4(z){return z===!1||v(z)&&(z===0||Object.is(z,-0))||X2(z)&&z===BigInt("0")||$0(z)&&(z.toLowerCase()==="false"||z==="0"||z==="-0")}function YL(z){return $0(z)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(z)}function QL(z){return $0(z)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(z)}function JL(z){return $0(z)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(z)}function BL(z){return $0(z)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(z)}function ML(z){return $0(z)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test(z)}function qL(z,w){let U=pU(z);return U===w?U:z}function LL(z,w){let U=lU(z);return U===w?U:z}function NL(z,w){let U=oU(z);return U===w?U:z}function GL(z,w){return $0(z.const)?qL(w,z.const):v(z.const)?LL(w,z.const):I1(z.const)?NL(w,z.const):w}function oU(z){return o4(z)?!0:p4(z)?!1:z}function HL(z){let w=(U)=>U.split(".")[0];return T5(z)?BigInt(w(z)):v(z)?BigInt(Math.trunc(z)):p4(z)?BigInt(0):o4(z)?BigInt(1):z}function pU(z){return v1(z)&&z.description!==void 0?z.description.toString():$L(z)?z.toString():z}function lU(z){return T5(z)?parseFloat(z):o4(z)?1:p4(z)?0:z}function _L(z){return T5(z)?parseInt(z):v(z)?Math.trunc(z):o4(z)?1:p4(z)?0:z}function SL(z){return $0(z)&&z.toLowerCase()==="null"?null:z}function DL(z){return $0(z)&&z==="undefined"?void 0:z}function PL(z){return N2(z)?z:v(z)?new Date(z):o4(z)?new Date(1):p4(z)?new Date(0):T5(z)?new Date(parseInt(z)):QL(z)?new Date(`1970-01-01T${z}.000Z`):YL(z)?new Date(`1970-01-01T${z}`):BL(z)?new Date(`${z}.000Z`):JL(z)?new Date(z):ML(z)?new Date(`${z}T00:00:00.000Z`):z}function OL(z){return z}function RL(z,w,U){return(m(U)?U:[U]).map((X)=>D1(z.items,w,X))}function CL(z,w,U){return HL(U)}function bL(z,w,U){return oU(U)}function KL(z,w,U){return PL(U)}function FL(z,w,U){let W=globalThis.Object.values(z.$defs),X=z.$defs[z.$ref];return D1(X,[...w,...W],U)}function jL(z,w,U){return _L(U)}function EL(z,w,U){return z.allOf.reduce((W,X)=>D1(X,w,W),U)}function IL(z,w,U){return GL(z,U)}function xL(z,w,U){return SL(U)}function VL(z,w,U){return lU(U)}function kL(z,w,U){if(!l(U))return U;for(let W of Object.getOwnPropertyNames(z.properties)){if(!u(U,W))continue;U[W]=D1(z.properties[W],w,U[W])}return U}function TL(z,w,U){if(!l(U))return U;let X=Object.getOwnPropertyNames(z.patternProperties)[0],A=z.patternProperties[X];for(let[Z,$]of Object.entries(U))U[Z]=D1(A,w,$);return U}function gL(z,w,U){return D1(J0(z,w),w,U)}function fL(z,w,U){return pU(U)}function dL(z,w,U){return $0(U)||v(U)?Symbol(U):U}function hL(z,w,U){return D1(J0(z,w),w,U)}function cL(z,w,U){if(!(m(U)&&!k0(z.items)))return U;return U.map((X,A)=>{return A<z.items.length?D1(z.items[A],w,X):X})}function iL(z,w,U){return DL(U)}function yL(z,w,U){for(let W of z.anyOf){let X=D1(W,w,B0(U));if(!s(W,w,X))continue;return X}return U}function D1(z,w,U){let W=z2(z,w),X=z;switch(z[H]){case"Array":return RL(X,W,U);case"BigInt":return CL(X,W,U);case"Boolean":return bL(X,W,U);case"Date":return KL(X,W,U);case"Import":return FL(X,W,U);case"Integer":return jL(X,W,U);case"Intersect":return EL(X,W,U);case"Literal":return IL(X,W,U);case"Null":return xL(X,W,U);case"Number":return VL(X,W,U);case"Object":return kL(X,W,U);case"Record":return TL(X,W,U);case"Ref":return gL(X,W,U);case"String":return fL(X,W,U);case"Symbol":return dL(X,W,U);case"This":return hL(X,W,U);case"Tuple":return cL(X,W,U);case"Undefined":return iL(X,W,U);case"Union":return yL(X,W,U);default:return OL(U)}}function g5(...z){return z.length===3?D1(z[0],z[1],z[2]):D1(z[0],[],z[1])}function sU(...z){let[w,U,W]=z.length===3?[z[0],z[1],z[2]]:[z[0],[],z[1]];if(!s(w,U,W))throw new u4(w,W,g1(w,U,W).First());return r1(w,U)?_4(w,U,W):W}function e1(z,w){let U=u(z,"default")?z.default:void 0,W=Y6(U)?U():B0(U);return k0(w)?W:l(w)&&l(W)?Object.assign(W,w):w}function vz(z){return J6(z)&&"default"in z}function vL(z,w,U){if(m(U)){for(let X=0;X<U.length;X++)U[X]=H2(z.items,w,U[X]);return U}let W=e1(z,U);if(!m(W))return W;for(let X=0;X<W.length;X++)W[X]=H2(z.items,w,W[X]);return W}function nL(z,w,U){return N2(U)?U:e1(z,U)}function uL(z,w,U){let W=globalThis.Object.values(z.$defs),X=z.$defs[z.$ref];return H2(X,[...w,...W],U)}function mL(z,w,U){let W=e1(z,U);return z.allOf.reduce((X,A)=>{let Z=H2(A,w,W);return l(Z)?{...X,...Z}:Z},{})}function tL(z,w,U){let W=e1(z,U);if(!l(W))return W;let X=Object.getOwnPropertyNames(z.properties);for(let A of X){let Z=H2(z.properties[A],w,W[A]);if(k0(Z))continue;W[A]=H2(z.properties[A],w,W[A])}if(!vz(z.additionalProperties))return W;for(let A of Object.getOwnPropertyNames(W)){if(X.includes(A))continue;W[A]=H2(z.additionalProperties,w,W[A])}return W}function oL(z,w,U){let W=e1(z,U);if(!l(W))return W;let X=z.additionalProperties,[A,Z]=Object.entries(z.patternProperties)[0],$=new RegExp(A);for(let Y of Object.getOwnPropertyNames(W)){if(!($.test(Y)&&vz(Z)))continue;W[Y]=H2(Z,w,W[Y])}if(!vz(X))return W;for(let Y of Object.getOwnPropertyNames(W)){if($.test(Y))continue;W[Y]=H2(X,w,W[Y])}return W}function pL(z,w,U){return H2(J0(z,w),w,e1(z,U))}function lL(z,w,U){return H2(J0(z,w),w,U)}function sL(z,w,U){let W=e1(z,U);if(!m(W)||k0(z.items))return W;let[X,A]=[z.items,Math.max(z.items.length,W.length)];for(let Z=0;Z<A;Z++)if(Z<X.length)W[Z]=H2(X[Z],w,W[Z]);return W}function rL(z,w,U){let W=e1(z,U);for(let X of z.anyOf){let A=H2(X,w,B0(W));if(s(X,w,A))return A}return W}function H2(z,w,U){let W=z2(z,w),X=z;switch(X[H]){case"Array":return vL(X,W,U);case"Date":return nL(X,W,U);case"Import":return uL(X,W,U);case"Intersect":return mL(X,W,U);case"Object":return tL(X,W,U);case"Record":return oL(X,W,U);case"Ref":return pL(X,W,U);case"This":return lL(X,W,U);case"Tuple":return sL(X,W,U);case"Union":return rL(X,W,U);default:return e1(X,U)}}function f5(...z){return z.length===3?H2(z[0],z[1],z[2]):H2(z[0],[],z[1])}var P1={};K6(P1,{ValuePointerRootSetError:()=>nz,ValuePointerRootDeleteError:()=>uz,Set:()=>aL,Has:()=>zN,Get:()=>wN,Format:()=>l4,Delete:()=>eL});class nz extends n{constructor(z,w,U){super("Cannot set root value");this.value=z,this.path=w,this.update=U}}class uz extends n{constructor(z,w){super("Cannot delete root value");this.value=z,this.path=w}}function rU(z){return z.indexOf("~")===-1?z:z.replace(/~1/g,"/").replace(/~0/g,"~")}function*l4(z){if(z==="")return;let[w,U]=[0,0];for(let W=0;W<z.length;W++)if(z.charAt(W)==="/")if(W===0)w=W+1;else U=W,yield rU(z.slice(w,U)),w=W+1;else U=W;yield rU(z.slice(w))}function aL(z,w,U){if(w==="")throw new nz(z,w,U);let[W,X,A]=[null,z,""];for(let Z of l4(w)){if(X[Z]===void 0)X[Z]={};W=X,X=X[Z],A=Z}W[A]=U}function eL(z,w){if(w==="")throw new uz(z,w);let[U,W,X]=[null,z,""];for(let A of l4(w)){if(W[A]===void 0||W[A]===null)return;U=W,W=W[A],X=A}if(Array.isArray(U)){let A=parseInt(X);U.splice(A,1)}else delete U[X]}function zN(z,w){if(w==="")return!0;let[U,W,X]=[null,z,""];for(let A of l4(w)){if(W[A]===void 0)return!1;U=W,W=W[A],X=A}return Object.getOwnPropertyNames(U).includes(X)}function wN(z,w){if(w==="")return z;let U=z;for(let W of l4(w)){if(U[W]===void 0)return;U=U[W]}return U}function UN(z,w){if(!l(w))return!1;let U=[...Object.keys(z),...Object.getOwnPropertySymbols(z)],W=[...Object.keys(w),...Object.getOwnPropertySymbols(w)];if(U.length!==W.length)return!1;return U.every((X)=>i6(z[X],w[X]))}function WN(z,w){return N2(w)&&z.getTime()===w.getTime()}function XN(z,w){if(!m(w)||z.length!==w.length)return!1;return z.every((U,W)=>i6(U,w[W]))}function AN(z,w){if(!n2(w)||z.length!==w.length||Object.getPrototypeOf(z).constructor.name!==Object.getPrototypeOf(w).constructor.name)return!1;return z.every((U,W)=>i6(U,w[W]))}function ZN(z,w){return z===w}function i6(z,w){if(N2(z))return WN(z,w);if(n2(z))return AN(z,w);if(m(z))return XN(z,w);if(l(z))return UN(z,w);if(T2(z))return ZN(z,w);throw new Error("ValueEquals: Unable to compare value")}var $N=G0({type:A0("insert"),path:G2(),value:L1()}),YN=G0({type:A0("update"),path:G2(),value:L1()}),QN=G0({type:A0("delete"),path:G2()}),eU=N0([$N,YN,QN]);class mz extends n{constructor(z,w){super(w);this.value=z}}function d5(z,w){return{type:"update",path:z,value:w}}function zW(z,w){return{type:"insert",path:z,value:w}}function wW(z){return{type:"delete",path:z}}function aU(z){if(globalThis.Object.getOwnPropertySymbols(z).length>0)throw new mz(z,"Cannot diff objects with symbols")}function*JN(z,w,U){if(aU(w),aU(U),!qz(U))return yield d5(z,U);let W=globalThis.Object.getOwnPropertyNames(w),X=globalThis.Object.getOwnPropertyNames(U);for(let A of X){if(u(w,A))continue;yield zW(`${z}/${A}`,U[A])}for(let A of W){if(!u(U,A))continue;if(i6(w,U))continue;yield*h5(`${z}/${A}`,w[A],U[A])}for(let A of W){if(u(U,A))continue;yield wW(`${z}/${A}`)}}function*BN(z,w,U){if(!m(U))return yield d5(z,U);for(let W=0;W<Math.min(w.length,U.length);W++)yield*h5(`${z}/${W}`,w[W],U[W]);for(let W=0;W<U.length;W++){if(W<w.length)continue;yield zW(`${z}/${W}`,U[W])}for(let W=w.length-1;W>=0;W--){if(W<U.length)continue;yield wW(`${z}/${W}`)}}function*MN(z,w,U){if(!n2(U)||w.length!==U.length||globalThis.Object.getPrototypeOf(w).constructor.name!==globalThis.Object.getPrototypeOf(U).constructor.name)return yield d5(z,U);for(let W=0;W<Math.min(w.length,U.length);W++)yield*h5(`${z}/${W}`,w[W],U[W])}function*qN(z,w,U){if(w===U)return;yield d5(z,U)}function*h5(z,w,U){if(qz(w))return yield*JN(z,w,U);if(m(w))return yield*BN(z,w,U);if(n2(w))return yield*MN(z,w,U);if(T2(w))return yield*qN(z,w,U);throw new mz(w,"Unable to diff value")}function UW(z,w){return[...h5("",z,w)]}function LN(z){return z.length>0&&z[0].path===""&&z[0].type==="update"}function NN(z){return z.length===0}function WW(z,w){if(LN(w))return B0(w[0].value);if(NN(w))return B0(z);let U=B0(z);for(let W of w)switch(W.type){case"insert":{P1.Set(U,W.path,W.value);break}case"update":{P1.Set(U,W.path,W.value);break}case"delete":{P1.Delete(U,W.path);break}}return U}function XW(...z){let[w,U,W]=z.length===3?[z[0],z[1],z[2]]:[z[0],[],z[1]],X=r1(w,U)?S4(w,U,W):W;if(!s(w,U,X))throw new m4(w,X,g1(w,U,X).First());return X}function c5(z){return l(z)&&!m(z)}class tz extends n{constructor(z){super(z)}}function GN(z,w,U,W){if(!c5(U))P1.Set(z,w,B0(W));else{let X=Object.getOwnPropertyNames(U),A=Object.getOwnPropertyNames(W);for(let Z of X)if(!A.includes(Z))delete U[Z];for(let Z of A)if(!X.includes(Z))U[Z]=null;for(let Z of A)oz(z,`${w}/${Z}`,U[Z],W[Z])}}function HN(z,w,U,W){if(!m(U))P1.Set(z,w,B0(W));else{for(let X=0;X<W.length;X++)oz(z,`${w}/${X}`,U[X],W[X]);U.splice(W.length)}}function _N(z,w,U,W){if(n2(U)&&U.length===W.length)for(let X=0;X<U.length;X++)U[X]=W[X];else P1.Set(z,w,B0(W))}function SN(z,w,U,W){if(U===W)return;P1.Set(z,w,W)}function oz(z,w,U,W){if(m(W))return HN(z,w,U,W);if(n2(W))return _N(z,w,U,W);if(c5(W))return GN(z,w,U,W);if(T2(W))return SN(z,w,U,W)}function AW(z){return n2(z)||T2(z)}function DN(z,w){return c5(z)&&m(w)||m(z)&&c5(w)}function ZW(z,w){if(AW(z)||AW(w))throw new tz("Only object and array types can be mutated at the root level");if(DN(z,w))throw new tz("Cannot assign due type mismatch of assignable values");oz(z,"",z,w)}class lz extends n{constructor(z){super(z)}}var pz;(function(z){let w=new Map([["Assert",(A,Z,$)=>{return V5(A,Z,$),$}],["Cast",(A,Z,$)=>t4(A,Z,$)],["Clean",(A,Z,$)=>k5(A,Z,$)],["Clone",(A,Z,$)=>B0($)],["Convert",(A,Z,$)=>g5(A,Z,$)],["Decode",(A,Z,$)=>r1(A,Z)?_4(A,Z,$):$],["Default",(A,Z,$)=>f5(A,Z,$)],["Encode",(A,Z,$)=>r1(A,Z)?S4(A,Z,$):$]]);function U(A){w.delete(A)}z.Delete=U;function W(A,Z){w.set(A,Z)}z.Set=W;function X(A){return w.get(A)}z.Get=X})(pz||(pz={}));var $W=["Clone","Clean","Default","Convert","Assert","Decode"];function PN(z,w,U,W){return z.reduce((X,A)=>{let Z=pz.Get(A);if(k0(Z))throw new lz(`Unable to find Parse operation '${A}'`);return Z(w,U,X)},W)}function YW(...z){let[w,U,W,X]=z.length===4?[z[0],z[1],z[2],z[3]]:z.length===3?m(z[0])?[z[0],z[1],[],z[2]]:[$W,z[0],z[1],z[2]]:z.length===2?[$W,z[0],[],z[1]]:(()=>{throw new lz("Invalid Arguments")})();return PN(w,U,W,X)}var o={};K6(o,{ValueErrorIterator:()=>h6,Patch:()=>WW,Parse:()=>YW,Mutate:()=>ZW,Hash:()=>H6,Errors:()=>g1,Equal:()=>i6,Encode:()=>XW,Edit:()=>eU,Diff:()=>UW,Default:()=>f5,Decode:()=>sU,Create:()=>a2,Convert:()=>g5,Clone:()=>B0,Clean:()=>k5,Check:()=>s,Cast:()=>t4,Assert:()=>V5});var s5=OX(MW(),1);var $w={date:gW,time:Ww(!0),"date-time":qW(!0),"iso-time":Ww(!1),"iso-date-time":qW(!1),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:yN,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:pN,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:vN,int32:{type:"number",validate:mN},int64:{type:"number",validate:tN},float:{type:"number",validate:NW},double:{type:"number",validate:NW},password:!0,binary:!0};function TN(z){return z%4===0&&(z%100!==0||z%400===0)}var gN=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,fN=[0,31,28,31,30,31,30,31,31,30,31,30,31];function gW(z){let w=gN.exec(z);if(!w)return!1;let U=+w[1],W=+w[2],X=+w[3];return W>=1&&W<=12&&X>=1&&X<=(W===2&&TN(U)?29:fN[W])}var dN=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function Ww(z){return function w(U){let W=dN.exec(U);if(!W)return!1;let X=+W[1],A=+W[2],Z=+W[3],$=W[4],Y=W[5]==="-"?-1:1,Q=+(W[6]||0),J=+(W[7]||0);if(Q>23||J>59||z&&!$)return!1;if(X<=23&&A<=59&&Z<60)return!0;let N=A-J*Y,S=X-Q*Y-(N<0?1:0);return(S===23||S===-1)&&(N===59||N===-1)&&Z<61}}var hN=/t|\s/i;function qW(z){let w=Ww(z);return function U(W){let X=W.split(hN);return X.length===2&&gW(X[0])&&w(X[1])}}var cN=/\/|:/,iN=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function yN(z){return cN.test(z)&&iN.test(z)}var LW=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function vN(z){return LW.lastIndex=0,LW.test(z)}var nN=-2147483648,uN=2147483647;function mN(z){return Number.isInteger(z)&&z<=uN&&z>=nN}function tN(z){return Number.isInteger(z)}function NW(){return!0}var oN=/[^\\]\\Z/;function pN(z){if(oN.test(z))return!1;try{return new RegExp(z),!0}catch(w){return!1}}var n5="toJSON"in new Headers,GW=(z,w)=>{let U=new URL(z);return U.pathname=w,U.toString()},lN=(z)=>typeof z==="function"&&/^\s*class\s+/.test(z.toString())||z.toString&&z.toString().startsWith("[object ")&&z.toString()!=="[object Object]"||w1(Object.getPrototypeOf(z)),sz=(z)=>z&&typeof z==="object"&&!Array.isArray(z),F2=(z,w,{skipKeys:U,override:W=!0}={})=>{if(!sz(z)||!sz(w))return z;for(let[X,A]of Object.entries(w)){if(U?.includes(X))continue;if(!sz(A)||!(X in z)||lN(A)){if(W||!(X in z))z[X]=A;continue}z[X]=F2(z[X],A,{skipKeys:U,override:W})}return z},sN=(z,w)=>{let U=F2(Object.assign({},z),w,{skipKeys:["properties"]});if("properties"in U)delete U.properties;return U},v0=(z=[],w=[])=>{if(!z)return;if(!w)return z;let U=[],W=[];if(!Array.isArray(z))z=[z];if(!Array.isArray(w))w=[w];for(let X of z)if(U.push(X),X.checksum)W.push(X.checksum);for(let X of w)if(!W.includes(X.checksum))U.push(X);return U},rN=["start","request","parse","transform","resolve","beforeHandle","afterHandle","mapResponse","afterResponse","trace","error","stop","body","headers","params","query","response","type","detail"],aN=rN.reduce((z,w)=>(z[w]=!0,z),{}),fW=(z,w)=>{let U=(W)=>typeof W==="object"&&Object.keys(W).every(Yw);if(U(z)&&U(w))return Object.assign(z,w);else if(z&&!U(z)&&U(w))return Object.assign({200:z},w);return w??z},s4=(z,w)=>{return{body:w?.body??z?.body,headers:w?.headers??z?.headers,params:w?.params??z?.params,query:w?.query??z?.query,cookie:w?.cookie??z?.cookie,response:fW(z?.response,w?.response)}},z6=(z,w)=>{let{resolve:U,...W}=z??{},{resolve:X,...A}=w??{};return{...W,...A,body:w?.body??z?.body,headers:w?.headers??z?.headers,params:w?.params??z?.params,query:w?.query??z?.query,cookie:w?.cookie??z?.cookie,response:fW(z?.response,w?.response),type:z?.type||w?.type,detail:F2(w?.detail??{},z?.detail??{}),parse:v0(z?.parse,w?.parse),transform:v0(z?.transform,w?.transform),beforeHandle:v0(v0(W2(U,"resolve"),z?.beforeHandle),v0(W2(X,"resolve"),w?.beforeHandle)),afterHandle:v0(z?.afterHandle,w?.afterHandle),mapResponse:v0(z?.mapResponse,w?.mapResponse),afterResponse:v0(z?.afterResponse,w?.afterResponse),trace:v0(z?.trace,w?.trace),error:v0(z?.error,w?.error)}},Xw=(z,w,U=!0)=>{if(!Array.isArray(w))return w.original=z,$2(z,w,U);for(let W of w)W.original=z,z=$2(z,W,U);return z},$2=(z,w,U=!0)=>{if(!z)return z;if(w.untilObjectFound&&!U&&z.type==="object")return z;let W=w.from[H];if(z.oneOf){for(let Z=0;Z<z.oneOf.length;Z++)z.oneOf[Z]=$2(z.oneOf[Z],w,U);return z}if(z.anyOf){for(let Z=0;Z<z.anyOf.length;Z++)z.anyOf[Z]=$2(z.anyOf[Z],w,U);return z}if(z.allOf){for(let Z=0;Z<z.allOf.length;Z++)z.allOf[Z]=$2(z.allOf[Z],w,U);return z}if(z.not)return $2(z.not,w,U);let X=U&&!!w.excludeRoot;if(z[H]===W){let{anyOf:Z,oneOf:$,allOf:Y,not:Q,properties:J,items:N,...S}=z,G=w.to(S);if(!G)return z;let O,M=(C)=>{if(J&&C.type==="object"){let q0={};for(let[w0,_0]of Object.entries(J))q0[w0]=$2(_0,w,!1);return{...S,...C,properties:q0}}if(N&&C.type==="array")return{...S,...C,items:$2(N,w,!1)};let k={...S,...C};if(delete k.required,J&&C.type==="string"&&C.format==="ObjectString"&&C.default==="{}")O=I.ObjectString(J,S),k.default=JSON.stringify(o.Create(I.Object(J))),k.properties=J;if(N&&C.type==="string"&&C.format==="ArrayString"&&C.default==="[]")O=I.ArrayString(N,S),k.default=JSON.stringify(o.Create(I.Array(N))),k.items=N;return k};if(X){if(J){let C={};for(let[k,q0]of Object.entries(J))C[k]=$2(q0,w,!1);return{...S,properties:C}}else if(N?.map)return{...S,items:N.map((C)=>$2(C,w,!1))};return S}if(G.anyOf)for(let C=0;C<G.anyOf.length;C++)G.anyOf[C]=M(G.anyOf[C]);else if(G.oneOf)for(let C=0;C<G.oneOf.length;C++)G.oneOf[C]=M(G.oneOf[C]);else if(G.allOf)for(let C=0;C<G.allOf.length;C++)G.allOf[C]=M(G.allOf[C]);else if(G.not)G.not=M(G.not);if(O)G[j0]=O[j0];if(G.anyOf||G.oneOf||G.allOf||G.not)return G;if(J){let C={};for(let[k,q0]of Object.entries(J))C[k]=$2(q0,w,!1);return{...S,...G,properties:C}}else if(N?.map)return{...S,...G,items:N.map((C)=>$2(C,w,!1))};return{...S,...G}}let A=z?.properties;if(A&&U&&w.rootOnly!==!0)for(let[Z,$]of Object.entries(A))switch($[H]){case W:let{anyOf:Y,oneOf:Q,allOf:J,not:N,type:S,...G}=$,O=w.to(G);if(!O)return z;if(O.anyOf)for(let M=0;M<O.anyOf.length;M++)O.anyOf[M]={...G,...O.anyOf[M]};else if(O.oneOf)for(let M=0;M<O.oneOf.length;M++)O.oneOf[M]={...G,...O.oneOf[M]};else if(O.allOf)for(let M=0;M<O.allOf.length;M++)O.allOf[M]={...G,...O.allOf[M]};else if(O.not)O.not={...G,...O.not};A[Z]={...G,...$2(G,w,!1)};break;case"Object":case"Union":A[Z]=$2($,w,!1);break;default:if(Array.isArray($.items))for(let M=0;M<$.items.length;M++)$.items[M]=$2($.items[M],w,!1);else if($.anyOf||$.oneOf||$.allOf||$.not)A[Z]=$2($,w,!1);else if($.type==="array")$.items=$2($.items,w,!1);break}return z},z8=(z)=>(w)=>{if(typeof w==="object")try{return o.Clean(z,structuredClone(w))}catch{try{return o.Clean(z,w)}catch{return w}}return w},j2=(z,{models:w={},dynamic:U=!1,modules:W,normalize:X=!1,additionalProperties:A=!1,coerce:Z=!1,additionalCoerce:$=[]}={modules:I.Module({})})=>{if(!z)return;let Y;if(typeof z!=="string")Y=z;else{let J=z.endsWith("[]"),N=J?z.substring(0,z.length-2):z;if(Y=W.Import(N)??w[N],J)Y=I.Array(Y)}if(!Y)return;if(Z||$)if(Z)Y=Xw(Y,[{from:I.Ref(""),to:(J)=>W.Import(J.$ref)},{from:I.Number(),to:(J)=>I.Numeric(J),untilObjectFound:!0},{from:I.Boolean(),to:(J)=>I.BooleanString(J),untilObjectFound:!0},...Array.isArray($)?$:[$]]);else Y=Xw(Y,[{from:I.Ref(""),to:(J)=>W.Import(J.$ref)},...Array.isArray($)?$:[$]]);if(Y.type==="object"&&"additionalProperties"in Y===!1)Y.additionalProperties=A;if(U){let J={schema:Y,references:"",checkFunc:()=>{},code:"",Check:(N)=>o.Check(Y,N),Errors:(N)=>o.Errors(Y,N),Code:()=>"",Clean:z8(Y),Decode:(N)=>o.Decode(Y,N),Encode:(N)=>o.Encode(Y,N)};if(X&&Y.additionalProperties===!1)J.Clean=z8(Y);if(Y.config){if(J.config=Y.config,J?.schema?.config)delete J.schema.config}return J.parse=(N)=>{try{return J.Decode(N)}catch(S){throw[...J.Errors(N)].map(b1)}},J.safeParse=(N)=>{try{return{success:!0,data:J.Decode(N),error:null}}catch(S){let G=[...Q.Errors(N)].map(b1);return{success:!1,data:null,error:G[0]?.summary,errors:G}}},J}let Q=_6.Compile(Y,Object.values(w));if(Q.Clean=z8(Y),Y.config){if(Q.config=Y.config,Q?.schema?.config)delete Q.schema.config}return Q.parse=(J)=>{try{return Q.Decode(J)}catch(N){throw[...Q.Errors(J)].map(b1)}},Q.safeParse=(J)=>{try{return{success:!0,data:Q.Decode(J),error:null}}catch(N){let S=[...Q.Errors(J)].map(b1);return{success:!1,data:null,error:S[0]?.summary,errors:S}}},Q},HW=(z,{models:w={},modules:U,dynamic:W=!1,normalize:X=!1,additionalProperties:A=!1})=>{if(!z)return;let Z;if(typeof z!=="string")Z=z;else{let J=z.endsWith("[]"),N=J?z.substring(0,z.length-2):z;if(Z=U.Import(N)??w[N],J)Z=I.Array(Z)}if(!Z)return;let $=(J,N)=>{if(W)return{schema:J,references:"",checkFunc:()=>{},code:"",Check:(G)=>o.Check(J,G),Errors:(G)=>o.Errors(J,G),Code:()=>"",Clean:z8(J),Decode:(G)=>o.Decode(J,G),Encode:(G)=>o.Encode(J,G)};let S=_6.Compile(J,N);if(X&&J.additionalProperties===!1)S.Clean=z8(J);return S},Y=Object.values(w);if(H in Z){if("additionalProperties"in Z===!1)Z.additionalProperties=A;return{200:$(Z,Y)}}let Q={};return Object.keys(Z).forEach((J)=>{let N=Z[+J];if(typeof N==="string"){if(N in w){let S=w[N];S.type==="object"&&"additionalProperties"in S,Q[+J]=H in S?$(S,Y):S}return}if(N.type==="object"&&"additionalProperties"in N===!1)N.additionalProperties=A;Q[+J]=H in N?$(N,Y):N}),Q},eN=typeof Bun!=="undefined",zG=eN&&typeof Bun.hash==="function",r4=(z)=>{if(zG)return Bun.hash(z);let w=9;for(let U=0;U<z.length;)w=Math.imul(w^z.charCodeAt(U++),387420489);return w=w^w>>>9},rz,y6=()=>{if(!rz)rz=[{from:I.Object({}),to:()=>I.ObjectString({}),excludeRoot:!0},{from:I.Array(I.Any()),to:()=>I.ArrayString(I.Any())}];return rz},az,_W=()=>{if(!az)az=[{from:I.Number(),to:(z)=>I.Numeric(z),rootOnly:!0},{from:I.Boolean(),to:(z)=>I.BooleanString(z),rootOnly:!0}];return az},dW=({validator:z,modules:w,defaultConfig:U={},config:W,dynamic:X,models:A})=>{let Z=j2(z,{modules:w,dynamic:X,models:A,additionalProperties:!0,coerce:!0,additionalCoerce:y6()});if(w1(U))if(Z)Z.config=sN(Z.config,W);else Z=j2(I.Cookie({}),{modules:w,dynamic:X,models:A,additionalProperties:!0}),Z.config=U;return Z},O1=(z,w)=>{if(!w)return;if(!Array.isArray(w)){let W=w;if(z&&!W.checksum)W.checksum=z;if(W.scope==="scoped")W.scope="local";return W}let U=[...w];for(let W of U){if(z&&!W.checksum)W.checksum=z;if(W.scope==="scoped")W.scope="local"}return U},SW=(z,w,U)=>{return{start:v0(z.start,O1(U,w?.start)),request:v0(z.request,O1(U,w?.request)),parse:v0(z.parse,O1(U,w?.parse)),transform:v0(z.transform,O1(U,w?.transform)),beforeHandle:v0(v0(W2(z.resolve,"resolve"),z.beforeHandle),O1(U,v0(W2(w?.resolve,"resolve"),w?.beforeHandle))),afterHandle:v0(z.afterHandle,O1(U,w?.afterHandle)),mapResponse:v0(z.mapResponse,O1(U,w?.mapResponse)),afterResponse:v0(z.afterResponse,O1(U,w?.afterResponse)),trace:v0(z.trace,O1(U,w?.trace)),error:v0(z.error,O1(U,w?.error)),stop:v0(z.stop,O1(U,w?.stop))}},wG=(z,w,{skipIfHasType:U=!1}={})=>{if(!z)return z;if(!Array.isArray(z)){if(U)z.scope??=w;else z.scope=w;return z}for(let W of z)if(U)W.scope??=w;else W.scope=w;return z},S6=(z)=>{if(!z)return z;if(!Array.isArray(z))switch(z.scope){case"global":case"scoped":return{...z};default:return{fn:z}}let w=[];for(let U of z)switch(U.scope){case"global":case"scoped":w.push({...U});break}return w},DW=(z)=>{return{...z,type:z?.type,detail:z?.detail,parse:S6(z?.parse),transform:S6(z?.transform),beforeHandle:S6(z?.beforeHandle),afterHandle:S6(z?.afterHandle),mapResponse:S6(z?.mapResponse),afterResponse:S6(z?.afterResponse),error:S6(z?.error),trace:S6(z?.trace)}},p5={Continue:100,"Switching Protocols":101,Processing:102,"Early Hints":103,OK:200,Created:201,Accepted:202,"Non-Authoritative Information":203,"No Content":204,"Reset Content":205,"Partial Content":206,"Multi-Status":207,"Already Reported":208,"Multiple Choices":300,"Moved Permanently":301,Found:302,"See Other":303,"Not Modified":304,"Temporary Redirect":307,"Permanent Redirect":308,"Bad Request":400,Unauthorized:401,"Payment Required":402,Forbidden:403,"Not Found":404,"Method Not Allowed":405,"Not Acceptable":406,"Proxy Authentication Required":407,"Request Timeout":408,Conflict:409,Gone:410,"Length Required":411,"Precondition Failed":412,"Payload Too Large":413,"URI Too Long":414,"Unsupported Media Type":415,"Range Not Satisfiable":416,"Expectation Failed":417,"I'm a teapot":418,"Misdirected Request":421,"Unprocessable Content":422,Locked:423,"Failed Dependency":424,"Too Early":425,"Upgrade Required":426,"Precondition Required":428,"Too Many Requests":429,"Request Header Fields Too Large":431,"Unavailable For Legal Reasons":451,"Internal Server Error":500,"Not Implemented":501,"Bad Gateway":502,"Service Unavailable":503,"Gateway Timeout":504,"HTTP Version Not Supported":505,"Variant Also Negotiates":506,"Insufficient Storage":507,"Loop Detected":508,"Not Extended":510,"Network Authentication Required":511},PW=Object.fromEntries(Object.entries(p5).map(([z,w])=>[w,z]));function UG(z){let w=z;while(w.endsWith("="))w=w.slice(0,-1);return w}var OW=new TextEncoder,u5=async(z,w)=>{if(typeof z!=="string")throw new TypeError("Cookie value must be provided as a string.");if(w===null)throw new TypeError("Secret key must be provided.");let U=await crypto.subtle.importKey("raw",OW.encode(w),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),W=await crypto.subtle.sign("HMAC",U,OW.encode(z));return z+"."+UG(Buffer.from(W).toString("base64"))},RW=async(z,w)=>{if(typeof z!=="string")throw new TypeError("Signed cookie string must be provided.");if(w===null)throw new TypeError("Secret key must be provided.");let U=z.slice(0,z.lastIndexOf("."));return await u5(U,w)===z?U:!1},WG=(z,w,U)=>{if(!z||typeof z!=="object"||!w)return;for(let[W,X]of Object.entries(w)){if(W in aN||!(W in z))continue;let A=z[W];if(typeof A==="function"){let Z=A(X);if(typeof Z==="object")for(let[$,Y]of Object.entries(Z))U($)({fn:Y})}delete w[W]}},XG=({globalHook:z,localHook:w})=>(U)=>(W,X)=>{if(typeof W==="function")W={fn:W};if(U==="resolve")W={...W,subType:"resolve"};if("fn"in W||Array.isArray(W)){if(!w[U])w[U]=[];if(typeof w[U]==="function")w[U]=[w[U]];if(Array.isArray(W))w[U]=w[U].concat(W);else w[U].push(W);return}let{insert:A="after",stack:Z="local"}=W;if(typeof X==="function")X={fn:X};if(Z==="global")if(!Array.isArray(X))if(A==="before")z[U].unshift(X);else z[U].push(X);else if(A==="before")z[U]=X.concat(z[U]);else z[U]=z[U].concat(X);else{if(!w[U])w[U]=[];if(typeof w[U]==="function")w[U]=[w[U]];if(!Array.isArray(X))if(A==="before")w[U].unshift(X);else w[U].push(X);else if(A==="before")w[U]=X.concat(w[U]);else w[U]=w[U].concat(X)}},AG=(z)=>{if(typeof z==="number")return z;if(z.length<16){if(z.trim().length===0)return null;let w=Number(z);if(Number.isNaN(w))return null;return w}if(z.length===16){if(z.trim().length===0)return null;let w=Number(z);if(Number.isNaN(w)||w.toString()!==z)return null;return w}return null},Yw=(z)=>AG(z)!==null;class hW{onError;root=null;promises=[];constructor(z=console.error){this.onError=z}get size(){return this.promises.length}add(z){return this.promises.push(z),this.root||=this.drain(),z}async drain(){while(this.promises.length>0){try{await this.promises[0]}catch(z){this.onError(z)}this.promises.shift()}this.root=null}then(z,w){return(this.root??Promise.resolve()).then(z,w)}}var W2=(z,w)=>{if(!z)return z;if(!Array.isArray(z)){if(typeof z==="function"||typeof z==="string")return w?{fn:z,subType:w}:{fn:z};else if("fn"in z)return z}let U=[];for(let W of z)if(typeof W==="function"||typeof W==="string")U.push(w?{fn:W,subType:w}:{fn:W});else if("fn"in W)U.push(W);return U},ZG=(z)=>{return{...z,start:W2(z?.start),request:W2(z?.request),parse:W2(z?.parse),transform:W2(z?.transform),beforeHandle:W2(z?.beforeHandle),afterHandle:W2(z?.afterHandle),mapResponse:W2(z?.mapResponse),afterResponse:W2(z?.afterResponse),trace:W2(z?.trace),error:W2(z?.error),stop:W2(z?.stop)}},CW=(z)=>{let w={};if(z.start?.map)w.start=z.start.map((U)=>U.fn);if(z.request?.map)w.request=z.request.map((U)=>U.fn);if(z.parse?.map)w.parse=z.parse.map((U)=>U.fn);if(z.transform?.map)w.transform=z.transform.map((U)=>U.fn);if(z.beforeHandle?.map)w.beforeHandle=z.beforeHandle.map((U)=>U.fn);if(z.afterHandle?.map)w.afterHandle=z.afterHandle.map((U)=>U.fn);if(z.mapResponse?.map)w.mapResponse=z.mapResponse.map((U)=>U.fn);if(z.afterResponse?.map)w.afterResponse=z.afterResponse.map((U)=>U.fn);if(z.trace?.map)w.trace=z.trace.map((U)=>U.fn);if(z.error?.map)w.error=z.error.map((U)=>U.fn);if(z.stop?.map)w.stop=z.stop.map((U)=>U.fn);return w},ez=(z)=>({body:z.body,cookie:z.cookie,headers:z.headers,query:z.query,set:z.set,server:z.server,request:z.request,route:z.route}),cW=(z,w=302)=>Response.redirect(z,w),Wf=Symbol("ElysiaFormData"),l5=Symbol("ElysiaRequestId");var iW=()=>{let z=crypto.randomUUID();return z.slice(0,8)+z.slice(24,32)},bW=(z)=>{let w=[];for(let U=0;U<z.length;U++){let W=z[U];if(W.checksum){if(w.includes(W.checksum))z.splice(U,1),U--;w.push(W.checksum)}}return z},L2=(z,w="scoped")=>{if(!z)return;if(w==="scoped"){for(let U of z)if("scope"in U&&U.scope==="local")U.scope="scoped";return}for(let U of z)if("scope"in U)U.scope="global"},D4=(z)=>{if(z.charCodeAt(z.length-1)===47)return z.slice(0,z.length-1);return z+"/"},w1=(z)=>{if(!z)return!1;for(let w in z)return!0;return!1},R1=(z)=>{if(Array.isArray(z))return z.length===0;return!z},zw=(z)=>{let w={...z};if(R1(z.afterHandle))delete w.afterHandle;if(R1(z.afterResponse))delete w.afterResponse;if(R1(z.beforeHandle))delete w.beforeHandle;if(R1(z.error))delete w.error;if(R1(z.mapResponse))delete w.mapResponse;if(R1(z.parse))delete w.parse;if(R1(z.request))delete w.request;if(R1(z.start))delete w.start;if(R1(z.stop))delete w.stop;if(R1(z.trace))delete w.trace;if(R1(z.transform))delete w.transform;if(!w.type)delete w.type;if(w.detail&&!Object.keys(w.detail).length)delete w.detail;if(!w.body)delete w.body;if(!w.cookie)delete w.cookie;if(!w.headers)delete w.headers;if(!w.query)delete w.query;if(!w.params)delete w.params;if(!w.response)delete w.response;return w},a4=(z,{dynamic:w=!1}={})=>{let U=encodeURIComponent(z).replace(/%2F/g,"/");if(w)U=U.replace(/%3A/g,":").replace(/%3F/g,"?");return U},KW=typeof Bun!=="undefined"?Bun.env:typeof process!=="undefined"?process?.env:void 0,m5=Symbol("ElysiaErrorCode"),t5=(KW?.NODE_ENV??KW?.ENV)==="production";class K1{code;response;constructor(z,w){let U=w??(z in PW?PW[z]:z);this.code=p5[z]??z,this.response=U}}var yW=(z,w)=>new K1(z,w);class vW extends Error{code="INTERNAL_SERVER_ERROR";status=500;constructor(z){super(z??"INTERNAL_SERVER_ERROR")}}class Qw extends Error{code="NOT_FOUND";status=404;constructor(z){super(z??"NOT_FOUND")}}class nW extends Error{code="PARSE";status=400;constructor(){super("Bad Request")}}class Aw extends Error{key;code="INVALID_COOKIE_SIGNATURE";status=400;constructor(z,w){super(w??`"${z}" has invalid cookie signature`);this.key=z}}var b1=(z)=>{if(!z)return{summary:void 0};let{message:w,path:U,value:W,type:X}=z,A=U.slice(1).replaceAll("/","."),Z=U==="";switch(X){case 42:return{...z,summary:Z?"Value should not be provided":`Property '${A}' should not be provided`};case 45:return{...z,summary:Z?"Value is missing":`Property '${A}' is missing`};case 50:let $=w.indexOf("'"),Y=w.slice($+1,w.indexOf("'",$+1));return{...z,summary:Z?"Value should be an email":`Property '${A}' should be ${Y}`};case 54:return{...z,summary:`${w.slice(0,9)} property '${A}' to be ${w.slice(8)} but found: ${W}`};case 62:let Q=z.schema.anyOf.map((J)=>`'${J?.format??J.type}'`).join(", ");return{...z,summary:Z?`Value should be one of ${Q}`:`Property '${A}' should be one of: ${Q}`};default:return{summary:w,...z}}};class r extends Error{type;validator;value;code="VALIDATION";status=422;constructor(z,w,U){if(U&&typeof U==="object"&&U instanceof K1)U=U.response;let W=t5?void 0:("Errors"in w)?w.Errors(U).First():o.Errors(w,U).First(),X=W?.schema?.message||W?.schema?.error!==void 0?typeof W.schema.error==="function"?W.schema.error({type:z,validator:w,value:U,get errors(){return[...w.Errors(U)].map(b1)}}):W.schema.error:void 0,A=W?.path||"root",Z="";if(X!==void 0)Z=typeof X==="object"?JSON.stringify(X):X+"";else if(t5)Z=JSON.stringify({type:"validation",on:z,summary:b1(W).summary,message:W?.message,found:U});else{let $=w?.schema??w,Y="Errors"in w?[...w.Errors(U)].map(b1):[...o.Errors(w,U)].map(b1),Q;try{Q=o.Create($)}catch(J){Q={type:"Could not create expected value",message:J?.message,error:J}}Z=JSON.stringify({type:"validation",on:z,summary:b1(W).summary,property:A,message:W?.message,expected:Q,found:U,errors:Y},null,2)}super(Z);this.type=z,this.validator=w,this.value=U,Object.setPrototypeOf(this,r.prototype)}get all(){return"Errors"in this.validator?[...this.validator.Errors(this.value)].map(b1):[...o.Errors(this.validator,this.value)].map(b1)}static simplifyModel(z){let w="schema"in z?z.schema:z;try{return o.Create(w)}catch{return w}}get model(){return r.simplifyModel(this.validator)}toResponse(z){return new Response(this.message,{status:400,headers:{...z,"content-type":"application/json"}})}}var uW=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,mW=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,tW=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,$G=$w.date,YG=$w["date-time"];if(!D0.Has("date"))D0.Set("date",(z)=>{let w=z.replace(/"/g,"");if(uW.test(w)||mW.test(w)||tW.test(w)||$G(w)){let U=new Date(w);if(!Number.isNaN(U.getTime()))return!0}return!1});if(!D0.Has("date-time"))D0.Set("date-time",(z)=>{let w=z.replace(/"/g,"");if(uW.test(w)||mW.test(w)||tW.test(w)||YG(w)){let U=new Date(w);if(!Number.isNaN(U.getTime()))return!0}return!1});Object.entries($w).forEach((z)=>{let[w,U]=z;if(!D0.Has(w)){if(U instanceof RegExp)D0.Set(w,(W)=>U.test(W));else if(typeof U==="function")D0.Set(w,U)}});var I=Object.assign({},G6),FW=(z)=>{if(typeof z==="string")switch(z.slice(-1)){case"k":return+z.slice(0,z.length-1)*1024;case"m":return+z.slice(0,z.length-1)*1048576;default:return+z}return z},jW=(z,w)=>{if(z.startsWith(w))return!0;return w.charCodeAt(w.length-1)===42&&w.charCodeAt(w.length-2)===47&&z.startsWith(w.slice(0,-1))},Zw=(z,w)=>{if(!(w instanceof Blob))return!1;if(z.minSize&&w.size<FW(z.minSize))return!1;if(z.maxSize&&w.size>FW(z.maxSize))return!1;if(z.extension){if(typeof z.extension==="string")return jW(w.type,z.extension);for(let U=0;U<z.extension.length;U++)if(jW(w.type,z.extension[U]))return!0;return!1}return!0},QG=oW("File",Zw),JG=oW("Files",(z,w)=>{if(!Array.isArray(w))return Zw(z,w);if(z.minItems&&w.length<z.minItems)return!1;if(z.maxItems&&w.length>z.maxItems)return!1;for(let U=0;U<w.length;U++)if(!Zw(z,w[U]))return!1;return!0});if(!D0.Has("numeric"))D0.Set("numeric",(z)=>!!z&&!isNaN(+z));if(!D0.Has("integer"))D0.Set("integer",(z)=>!!z&&Number.isInteger(+z));if(!D0.Has("boolean"))D0.Set("boolean",(z)=>z==="true"||z==="false");if(!D0.Has("ObjectString"))D0.Set("ObjectString",(z)=>{let w=z.charCodeAt(0);if(w===9||w===10||w===32)w=z.trimStart().charCodeAt(0);if(w!==123&&w!==91)return!1;try{return JSON.parse(z),!0}catch{return!1}});if(!D0.Has("ArrayString"))D0.Set("ArrayString",(z)=>{let w=z.charCodeAt(0);if(w===9||w===10||w===32)w=z.trimStart().charCodeAt(0);if(w!==123&&w!==91)return!1;try{return JSON.parse(z),!0}catch{return!1}});if(!p0.Has("UnionEnum"))p0.Set("UnionEnum",(z,w)=>{return(typeof w==="number"||typeof w==="string"||w===null)&&z.enum.includes(w)});var U1={Numeric:(z)=>{let w=G6.Number(z);return I.Transform(I.Union([I.String({format:"numeric",default:0}),I.Number(z)],z)).Decode((U)=>{let W=+U;if(isNaN(W))return U;if(z&&!o.Check(w,W))throw new r("property",w,W);return W}).Encode((U)=>U)},Integer:(z)=>{let w=G6.Integer(z);return I.Transform(I.Union([I.String({format:"integer",default:0}),G6.Integer(z)],z)).Decode((U)=>{let W=+U;if(!o.Check(w,W))throw new r("property",w,W);return W}).Encode((U)=>U)},Date:(z)=>{let w=G6.Date(z),U=z?.default?new Date(z.default):void 0;return I.Transform(I.Union([G6.Date(z),I.String({format:"date",default:U?.toISOString()}),I.String({format:"date-time",default:U?.toISOString()}),I.Number({default:U?.getTime()})],z)).Decode((W)=>{if(typeof W==="number"){let A=new Date(W);if(!o.Check(w,A))throw new r("property",w,A);return A}if(W instanceof Date)return W;let X=new Date(W);if(!X||isNaN(X.getTime()))throw new r("property",w,X);if(!o.Check(w,X))throw new r("property",w,X);return X}).Encode((W)=>W.toISOString())},BooleanString:(z)=>{let w=G6.Boolean(z);return I.Transform(I.Union([I.Boolean(z),I.String({format:"boolean",default:!1})],z)).Decode((U)=>{if(typeof U==="string")return U==="true";if(U!==void 0&&!o.Check(w,U))throw new r("property",w,U);return U}).Encode((U)=>U)},ObjectString:(z,w)=>{let U=I.Object(z,w),W=JSON.stringify(o.Create(U)),X;try{X=_6.Compile(U)}catch{}return I.Transform(I.Union([I.String({format:"ObjectString",default:W}),U])).Decode((A)=>{if(typeof A==="string"){if(A.charCodeAt(0)!==123)throw new r("property",U,A);try{A=JSON.parse(A)}catch{throw new r("property",U,A)}if(X){if(!X.Check(A))throw new r("property",U,A);return X.Decode(A)}if(!o.Check(U,A))throw new r("property",U,A);return o.Decode(U,A)}return A}).Encode((A)=>{if(typeof A==="string")try{A=JSON.parse(A)}catch{throw new r("property",U,A)}if(!o.Check(U,A))throw new r("property",U,A);return JSON.stringify(A)})},ArrayString:(z=I.String(),w)=>{let U=I.Array(z,w),W;try{W=_6.Compile(U)}catch{}let X=(A,Z=!1)=>{if(A.charCodeAt(0)===91){try{A=JSON.parse(A)}catch{throw new r("property",U,A)}if(W){if(!W.Check(A))throw new r("property",U,A);return W.Decode(A)}if(!o.Check(U,A))throw new r("property",U,A);return o.Decode(U,A)}if(A.indexOf(",")!==-1){let $=A.split(",").map((Y)=>Y.trim());if(W){if(!W.Check($))throw new r("property",U,A);return W.Decode($)}if(!o.Check(U,$))throw new r("property",U,$);return o.Decode(U,$)}if(Z)return A;throw new r("property",U,A)};return I.Transform(I.Union([I.String({format:"ArrayString",default:w?.default}),U])).Decode((A)=>{if(Array.isArray(A)){let Z=[];for(let $=0;$<A.length;$++){let Y=A[$];if(typeof Y==="string"){let Q=X(Y,!0);if(Array.isArray(Q))Z=Z.concat(Q);else Z.push(Q);continue}Z.push(Y)}return Z}if(typeof A==="string")return X(A);return A}).Encode((A)=>{if(typeof A==="string")try{A=JSON.parse(A)}catch{throw new r("property",U,A)}if(!o.Check(U,A))throw new r("property",U,A);return JSON.stringify(A)})},File:QG,Files:(z={})=>I.Transform(JG(z)).Decode((w)=>{if(Array.isArray(w))return w;return[w]}).Encode((w)=>w),Nullable:(z,w)=>I.Union([z,I.Null()],w),MaybeEmpty:(z,w)=>I.Union([z,I.Null(),I.Undefined()],w),Cookie:(z,{domain:w,expires:U,httpOnly:W,maxAge:X,path:A,priority:Z,sameSite:$,secure:Y,secrets:Q,sign:J,...N}={})=>{let S=I.Object(z,N);return S.config={domain:w,expires:U,httpOnly:W,maxAge:X,path:A,priority:Z,sameSite:$,secure:Y,secrets:Q,sign:J},S},UnionEnum:(z,w={})=>{let U=z.every((W)=>typeof W==="string")?{type:"string"}:z.every((W)=>typeof W==="number")?{type:"number"}:z.every((W)=>W===null)?{type:"null"}:{};if(z.some((W)=>typeof W==="object"&&W!==null))throw new Error("This type does not support objects or arrays");return{default:z[0],...w,[H]:"UnionEnum",...U,enum:z}}};I.BooleanString=U1.BooleanString;I.ObjectString=U1.ObjectString;I.ArrayString=U1.ArrayString;I.Numeric=U1.Numeric;I.Integer=U1.Integer;I.File=(z={})=>U1.File({default:"File",...z,extension:z?.type,type:"string",format:"binary"});I.Files=(z={})=>U1.Files({...z,elysiaMeta:"Files",default:"Files",extension:z?.type,type:"array",items:{...z,default:"Files",type:"string",format:"binary"}});I.Nullable=(z)=>U1.Nullable(z);I.MaybeEmpty=U1.MaybeEmpty;I.Cookie=U1.Cookie;I.Date=U1.Date;I.UnionEnum=U1.UnionEnum;function oW(z,w){if(!p0.Has(z))p0.Set(z,w);return(U={})=>j5({...U,[H]:z})}var w8=(z)=>{let w=typeof z==="object"?z.fn.toString():typeof z==="string"?z.toString():z,U=w.indexOf(")");if(w.charCodeAt(U+2)===61&&w.charCodeAt(U+5)!==123)return!0;return w.includes("return")},BG=(z)=>{if(z.startsWith("async"))z=z.slice(5);z=z.trimStart();let w=-1;if(z.charCodeAt(0)===40){if(w=z.indexOf("=>",z.indexOf(")")),w!==-1){let X=w;while(X>0)if(z.charCodeAt(--X)===41)break;let A=z.slice(w+2);if(A.charCodeAt(0)===32)A=A.trimStart();return[z.slice(1,X),A,{isArrowReturn:A.charCodeAt(0)!==123}]}}if(/^(\w+)=>/g.test(z)){if(w=z.indexOf("=>"),w!==-1){let X=z.slice(w+2);if(X.charCodeAt(0)===32)X=X.trimStart();return[z.slice(0,w),X,{isArrowReturn:X.charCodeAt(0)!==123}]}}if(z.startsWith("function")){w=z.indexOf("(");let X=z.indexOf(")");return[z.slice(w+1,X),z.slice(X+2),{isArrowReturn:!1}]}let U=z.indexOf("(");if(U!==-1){let X=z.indexOf(`
`,2),A=z.slice(0,X),Z=A.lastIndexOf(")")+1,$=z.slice(X+1);return[A.slice(U,Z),"{"+$,{isArrowReturn:!1}]}let W=z.split(`
`,2);return[W[0],W[1],{isArrowReturn:!1}]},MG=(z)=>{let w=z.indexOf("{");if(w===-1)return[-1,0];let U=w+1,W=1;for(;U<z.length;U++){let X=z.charCodeAt(U);if(X===123)W++;else if(X===125)W--;if(W===0)break}if(W!==0)return[0,z.length];return[w,U+1]},qG=(z)=>{let w=z.lastIndexOf("}");if(w===-1)return[-1,0];let U=w-1,W=1;for(;U>=0;U--){let X=z.charCodeAt(U);if(X===125)W++;else if(X===123)W--;if(W===0)break}if(W!==0)return[-1,0];return[U,w+1]},pW=(z)=>{while(!0){let w=z.indexOf(":");if(w===-1)break;let U=z.indexOf(",",w);if(U===-1)U=z.indexOf("}",w)-1;if(U===-2)U=z.length;z=z.slice(0,w)+z.slice(U)}return z},lW=(z)=>{let w=!1;if(z.charCodeAt(0)===40)z=z.slice(1,-1);if(z.charCodeAt(0)===123)w=!0,z=z.slice(1,-1);z=z.replace(/( |\t|\n)/g,"").trim();let U=[];while(!0){let[X,A]=MG(z);if(X===-1)break;if(U.push(z.slice(0,X-1)),z.charCodeAt(A)===44)A++;z=z.slice(A)}if(z=pW(z),z)U=U.concat(z.split(","));let W=[];for(let X of U){if(X.indexOf(",")===-1){W.push(X);continue}for(let A of X.split(","))W.push(A.trim())}return U=W,{hasParenthesis:w,parameters:U}},LG=(z,w)=>{let{parameters:U,hasParenthesis:W}=lW(z);if(!w.query&&U.includes("query"))w.query=!0;if(!w.headers&&U.includes("headers"))w.headers=!0;if(!w.body&&U.includes("body"))w.body=!0;if(!w.cookie&&U.includes("cookie"))w.cookie=!0;if(!w.set&&U.includes("set"))w.set=!0;if(!w.server&&U.includes("server"))w.server=!0;if(!w.request&&U.includes("request"))w.request=!0;if(!w.route&&U.includes("route"))w.route=!0;if(W)return`{ ${U.join(", ")} }`;return U.join(", ")},EW=(z,w,U)=>{let W=w.indexOf(z+`
`,U),X=w.indexOf(z+"\t",U),A=w.indexOf(z+",",U),Z=w.indexOf(z+";",U),$=w.indexOf(z+" ",U);return[W,X,A,Z,$].filter((Y)=>Y>0).sort((Y,Q)=>Y-Q)[0]||-1},sW=(z,w,U=0)=>{if(U>5)return[];let W=[],X=w;while(!0){let A=EW(" = "+z,X);if(A===-1)A=EW("="+z,X);if(A===-1){let Q=X.indexOf(" = "+z);if(Q===-1)Q=X.indexOf("="+z);if(Q+3+z.length!==X.length)break;A=Q}let Z=X.slice(0,A),$=Z.lastIndexOf(" "),Y=Z.slice($!==-1?$+1:-1);if(Y==="}"){let[Q,J]=qG(Z);W.push(pW(X.slice(Q,J))),X=X.slice(A+3+z.length);continue}while(Y.charCodeAt(0)===44)Y=Y.slice(1);while(Y.charCodeAt(0)===9)Y=Y.slice(1);if(!Y.includes("("))W.push(Y);X=X.slice(A+3+z.length)}for(let A of W){if(A.charCodeAt(0)===123)continue;let Z=sW(A,w);if(Z.length>0)W.push(...Z)}return W},NG=(z)=>{if(!z)return;if(z.charCodeAt(0)!==123)return z;if(z=z.slice(2,-2),!z.includes(",")){if(z.includes("..."))return z.slice(z.indexOf("...")+3);return}let w=z.indexOf("...");if(w===-1)return;return z.slice(w+3).trimEnd()},GG=(z,w,U)=>{let W=(X,A)=>z.includes(A+"."+X)||z.includes(A+'["'+X+'"]')||z.includes(A+"['"+X+"']");for(let X of w){if(!X)continue;if(X.charCodeAt(0)===123){let A=lW(X).parameters;if(!U.query&&A.includes("query"))U.query=!0;if(!U.headers&&A.includes("headers"))U.headers=!0;if(!U.body&&A.includes("body"))U.body=!0;if(!U.cookie&&A.includes("cookie"))U.cookie=!0;if(!U.set&&A.includes("set"))U.set=!0;if(!U.query&&A.includes("server"))U.server=!0;if(!U.request&&A.includes("request"))U.request=!0;if(!U.route&&A.includes("route"))U.route=!0;continue}if(!U.query&&W("query",X))U.query=!0;if(z.includes("return "+X)||z.includes("return "+X+".query"))U.query=!0;if(!U.headers&&W("headers",X))U.headers=!0;if(!U.body&&W("body",X))U.body=!0;if(!U.cookie&&W("cookie",X))U.cookie=!0;if(!U.set&&W("set",X))U.set=!0;if(!U.server&&W("server",X))U.server=!0;if(U.query&&U.headers&&U.body&&U.cookie&&U.set&&U.server&&U.server&&U.route)break}return w},HG=(z,w,U)=>{try{let W=new RegExp(`(?:\\w)\\((?:.*)?${z}`,"gs");W.test(w);let X=w.charCodeAt(W.lastIndex);if(X===41||X===44)return U.query=!0,U.headers=!0,U.body=!0,U.cookie=!0,U.set=!0,U.server=!0,U.route=!0,U.request=!0,!0;return!1}catch(W){return console.log("[Sucrose] warning: unexpected isContextPassToFunction error, you may continue development as usual but please report the following to maintainers:"),console.log("--- body ---"),console.log(w),console.log("--- context ---"),console.log(z),!0}},rW=(z,w={query:!1,headers:!1,body:!1,cookie:!1,set:!1,server:!1,request:!1,route:!1})=>{let U=[];if(z.handler&&typeof z.handler==="function")U.push(z.handler);if(z.request?.length)U.push(...z.request);if(z.beforeHandle?.length)U.push(...z.beforeHandle);if(z.parse?.length)U.push(...z.parse);if(z.error?.length)U.push(...z.error);if(z.transform?.length)U.push(...z.transform);if(z.afterHandle?.length)U.push(...z.afterHandle);if(z.mapResponse?.length)U.push(...z.mapResponse);if(z.afterResponse?.length)U.push(...z.afterResponse);for(let W of U){if(!W)continue;let X="fn"in W?W.fn:W;if(typeof X!=="function")continue;let[A,Z,{isArrowReturn:$}]=BG(X.toString()),Y=LG(A,w),Q=NG(Y);if(Q){let J=sW(Q,Z.slice(1,-1));J.splice(0,-1,Q);let N=Z;if(N.charCodeAt(0)===123&&N.charCodeAt(Z.length-1)===125)N=N.slice(1,-1);if(!HG(Q,N,w))GG(N,J,w);if(!w.query&&N.includes("return "+Q+".query"))w.query=!0}if(w.query&&w.headers&&w.body&&w.cookie&&w.set&&w.server&&w.request&&w.route)break}return w},v6=[];for(let z=48;z<58;z++)v6[z]=z-48;for(let z=0;z<6;z++)v6[z+65]=v6[z+97]=z+10;var _G=(z,w)=>{if(z in v6&&w in v6)return v6[z]<<4|v6[w];return 255},aW=[...new Array(128).fill(0),...new Array(16).fill(1),...new Array(16).fill(2),...new Array(32).fill(3),4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4],SG=[0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0],IW=aW.map((z)=>[127,63,63,63,0,31,15,15,15,7,7,7][z]),P6=(z)=>{let w=z.indexOf("%");if(w===-1)return z;let U=z.length-3;if(w>U)return null;let W="",X=0,A=0,Z=w,$=12,Y;for(;;){if(Y=_G(z.charCodeAt(w+1),z.charCodeAt(w+2)),$=SG[$+aW[Y]],$===0)return null;if($===12){if(W+=z.substring(X,Z),A=A<<6|Y&IW[Y],A>65535)W+=String.fromCharCode(55232+(A>>10),56320+(A&1023));else W+=String.fromCharCode(A);if(X=w+3,w=z.indexOf("%",X),w===-1)return W+z.substring(X);if(w>U)return null;Z=w,A=0}else{if(w+=3,w>U||z.charCodeAt(w)!==37)return null;A=A<<6|Y&IW[Y]}}};class R4{name;jar;initial;constructor(z,w,U={}){this.name=z,this.jar=w,this.initial=U}get cookie(){return this.jar[this.name]??this.initial}set cookie(z){if(!(this.name in this.jar))this.jar[this.name]=this.initial;this.jar[this.name]=z}get setCookie(){if(!(this.name in this.jar))this.jar[this.name]=this.initial;return this.jar[this.name]}set setCookie(z){this.cookie=z}get value(){return this.cookie.value}set value(z){this.setCookie.value=z}get expires(){return this.cookie.expires}set expires(z){this.setCookie.expires=z}get maxAge(){return this.cookie.maxAge}set maxAge(z){this.setCookie.maxAge=z}get domain(){return this.cookie.domain}set domain(z){this.setCookie.domain=z}get path(){return this.cookie.path}set path(z){this.setCookie.path=z}get secure(){return this.cookie.secure}set secure(z){this.setCookie.secure=z}get httpOnly(){return this.cookie.httpOnly}set httpOnly(z){this.setCookie.httpOnly=z}get sameSite(){return this.cookie.sameSite}set sameSite(z){this.setCookie.sameSite=z}get priority(){return this.cookie.priority}set priority(z){this.setCookie.priority=z}get partitioned(){return this.cookie.partitioned}set partitioned(z){this.setCookie.partitioned=z}get secrets(){return this.cookie.secrets}set secrets(z){this.setCookie.secrets=z}update(z){return this.setCookie=Object.assign(this.cookie,typeof z==="function"?z(this.cookie):z),this}set(z){return this.setCookie=Object.assign({...this.initial,value:this.value},typeof z==="function"?z(this.cookie):z),this}remove(){if(this.value===void 0)return;return this.set({expires:new Date(0),maxAge:0,value:""}),this}toString(){return typeof this.value==="object"?JSON.stringify(this.value):this.value?.toString()??""}}var xW=(z,w,U)=>{if(!z.cookie)z.cookie={};return new Proxy(w,{get(W,X){if(X in w)return new R4(X,z.cookie,Object.assign({},U??{},w[X]));return new R4(X,z.cookie,Object.assign({},U))}})},eW=async(z,w,{secrets:U,sign:W,...X}={})=>{if(!w)return xW(z,{},X);let A=typeof U==="string";if(W&&W!==!0&&!Array.isArray(W))W=[W];let Z={},$=s5.parse(w);for(let[Y,Q]of Object.entries($)){if(Q===void 0)continue;let J=P6(Q);if(W===!0||W?.includes(Y)){if(!U)throw new Error("No secret is provided to cookie plugin");if(A){let N=await RW(J,U);if(N===!1)throw new Aw(Y);J=N}else{let N=!0;for(let S=0;S<U.length;S++){let G=await RW(J,U[S]);if(G!==!1){N=!0,J=G;break}}if(!N)throw new Aw(Y)}}Z[Y]={value:J}}return xW(z,Z,X)},zX=(z)=>{if(!z||!w1(z))return;let w=[];for(let[U,W]of Object.entries(z)){if(!U||!W)continue;let X=W.value;if(X===void 0||X===null)continue;w.push(s5.serialize(U,typeof X==="object"?JSON.stringify(X):X+"",W))}if(w.length===0)return;if(w.length===1)return w[0];return w},O6=(z,w)=>{let U=z.size;if(!w&&U||U&&w&&w.status!==206&&w.status!==304&&w.status!==412&&w.status!==416){if(w){if(w.headers instanceof Headers){let W={"accept-ranges":"bytes","content-range":`bytes 0-${U-1}/${U}`,"transfer-encoding":"chunked"};if(n5)W=w.headers.toJSON();else{W={};for(let[X,A]of w.headers.entries())if(X in w.headers)W[X]=A}return new Response(z,{status:w.status,headers:W})}if(w1(w.headers))return new Response(z,{status:w.status,headers:Object.assign({"accept-ranges":"bytes","content-range":`bytes 0-${U-1}/${U}`,"transfer-encoding":"chunked"},w.headers)})}return new Response(z,{headers:{"accept-ranges":"bytes","content-range":`bytes 0-${U-1}/${U}`,"transfer-encoding":"chunked"}})}return new Response(z)},wX=(z,w)=>{if(!z)return z;z.delete("set-cookie");for(let U=0;U<w.length;U++){let W=w[U].indexOf("=");z.append("set-cookie",`${w[U].slice(0,W)}=${w[U].slice(W+1)||""}`)}return z},n6=(z,w)=>{if(w?.headers){if(z){if(n5)Object.assign(w.headers,z.headers.toJSON());else for(let[U,W]of z.headers.entries())if(U in w.headers)w.headers[U]=W}if(w.status===200)w.status=z.status;if(w.headers["content-encoding"])delete w.headers["content-encoding"];return w}if(!z)return{headers:{},status:w?.status??200};if(n5){if(w={headers:z.headers.toJSON(),status:w?.status??200},w.headers["content-encoding"])delete w.headers["content-encoding"];return w}w={headers:{},status:w?.status??200};for(let[U,W]of z.headers.entries()){if(U==="content-encoding")continue;if(U in w.headers)w.headers[U]=W}return w},z1=async(z,w,U)=>{let W=z.next();if(W instanceof Promise)W=await W;if(W.done){if(w)return E2(W.value,w,U);return R6(W.value,U)}if(w?.headers){if(!w.headers["transfer-encoding"])w.headers["transfer-encoding"]="chunked";if(!w.headers["content-type"])w.headers["content-type"]="text/event-stream; charset=utf-8"}else w={status:200,headers:{"content-type":"text/event-stream; charset=utf-8","transfer-encoding":"chunked"}};return new Response(new ReadableStream({async start(X){let A=!1;if(U?.signal?.addEventListener("abort",()=>{A=!0;try{X.close()}catch{}}),W.value!==void 0&&W.value!==null)if(typeof W.value==="object")try{X.enqueue(Buffer.from(JSON.stringify(W.value)))}catch{X.enqueue(Buffer.from(W.value.toString()))}else X.enqueue(Buffer.from(W.value.toString()));for await(let Z of z){if(A)break;if(Z===void 0||Z===null)continue;if(typeof Z==="object")try{X.enqueue(Buffer.from(JSON.stringify(Z)))}catch{X.enqueue(Buffer.from(Z.toString()))}else X.enqueue(Buffer.from(Z.toString()));await new Promise(($)=>setTimeout(()=>$(),0))}try{X.close()}catch{}}}),w)};async function*u6(z){let w=z.body;if(!w)return;let U=w.getReader(),W=new TextDecoder;try{while(!0){let{done:X,value:A}=await U.read();if(X)break;yield W.decode(A)}}finally{U.releaseLock()}}var UX=(z)=>{if(typeof z.status==="string")z.status=p5[z.status];if(z.cookie&&w1(z.cookie)){let w=zX(z.cookie);if(w)z.headers["set-cookie"]=w}if(z.headers["set-cookie"]&&Array.isArray(z.headers["set-cookie"]))z.headers=wX(new Headers(z.headers),z.headers["set-cookie"])},o5=(z,w)=>{if(z.status!==w.status&&w.status!==200&&(z.status<=300||z.status>400))z=new Response(z.body,{headers:z.headers,status:w.status});let U=!1;if(w.headers instanceof Headers)for(let W of w.headers.keys())if(W==="set-cookie"){if(U)continue;U=!0;for(let X of w.headers.getSetCookie())z.headers.append("set-cookie",X)}else z.headers.append(W,w.headers?.get(W)??"");else for(let W in w.headers)z.headers.append(W,w.headers[W]);return z},E2=(z,w,U)=>{if(w1(w.headers)||w.status!==200||w.cookie)switch(UX(w),z?.constructor?.name){case"String":return new Response(z,w);case"Array":case"Object":return Response.json(z,w);case"ElysiaFile":return O6(z.value);case"Blob":return O6(z,w);case"ElysiaCustomStatusResponse":return w.status=z.code,E2(z.response,w,U);case"ReadableStream":if(!w.headers["content-type"]?.startsWith("text/event-stream"))w.headers["content-type"]="text/event-stream; charset=utf-8";return U?.signal?.addEventListener("abort",{handleEvent(){if(U?.signal&&!U?.signal?.aborted)z.cancel()}},{once:!0}),new Response(z,w);case void 0:if(!z)return new Response("",w);return Response.json(z,w);case"Response":if(z=o5(z,w),!z.headers.has("content-length")&&z.headers.get("transfer-encoding")==="chunked")return z1(u6(z),n6(z,w),U);return z;case"Error":return C6(z,w);case"Promise":return z.then((W)=>E2(W,w,U));case"Function":return E2(z(),w,U);case"Number":case"Boolean":return new Response(z.toString(),w);case"Cookie":if(z instanceof R4)return new Response(z.value,w);return new Response(z?.toString(),w);case"FormData":return new Response(z,w);default:if(z instanceof Response){if(z=o5(z,w),z.headers.get("transfer-encoding")==="chunked")return z1(u6(z),n6(z,w),U);return z}if(z instanceof Promise)return z.then((W)=>E2(W,w));if(z instanceof Error)return C6(z,w);if(z instanceof K1)return w.status=z.code,E2(z.response,w,U);if(typeof z?.next==="function")return z1(z,w,U);if(typeof z?.then==="function")return z.then((W)=>E2(W,w));if(typeof z?.toResponse==="function")return E2(z.toResponse(),w);if("charCodeAt"in z){let W=z.charCodeAt(0);if(W===123||W===91){if(!w.headers["Content-Type"])w.headers["Content-Type"]="application/json";return new Response(JSON.stringify(z),w)}}return new Response(z,w)}if(z instanceof Response&&!z.headers.has("content-length")&&z.headers.get("transfer-encoding")==="chunked")return z1(u6(z),n6(z,w),U);if(typeof z?.next==="function"||z instanceof ReadableStream)return z1(z,w,U);return R6(z,U)},K2=(z,w,U)=>{if(z===void 0||z===null)return;if(w1(w.headers)||w.status!==200||w.cookie)switch(UX(w),z?.constructor?.name){case"String":return new Response(z,w);case"Array":case"Object":return Response.json(z,w);case"ElysiaFile":return O6(z.value);case"Blob":return O6(z,w);case"ElysiaCustomStatusResponse":return w.status=z.code,K2(z.response,w,U);case"ReadableStream":if(!w.headers["content-type"]?.startsWith("text/event-stream"))w.headers["content-type"]="text/event-stream; charset=utf-8";return U?.signal?.addEventListener("abort",{handleEvent(){if(U?.signal&&!U?.signal?.aborted)z.cancel()}},{once:!0}),new Response(z,w);case void 0:if(!z)return;return Response.json(z,w);case"Response":if(z=o5(z,w),!z.headers.has("content-length")&&z.headers.get("transfer-encoding")==="chunked")return z1(u6(z),n6(z,w),U);return z;case"Promise":return z.then((W)=>K2(W,w));case"Error":return C6(z,w);case"Function":return K2(z(),w);case"Number":case"Boolean":return new Response(z.toString(),w);case"FormData":return new Response(z);case"Cookie":if(z instanceof R4)return new Response(z.value,w);return new Response(z?.toString(),w);default:if(z instanceof Response){if(z=o5(z,w),z.headers.get("transfer-encoding")==="chunked")return z1(u6(z),n6(z,w),U);return z}if(z instanceof Promise)return z.then((W)=>K2(W,w));if(z instanceof Error)return C6(z,w);if(z instanceof K1)return w.status=z.code,K2(z.response,w,U);if(typeof z?.next==="function")return z1(z,w,U);if(typeof z?.then==="function")return z.then((W)=>K2(W,w));if(typeof z?.toResponse==="function")return K2(z.toResponse(),w);if("charCodeAt"in z){let W=z.charCodeAt(0);if(W===123||W===91){if(!w.headers["Content-Type"])w.headers["Content-Type"]="application/json";return new Response(JSON.stringify(z),w)}}return new Response(z,w)}else switch(z?.constructor?.name){case"String":return new Response(z);case"Array":case"Object":return Response.json(z,w);case"ElysiaFile":return O6(z.value);case"Blob":return O6(z,w);case"ElysiaCustomStatusResponse":return w.status=z.code,K2(z.response,w,U);case"ReadableStream":return U?.signal?.addEventListener("abort",{handleEvent(){if(U?.signal&&!U?.signal?.aborted)z.cancel()}},{once:!0}),new Response(z,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!z)return new Response("");return new Response(JSON.stringify(z),{headers:{"content-type":"application/json"}});case"Response":if(!z.headers.has("content-length")&&z.headers.get("transfer-encoding")==="chunked")return z1(u6(z),n6(z),U);return z;case"Promise":return z.then((W)=>{let X=K2(W,w);if(X!==void 0)return X});case"Error":return C6(z,w);case"Function":return R6(z(),U);case"Number":case"Boolean":return new Response(z.toString());case"Cookie":if(z instanceof R4)return new Response(z.value,w);return new Response(z?.toString(),w);case"FormData":return new Response(z);default:if(z instanceof Response)return z;if(z instanceof Promise)return z.then((W)=>K2(W,w));if(z instanceof Error)return C6(z,w);if(z instanceof K1)return w.status=z.code,K2(z.response,w,U);if(typeof z?.next==="function")return z1(z,w,U);if(typeof z?.then==="function")return z.then((W)=>K2(W,w));if(typeof z?.toResponse==="function")return K2(z.toResponse(),w);if("charCodeAt"in z){let W=z.charCodeAt(0);if(W===123||W===91){if(!w.headers["Content-Type"])w.headers["Content-Type"]="application/json";return new Response(JSON.stringify(z),w)}}return new Response(z)}},R6=(z,w)=>{switch(z?.constructor?.name){case"String":return new Response(z);case"Object":case"Array":return Response.json(z);case"ElysiaFile":return O6(z.value);case"Blob":return O6(z);case"ElysiaCustomStatusResponse":return E2(z.response,{status:z.code,headers:{}});case"ReadableStream":return w?.signal?.addEventListener("abort",{handleEvent(){if(w?.signal&&!w?.signal?.aborted)z.cancel()}},{once:!0}),new Response(z,{headers:{"Content-Type":"text/event-stream; charset=utf-8"}});case void 0:if(!z)return new Response("");return new Response(JSON.stringify(z),{headers:{"content-type":"application/json"}});case"Response":if(z.headers.get("transfer-encoding")==="chunked")return z1(u6(z),n6(z),w);return z;case"Error":return C6(z);case"Promise":return z.then((U)=>R6(U,w));case"Function":return R6(z(),w);case"Number":case"Boolean":return new Response(z.toString());case"FormData":return new Response(z);default:if(z instanceof Response)return z;if(z instanceof Promise)return z.then((U)=>R6(U,w));if(z instanceof Error)return C6(z);if(z instanceof K1)return E2(z.response,{status:z.code,headers:{}});if(typeof z?.next==="function")return z1(z,void 0,w);if(typeof z?.then==="function")return z.then((U)=>E2(U,set));if(typeof z?.toResponse==="function")return R6(z.toResponse());if("charCodeAt"in z){let U=z.charCodeAt(0);if(U===123||U===91)return new Response(JSON.stringify(z),{headers:{"Content-Type":"application/json"}})}return new Response(z)}},C6=(z,w)=>new Response(JSON.stringify({name:z?.name,message:z?.message,cause:z?.cause}),{status:w?.status!==200?w?.status??500:500,headers:w?.headers}),DG=(z,w,U={})=>{if(typeof z==="function")return;let W=E2(z,{headers:U});if(!w.parse?.length&&!w.transform?.length&&!w.beforeHandle?.length&&!w.afterHandle?.length)return W.clone.bind(W)},y5={name:"web-standard",isWebStandard:!0,handler:{mapResponse:E2,mapEarlyResponse:K2,mapCompactResponse:R6,createStaticHandler:DG},composeHandler:{mapResponseContext:"c.request",preferWebstandardHeaders:!0,headers:`c.headers = {}
for (const [key, value] of c.request.headers.entries())c.headers[key] = value
`,parser:{json(z){if(z)return`try{c.body=await c.request.json()}catch{}
`;return`c.body=await c.request.json()
`},text(){return`c.body=await c.request.text()
`},urlencoded(){return`c.body=parseQuery(await c.request.text())
`},arrayBuffer(){return`c.body=await c.request.arrayBuffer()
`},formData(z){let w=`
c.body={}
`;if(z)w+="let form;try{form=await c.request.formData()}catch{}";else w+=`const form=await c.request.formData()
`;return w+`for(const key of form.keys()){if(c.body[key]) continue
const value=form.getAll(key)
if(value.length===1)c.body[key]=value[0]
else c.body[key]=value}`}}},composeGeneralHandler:{parameters:"r",createContext(z){let w="",U="",W=z.setHeaders;for(let Z of Object.keys(z.singleton.decorator))w+=`,${Z}: decorator['${Z}']`;let X=z.config.handler?.standardHostname??!0,A=!!z.event.trace?.length;if(U+=`const u=r.url,s=u.indexOf('/',${X?11:7}),qi=u.indexOf('?', s + 1)
let p
if(qi===-1)p=u.substring(s)
else p=u.substring(s, qi)
`,A)U+=`const id=randomId()
`;if(U+="const c={request:r,store,qi,path:p,url:u,redirect,error,set:{headers:",U+=Object.keys(W??{}).length?"Object.assign({}, app.setHeaders)":"{}",U+=",status:200}",z.inference.server)U+=",get server(){return app.getServer()}";if(A)U+=",[ELYSIA_REQUEST_ID]:id";return U+=w,U+=`}
`,U},websocket(z){let w="",U=z.router.static.ws,W=z.router.http;if(W.build(),Object.keys(U).length||W.root.ws||W.history.find((X)=>X["0"]==="ws")){w+="if(r.method==='GET'){switch(p){";for(let[X,A]of Object.entries(U))w+=`case'${X}':`+(z.config.strictPath!==!0?`case'${D4(X)}':`:"")+`if(r.headers.get('upgrade')==='websocket')return ht[${A}].composed(c)
`;w+=`default:if(r.headers.get('upgrade')==='websocket'){const route=router.find('ws',p)
if(route){c.params=route.params
if(route.store.handler)return route.store.handler(c)
return (route.store.handler=route.store.compile())(c)}}break}}`}return w},error404(z,w){let U="if(route===null)return ";if(w)U+=`app.handleError(c,notFound,false,${this.parameters})`;else U+=z?"new Response(error404Message,{status:c.set.status===200?404:c.set.status,headers:c.set.headers})":"error404.clone()";return{declare:w?"":`const error404Message=notFound.message.toString()
const error404=new Response(error404Message,{status:404})
`,code:U}}},composeError:{mapResponseContext:"",validationError:"return new Response(error.message,{headers:Object.assign({'content-type':'application/json'},set.headers),status:set.status})",unknownError:"return new Response(error.message,{headers:set.headers,status:error.status??set.status??500})"},listen(){return()=>{throw new Error("WebStandard does not support listen, you might want to export default Elysia.fetch instead")}}},PG=(z,w,U={})=>{if(typeof z==="function"||z instanceof Blob)return;if(typeof z==="object"&&z?.toString()==="[object HTMLBundle]")return()=>z;let W=E2(z,{headers:U});if(!w.parse?.length&&!w.transform?.length&&!w.beforeHandle?.length&&!w.afterHandle?.length){if(!W.headers.has("content-type"))W.headers.append("content-type","text/plain;charset=utf-8");return W.clone.bind(W)}},VW={open(z){z.data.open?.(z)},message(z,w){z.data.message?.(z,w)},drain(z){z.data.drain?.(z)},close(z,w,U){z.data.close?.(z,w,U)}};class e4{raw;data;body;validator;["~types"];get id(){return this.data.id}constructor(z,w,U=void 0){this.raw=z,this.data=w,this.body=U,this.validator=z.data?.validator,this.sendText=z.sendText.bind(z),this.sendBinary=z.sendBinary.bind(z),this.close=z.close.bind(z),this.terminate=z.terminate.bind(z),this.publishText=z.publishText.bind(z),this.publishBinary=z.publishBinary.bind(z),this.subscribe=z.subscribe.bind(z),this.unsubscribe=z.unsubscribe.bind(z),this.isSubscribed=z.isSubscribed.bind(z),this.cork=z.cork.bind(z),this.remoteAddress=z.remoteAddress,this.binaryType=z.binaryType,this.data=z.data,this.send=this.send.bind(this),this.ping=this.ping.bind(this),this.pong=this.pong.bind(this),this.publish=this.publish.bind(this)}send(z,w){if(Buffer.isBuffer(z))return this.raw.send(z,w);if(this.validator?.Check(z)===!1)return this.raw.send(new r("message",this.validator,z).message);if(typeof z==="object")z=JSON.stringify(z);return this.raw.send(z,w)}ping(z){if(Buffer.isBuffer(z))return this.raw.ping(z);if(this.validator?.Check(z)===!1)return this.raw.send(new r("message",this.validator,z).message);if(typeof z==="object")z=JSON.stringify(z);return this.raw.ping(z)}pong(z){if(Buffer.isBuffer(z))return this.raw.pong(z);if(this.validator?.Check(z)===!1)return this.raw.send(new r("message",this.validator,z).message);if(typeof z==="object")z=JSON.stringify(z);return this.raw.pong(z)}publish(z,w,U){if(Buffer.isBuffer(w))return this.raw.publish(z,w,U);if(this.validator?.Check(w)===!1)return this.raw.send(new r("message",this.validator,w).message);if(typeof w==="object")w=JSON.stringify(w);return this.raw.publish(z,w,U)}sendText;sendBinary;close;terminate;publishText;publishBinary;subscribe;unsubscribe;isSubscribed;cork;remoteAddress;binaryType;get readyState(){return this.raw.readyState}}var OG=(z)=>{let w=typeof z==="function"?[z]:z;return async function U(W,X){if(typeof X==="string"){let A=X?.charCodeAt(0);if(A===34||A===47||A===91||A===123)try{X=JSON.parse(X)}catch{}else if(Yw(X))X=+X;else if(X==="true")X=!0;else if(X==="false")X=!1;else if(X==="null")X=null}if(w)for(let A=0;A<w.length;A++){let Z=w[A](W,X);if(Z instanceof Promise)Z=await Z;if(Z!==void 0)return Z}return X}},RG=(z)=>{let w=(U,W)=>{if(W instanceof Promise)return W.then((Z)=>w(U,Z));if(Buffer.isBuffer(W))return U.send(W.toString());if(W===void 0)return;let X=(Z)=>{if(z?.Check(Z)===!1)return U.send(new r("message",z,Z).message);if(typeof Z==="object")return U.send(JSON.stringify(Z));U.send(Z)};if(typeof W?.next!=="function")return void X(W);let A=W.next();if(A instanceof Promise)return(async()=>{let Z=await A;if(z?.Check(Z)===!1)return U.send(new r("message",z,Z).message);if(X(Z.value),!Z.done)for await(let $ of W)X($)})();if(X(A.value),!A.done)for(let Z of W)X(Z)};return w},CG={...y5,name:"bun",handler:{...y5.handler,createNativeStaticHandler:PG},composeHandler:{...y5.composeHandler,headers:n5?`c.headers = c.request.headers.toJSON()
`:`c.headers = {}
for (const [key, value] of c.request.headers.entries())c.headers[key] = value
`},listen(z){return(w,U)=>{if(typeof Bun==="undefined")throw new Error(".listen() is designed to run on Bun only. If you are running Elysia in other environment please use a dedicated plugin or export the handler via Elysia.fetch");if(z.compile(),typeof w==="string"){if(!Yw(w))throw new Error("Port must be a numeric value");w=parseInt(w)}let W=z.fetch,X=typeof w==="object"?{development:!t5,reusePort:!0,...z.config.serve||{},...w||{},static:{...z.router.static.http.static,...z.config.serve?.static},websocket:{...z.config.websocket||{},...VW||{}},fetch:W,error:z.outerErrorHandler}:{development:!t5,reusePort:!0,...z.config.serve||{},static:z.router.static.http.static,websocket:{...z.config.websocket||{},...VW||{}},port:w,fetch:W,error:z.outerErrorHandler};if(z.server=Bun?.serve(X),z.event.start)for(let A=0;A<z.event.start.length;A++)z.event.start[A].fn(z);if(U)U(z.server);process.on("beforeExit",()=>{if(z.server){if(z.server.stop?.(),z.server=null,z.event.stop)for(let A=0;A<z.event.stop.length;A++)z.event.stop[A].fn(z)}}),z.promisedModules.then(()=>{Bun?.gc(!1)})}},ws(z,w,U){let{parse:W,body:X,response:A,...Z}=U,$=j2(X,{modules:z.definitions.typebox,models:z.definitions.type,normalize:z.config.normalize}),Y=j2(A,{modules:z.definitions.typebox,models:z.definitions.type,normalize:z.config.normalize});z.route("$INTERNALWS",w,async(Q)=>{let J=z.getServer(),{set:N,path:S,qi:G,headers:O,query:M,params:C}=Q;if(Q.validator=Y,U.upgrade){if(typeof U.upgrade==="function"){let f=U.upgrade(Q);if(f instanceof Promise)await f}else if(U.upgrade)Object.assign(N.headers,U.upgrade)}if(N.cookie&&w1(N.cookie)){let f=zX(N.cookie);if(f)N.headers["set-cookie"]=f}if(N.headers["set-cookie"]&&Array.isArray(N.headers["set-cookie"]))N.headers=wX(new Headers(N.headers),N.headers["set-cookie"]);let k=RG(Y),q0=OG(W),w0,_0=[...Array.isArray(U.error)?U.error:[U.error],...(z.event.error??[]).map((f)=>typeof f==="function"?f:f.fn)],C0=!_0.length?()=>{}:async(f,E)=>{for(let T of _0){let F=T(Object.assign(Q,{error:E}));if(F instanceof Promise)F=await F;if(await k(f,F),F)break}};if(J?.upgrade(Q.request,{headers:w1(N.headers)?N.headers:void 0,data:{...Q,get id(){if(w0)return w0;return w0=iW()},validator:Y,ping(f){U.ping?.(f)},pong(f){U.pong?.(f)},open(f){try{k(f,U.open?.(new e4(f,Q)))}catch(E){C0(f,E)}},message:async(f,E)=>{let T=await q0(f,E);if($?.Check(T)===!1)return void f.send(new r("message",$,T).message);try{k(f,U.message?.(new e4(f,Q,T),T))}catch(F){C0(f,F)}},drain(f){try{k(f,U.drain?.(new e4(f,Q)))}catch(E){C0(f,E)}},close(f,E,T){try{k(f,U.close?.(new e4(f,Q),E,T))}catch(F){C0(f,F)}}}}))return;return N.status=400,"Expected a websocket connection"},{...Z,websocket:U})}},bG=typeof Bun!=="undefined",kW=bG?Bun.env:typeof process!=="undefined"&&process?.env?process.env:{},P4=/\+/g;function KG(z){let w={};if(typeof z!=="string")return w;let U="",W="",X=-1,A=-1,Z=0,$=z.length;for(let Y=0;Y<$;Y++)switch(z.charCodeAt(Y)){case 38:let Q=A>X;if(!Q)A=Y;if(U=z.slice(X+1,A),Q||U.length>0){if(Z&1)U=U.replace(P4," ");if(Z&2)U=P6(U)||U;if(!w[U]){if(Q){if(W=z.slice(A+1,Y),Z&4)W=W.replace(P4," ");if(Z&8)W=P6(W)||W}w[U]=W}}U="",W="",X=Y,A=Y,Z=0;break;case 61:if(A<=X)A=Y;else Z|=8;break;case 43:if(A>X)Z|=4;else Z|=1;break;case 37:if(A>X)Z|=8;else Z|=2;break}if(X<$){let Y=A>X;if(U=z.slice(X+1,Y?A:$),Y||U.length>0){if(Z&1)U=U.replace(P4," ");if(Z&2)U=P6(U)||U;if(!w[U]){if(Y){if(W=z.slice(A+1,$),Z&4)W=W.replace(P4," ");if(Z&8)W=P6(W)||W}w[U]=W}}}return w}var v5=(z)=>{let w={};if(typeof z!=="string")return w;let U=z.length,W="",X="",A=-1,Z=-1,$=!1,Y=!1,Q=!1,J=!1,N=!1,S=0;for(let G=0;G<U+1;G++){if(G!==U)S=z.charCodeAt(G);else S=38;switch(S){case 38:{if(N=Z>A,!N)Z=G;if(W=z.slice(A+1,Z),N||W.length>0){if(Q)W=W.replace(P4," ");if($)W=P6(W)||W;if(N){if(X=z.slice(Z+1,G),J)X=X.replace(P4," ");if(Y)X=P6(X)||X}let O=w[W];if(O===void 0)w[W]=X;else if(O.pop)O.push(X);else w[W]=[O,X]}X="",A=G,Z=G,$=!1,Y=!1,Q=!1,J=!1;break}case 61:if(Z<=A)Z=G;else Y=!0;break;case 43:if(Z>A)J=!0;else Q=!0;break;case 37:if(Z>A)Y=!0;else $=!0;break}}return w},Jw=Symbol("ElysiaTrace"),w6=()=>{let{promise:z,resolve:w}=Promise.withResolvers(),{promise:U,resolve:W}=Promise.withResolvers(),{promise:X,resolve:A}=Promise.withResolvers(),Z=[],$=[];return[(Y)=>{if(Y)Z.push(Y);return z},(Y)=>{let Q=[],J=[],N=null;for(let G=0;G<(Y.total??0);G++){let{promise:O,resolve:M}=Promise.withResolvers(),{promise:C,resolve:k}=Promise.withResolvers(),{promise:q0,resolve:w0}=Promise.withResolvers(),_0=[],C0=[];Q.push((f)=>{if(f)_0.push(f);return O}),J.push((f)=>{let E={...f,end:C,error:q0,index:G,onStop(T){if(T)C0.push(T);return C}};M(E);for(let T=0;T<_0.length;T++)_0[T](E);return(T=null)=>{let F=performance.now();if(T)N=T;let a={end:F,error:T,get elapsed(){return F-f.begin}};for(let Z0=0;Z0<C0.length;Z0++)C0[Z0](a);k(F),w0(T)}})}let S={...Y,end:U,error:X,onEvent(G){for(let O=0;O<Q.length;O++)Q[O](G)},onStop(G){if(G)$.push(G);return U}};w(S);for(let G=0;G<Z.length;G++)Z[G](S);return{resolveChild:J,resolve(G=null){let O=performance.now();if(!G&&N)G=N;let M={end:O,error:G,get elapsed(){return O-Y.begin}};for(let C=0;C<$.length;C++)$[C](M);W(O),A(G)}}}]},FG=(z)=>{return(w)=>{let[U,W]=w6(),[X,A]=w6(),[Z,$]=w6(),[Y,Q]=w6(),[J,N]=w6(),[S,G]=w6(),[O,M]=w6(),[C,k]=w6(),[q0,w0]=w6();return z({id:w[l5],context:w,set:w.set,onRequest:U,onParse:X,onTransform:Z,onBeforeHandle:Y,onHandle:J,onAfterHandle:S,onMapResponse:C,onAfterResponse:q0,onError:O}),{request:W,parse:A,transform:$,beforeHandle:Q,handle:N,afterHandle:G,error:M,mapResponse:k,afterResponse:w0}}},m6={optional:Symbol.for("TypeBox.Optional"),kind:Symbol.for("TypeBox.Kind")},C1=(z)=>{if(!z)return!1;let w=z?.schema;if(w?.[m6.kind]==="Import")return z.References().some(C1);return!!w&&m6.optional in w},Y2=(z,w)=>w?z:"",jG=["json","text","urlencoded","arrayBuffer","formdata","application/json","text/plain","application/x-www-form-urlencoded","application/octet-stream","multipart/form-data"],e2=(z)=>{if(!z)return!1;let w=z?.schema??z;if(w[m6.kind]==="Import"&&z.References())return z.References().some(e2);if(w.anyOf)return w.anyOf.some(e2);if(w.someOf)return w.someOf.some(e2);if(w.allOf)return w.allOf.some(e2);if(w.not)return w.not.some(e2);if(w.type==="object"){let U=w.properties;if("additionalProperties"in w)return w.additionalProperties;if("patternProperties"in w)return!1;for(let W of Object.keys(U)){let X=U[W];if(X.type==="object"){if(e2(X))return!0}else if(X.anyOf){for(let A=0;A<X.anyOf.length;A++)if(e2(X.anyOf[A]))return!0}return X.additionalProperties}return!1}return!1},Bw=({context:z="c",trace:w=[],addFn:U})=>{if(!w.length)return()=>{return{resolveChild(){return()=>{}},resolve(){}}};for(let W=0;W<w.length;W++)U(`let report${W}, reportChild${W}, reportErr${W}, reportErrChild${W};let trace${W} = ${z}[ELYSIA_TRACE]?.[${W}] ?? trace[${W}](${z});
`);return(W,{name:X,total:A=0}={})=>{if(!X)X="anonymous";let Z=W==="error"?"reportErr":"report";for(let $=0;$<w.length;$++)U(`${Z}${$} = trace${$}.${W}({id,event:'${W}',name:'${X}',begin:performance.now(),total:${A}})
`);return{resolve(){for(let $=0;$<w.length;$++)U(`${Z}${$}.resolve()
`)},resolveChild($){for(let Y=0;Y<w.length;Y++)U(`${Z}Child${Y}=${Z}${Y}.resolveChild?.shift()?.({id,event:'${W}',name:'${$}',begin:performance.now()})
`);return(Y)=>{for(let Q=0;Q<w.length;Q++)if(Y)U(`if(${Y} instanceof Error){${Z}Child${Q}?.(${Y}) }else{${Z}Child${Q}?.()}`);else U(`${Z}Child${Q}?.()
`)}}}}},EG=({injectResponse:z="",normalize:w=!1,validator:U,encodeSchema:W=!1})=>({composeValidation:(X,A=`c.${X}`)=>`c.set.status=422;throw new ValidationError('${X}',validator.${X},${A})`,composeResponseValidation:(X="r")=>{let A=z+`
`;A+=`if(${X} instanceof ElysiaCustomStatusResponse){c.set.status=${X}.code
${X}=${X}.response}const isResponse=${X} instanceof Response
switch(c.set.status){`;for(let[Z,$]of Object.entries(U.response)){if(A+=`
case ${Z}:if(!isResponse){`,w&&"Clean"in $&&!e2($))A+=`${X}=validator.response['${Z}'].Clean(${X})
`;if(W&&($.hasTransform||typeof $.Decode==="function"))A+=`${X}=validator.response['${Z}'].Encode(${X})
`;A+=`if(validator.response['${Z}'].Check(${X})===false){c.set.status=422
throw new ValidationError('response',validator.response['${Z}'],${X})}c.set.status = ${Z}}
`,A+=`break
`}return A+"}"}}),Zf=Symbol.for("TypeBox.Kind"),D6=(z,w)=>{if(!w)return;let U=w.schema??w;if(U[m6.kind]==="Import")return w.References().some((W)=>D6(z,W));if(U.type==="object"){let W=U.properties;if(!W)return!1;for(let X of Object.keys(W)){let A=W[X];if(z in A)return!0;if(A.type==="object"){if(D6(z,A))return!0}else if(A.anyOf){for(let Z=0;Z<A.anyOf.length;Z++)if(D6(z,A.anyOf[Z]))return!0}}return!1}return z in U},IG=Symbol.for("TypeBox.Transform"),y2=(z)=>{if(!z)return!1;if(z.$ref&&z.$defs&&z.$ref in z.$defs&&y2(z.$defs[z.$ref]))return!0;if(z.oneOf){for(let w=0;w<z.oneOf.length;w++)if(y2(z.oneOf[w]))return!0}if(z.anyOf){for(let w=0;w<z.anyOf.length;w++)if(y2(z.anyOf[w]))return!0}if(z.allOf){for(let w=0;w<z.allOf.length;w++)if(y2(z.allOf[w]))return!0}if(z.not&&y2(z.not))return!0;if(z.type==="object"&&z.properties){let w=z.properties;for(let U of Object.keys(w)){let W=w[U];if(y2(W))return!0;if(W.type==="array"&&W.items&&y2(W.items))return!0}}if(z.type==="array"&&z.items&&y2(z.items))return!0;return IG in z},xG=/(?:return|=>) \S+\(/g,O4=(z)=>{return(z?.fn??z).constructor.name==="AsyncFunction"},e0=(z)=>{let w=z?.fn??z;if(w.constructor.name==="AsyncFunction")return!0;let U=w.toString();if(U.includes("=> response.clone("))return!1;if(U.includes("await"))return!0;if(U.includes("async"))return!0;if(U.includes("=>response.clone("))return!1;return!!U.match(xG)},i5=(z)=>{let w=z?.fn??z;return w.constructor.name==="AsyncGeneratorFunction"||w.constructor.name==="GeneratorFunction"},VG=({app:z,path:w,method:U,hooks:W,validator:X,handler:A,allowMeta:Z=!1,inference:$,asManifest:Y=!1})=>{let Q=z["~adapter"].composeHandler,J=z["~adapter"].handler,N=typeof A==="function";if(!N){if(A=J.mapResponse(A,{headers:z.setHeaders??{}}),W.parse?.length&&W.transform?.length&&W.beforeHandle?.length&&W.afterHandle?.length){if(A instanceof Response)return Function("a","return function(){return a.clone()}")(A);return Function("a","return function(){return a}")(A)}}let S=N?"handler(c)":"handler",G=!!W.afterResponse?.length,O=!!W.trace?.length,M="";if($=rW(Object.assign({},W,{handler:A}),$),Q.declare){let j=Q.declare($);if(j)M+=j}if($.server)M+=`Object.defineProperty(c,'server',{get:function(){return getServer()}})
`;X.createBody?.(),X.createQuery?.(),X.createHeaders?.(),X.createParams?.(),X.createCookie?.(),X.createResponse?.();let C=X.body||X.headers||X.params||X.query||X.cookie||X.response,k=$.query||!!X.query,q0=W.parse?.length===1&&W.parse[0].fn==="none",w0=U!=="$INTERNALWS"&&U!=="GET"&&U!=="HEAD"&&($.body||!!X.body||!!W.parse?.length)&&!q0;if(w0)M+=`let isParsing=false
`;let _0=z.setHeaders,C0=_0&&!!Object.keys(_0).length,f=$.headers||X.headers||Q.preferWebstandardHeaders!==!0&&$.body,E=$.cookie||!!X.cookie,T=E?dW({modules:z.definitions.typebox,validator:X.cookie,defaultConfig:z.config.cookie,dynamic:!!z.config.aot,config:X.cookie?.config??{},models:z.definitions.type}):void 0,F=T?.config,a="";if(F?.sign){if(!F.secrets)throw new Error(`t.Cookie required secret which is not set in (${U}) ${w}.`);let j=!F.secrets?void 0:typeof F.secrets==="string"?F.secrets:F.secrets[0];if(a+=`const _setCookie = c.set.cookie
if(_setCookie){`,F.sign===!0)a+=`for(const [key, cookie] of Object.entries(_setCookie)){c.set.cookie[key].value=await signCookie(cookie.value,'${j}')}`;else for(let R of F.sign)a+=`if(_setCookie['${R}']?.value){c.set.cookie['${R}'].value=await signCookie(_setCookie['${R}'].value,'${j}')}`;a+=`}
`}let Z0=z.config.normalize,H0=z.config.experimental?.encodeSchema,{composeValidation:h0,composeResponseValidation:U6}=EG({normalize:Z0,validator:X,encodeSchema:H0});if(f)M+=Q.headers;if(O)M+=`const id=c[ELYSIA_REQUEST_ID]
`;let n0=Bw({trace:W.trace,addFn:(j)=>{M+=j}});if(M+="try{",E){let j=(b,c)=>{let t=F?.[b]??c;if(!t)return typeof c==="string"?`${b}:"${c}",`:`${b}:${c},`;if(typeof t==="string")return`${b}:'${t}',`;if(t instanceof Date)return`${b}: new Date(${t.getTime()}),`;return`${b}:${t},`},R=F?`{secrets:${F.secrets!==void 0?typeof F.secrets==="string"?`'${F.secrets}'`:"["+F.secrets.reduce((b,c)=>b+`'${c}',`,"")+"]":"undefined"},sign:${F.sign===!0?!0:F.sign!==void 0?"["+F.sign.reduce((b,c)=>b+`'${c}',`,"")+"]":"undefined"},`+j("domain")+j("expires")+j("httpOnly")+j("maxAge")+j("path","/")+j("priority")+j("sameSite")+j("secure")+"}":"undefined";if(f)M+=`
c.cookie=await parseCookie(c.set,c.headers.cookie,${R})
`;else M+=`
c.cookie=await parseCookie(c.set,c.request.headers.get('cookie'),${R})
`}if(k){let j=[];if(X.query&&X.query.schema.type==="object"){let R=X.query.schema.properties;if(!e2(X.query))for(let[b,c]of Object.entries(R)){let t=c,B=t.type==="array"||!!t.anyOf?.some((d)=>d.type==="string"&&d.format==="ArrayString");if(t&&m6.optional in t&&t.type==="array"&&t.items)t=t.items;let{type:K,anyOf:L}=t;j.push({key:b,isArray:B,isNestedObjectArray:B&&t.items?.type==="object"||!!t.items?.anyOf?.some((d)=>d.type==="object"||d.type==="array"),isObject:K==="object"||L?.some((d)=>d.type==="string"&&d.format==="ArrayString"),anyOf:!!L})}}if(!j.length)M+="if(c.qi===-1){c.query={}}else{c.query=parseQueryFromURL(c.url.slice(c.qi + 1))}";else{M+=`if(c.qi!==-1){let url='&'+c.url.slice(c.qi + 1)
`;let R=0;for(let{key:b,isArray:c,isObject:t,isNestedObjectArray:B,anyOf:K}of j){let L=(R===0?"let ":"")+`memory=url.indexOf('&${b}=')
let a${R}
`;if(c)if(M+=L,B)M+=`while(memory!==-1){const start=memory+${b.length+2}
memory=url.indexOf('&',start)
if(a${R}===undefined)
a${R}=''
else
a${R}+=','
let temp
if(memory===-1)temp=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))
else temp=decodeURIComponent(url.slice(start, memory).replace(/\\+/g,' '))
const charCode=temp.charCodeAt(0)
if(charCode!==91&&charCode !== 123)
temp='"'+temp+'"'
a${R}+=temp
if(memory===-1)break
memory=url.indexOf('&${b}=',memory)
if(memory===-1)break}try{if(a${R}.charCodeAt(0)===91)a${R} = JSON.parse(a${R})
else
a${R}=JSON.parse('['+a${R}+']')}catch{}
`;else M+=`while(memory!==-1){const start=memory+${b.length+2}
memory=url.indexOf('&',start)
if(a${R}===undefined)a${R}=[]
if(memory===-1){const temp=decodeURIComponent(url.slice(start)).replace(/\\+/g,' ')
if(temp.includes(',')){a${R}=a${R}.concat(temp.split(','))}else{a${R}.push(decodeURIComponent(url.slice(start)).replace(/\\+/g,' '))}
break}else{const temp=decodeURIComponent(url.slice(start, memory)).replace(/\\+/g,' ')
if(temp.includes(',')){a${R}=a${R}.concat(temp.split(','))}else{a${R}.push(temp)}
}memory=url.indexOf('&${b}=',memory)
if(memory===-1) break
}`;else if(t)M+=L+`if(memory!==-1){const start=memory+${b.length+2}
memory=url.indexOf('&',start)
if(memory===-1)a${R}=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))else a${R}=decodeURIComponent(url.slice(start,memory).replace(/\\+/g,' '))if(a${R}!==undefined)try{a${R}=JSON.parse(a${R})}catch{}}`;else{if(M+=L+`if(memory!==-1){const start=memory+${b.length+2}
memory=url.indexOf('&',start)
if(memory===-1)a${R}=decodeURIComponent(url.slice(start).replace(/\\+/g,' '))
else{a${R}=decodeURIComponent(url.slice(start,memory).replace(/\\+/g,' '))`,K)M+=`
let deepMemory=url.indexOf('&${b}=',memory)
if(deepMemory!==-1){a${R}=[a${R}]
let first=true
while(true){const start=deepMemory+${b.length+2}
if(first)first=false
else deepMemory = url.indexOf('&', start)
let value
if(deepMemory===-1)value=url.slice(start).replace(/\\+/g,' ')
else value=url.slice(start, deepMemory).replace(/\\+/g,' ')
value=decodeURIComponent(value)
if(value===null){if(deepMemory===-1){break}else{continue}}
const vStart=value.charCodeAt(0)
const vEnd=value.charCodeAt(value.length - 1)
if((vStart===91&&vEnd===93)||(vStart===123&&vEnd===125))
try{a${R}.push(JSON.parse(value))}catch{a${R}.push(value)}if(deepMemory===-1)break}}`;M+="}}"}R++,M+=`
`}M+="c.query={"+j.map(({key:b},c)=>`'${b}':a${c}`).join(",")+"}",M+=`} else c.query = {}
`}}let W6=typeof A==="function"&&e0(A),I2=O||W.afterResponse?.length?"c.response= ":"",b6=E||w0||W6||!!W.parse?.length||!!W.afterHandle?.some(e0)||!!W.beforeHandle?.some(e0)||!!W.transform?.some(e0)||!!W.mapResponse?.some(e0),a5=(typeof A==="function"?i5(A):!1)||!!W.beforeHandle?.some(i5)||!!W.afterHandle?.some(i5)||!!W.transform?.some(i5),W1=$.cookie||$.set||f||O||X.response||N&&C0||a5,S0=Q.mapResponseContext?`,${Q.mapResponseContext}`:"";if(O||$.route)M+=`c.route=\`${w}\`
`;let x2=n0("parse",{total:W.parse?.length});if(w0){let j=C1(X.body),R=!!W.parse?.length||$.body||X.body;if(Q.parser.declare)M+=Q.parser.declare;M+=`
isParsing=true
`;let b=typeof W.parse==="string"?W.parse:Array.isArray(W.parse)&&W.parse.length===1?typeof W.parse[0]==="string"?W.parse[0]:typeof W.parse[0].fn==="string"?W.parse[0].fn:void 0:void 0;if(b&&jG.includes(b)){let c=n0("parse",{total:W.parse?.length});switch(b){case"json":case"application/json":M+=Q.parser.json(j);break;case"text":case"text/plain":M+=Q.parser.text(j);break;case"urlencoded":case"application/x-www-form-urlencoded":M+=Q.parser.urlencoded(j);break;case"arrayBuffer":case"application/octet-stream":M+=Q.parser.arrayBuffer(j);break;case"formdata":case"multipart/form-data":M+=Q.parser.formData(j);break;default:if(b[0]in z["~parser"])M+=f?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",M+=`
if(contentType){const index=contentType.indexOf(';')
if(index!==-1)contentType=contentType.substring(0, index)}
else{contentType=''}c.contentType=contentType
`,M+=`let result=parser['${b}'](c, contentType)
if(result instanceof Promise)result=await result
if(result instanceof ElysiaCustomStatusResponse)throw result
if(result!==undefined)c.body=result
delete c.contentType
`;break}c.resolve()}else if(R){if(M+=`
`,M+=f?"let contentType = c.headers['content-type']":"let contentType = c.request.headers.get('content-type')",M+=`
if(contentType){const index=contentType.indexOf(';')
if(index!==-1)contentType=contentType.substring(0, index)}
else{contentType=''}c.contentType=contentType
`,W.parse?.length)M+=`let used=false
`;let c=n0("parse",{total:W.parse?.length}),t=!1;if(W.parse)for(let B=0;B<W.parse.length;B++){let K=`bo${B}`;if(B!==0)M+=`
if(!used){`;if(typeof W.parse[B].fn==="string"){let L=c.resolveChild(W.parse[B].fn);switch(W.parse[B].fn){case"json":case"application/json":t=!0,M+=Q.parser.json(j);break;case"text":case"text/plain":t=!0,M+=Q.parser.text(j);break;case"urlencoded":case"application/x-www-form-urlencoded":t=!0,M+=Q.parser.urlencoded(j);break;case"arrayBuffer":case"application/octet-stream":t=!0,M+=Q.parser.arrayBuffer(j);break;case"formdata":case"multipart/form-data":t=!0,M+=Q.parser.formData(j);break;default:M+=`${K}=parser['${W.parse[B].fn}'](c,contentType)
if(${K} instanceof Promise)${K}=await ${K}
if(${K}!==undefined){c.body=${K};used=true}
`}L()}else{let L=c.resolveChild(W.parse[B].fn.name);M+=`let ${K}=e.parse[${B}]
${K}=${K}(c,contentType)
if(${K} instanceof Promise)${K}=await ${K}
if(${K}!==undefined){c.body=${K};used=true}`,L()}if(B!==0)M+="}";if(t)break}if(c.resolve(),!t){if(W.parse?.length)M+=`
if(!used){
if(!contentType) throw new ParseError()
`;M+="switch(contentType){",M+=`case 'application/json':
`+Q.parser.json(j)+`break
case 'text/plain':`+Q.parser.text(j)+`break
case 'application/x-www-form-urlencoded':`+Q.parser.urlencoded(j)+`break
case 'application/octet-stream':`+Q.parser.arrayBuffer(j)+`break
case 'multipart/form-data':`+Q.parser.formData(j)+`break
`;for(let B of Object.keys(z["~parser"]))M+=`case '${B}':let bo${B}=parser['${B}'](c,contentType)
if(bo${B} instanceof Promise)bo${B}=await bo${B}
if(bo${B} instanceof ElysiaCustomStatusResponse)throw result
if(bo${B}!==undefined)c.body=bo${B}
break
`;if(W.parse?.length)M+="}";M+="}"}}M+=`
delete c.contentType`,M+=`
isParsing=false
`}if(x2.resolve(),W?.transform){let j=n0("transform",{total:W.transform.length});if(W.transform.length)M+=`let transformed
`;for(let R=0;R<W.transform.length;R++){let b=W.transform[R],c=j.resolveChild(b.fn.name);if(M+=e0(b)?`transformed=await e.transform[${R}](c)
`:`transformed=e.transform[${R}](c)
`,b.subType==="mapDerive")M+=`if(transformed instanceof ElysiaCustomStatusResponse)throw transformed
else{transformed.request=c.request
transformed.store=c.store
transformed.qi=c.qi
transformed.path=c.path
transformed.url=c.url
transformed.redirect=c.redirect
transformed.set=c.set
transformed.error=c.error
c=transformed}`;else M+=`if(transformed instanceof ElysiaCustomStatusResponse)throw transformed
else Object.assign(c,transformed)
`;c()}j.resolve()}if(X){if(X.headers){if(Z0&&"Clean"in X.headers&&!e2(X.headers))M+=`c.headers=validator.headers.Clean(c.headers);
`;if(D6("default",X.headers))for(let[j,R]of Object.entries(o.Default(X.headers.schema,{}))){let b=typeof R==="object"?JSON.stringify(R):typeof R==="string"?`'${R}'`:R;if(b!==void 0)M+=`c.headers['${j}']??=${b}
`}if(C1(X.headers))M+="if(isNotEmpty(c.headers)){";if(M+="if(validator.headers.Check(c.headers) === false){"+h0("headers")+"}",y2(X.headers.schema))M+=`c.headers=validator.headers.Decode(c.headers)
`;if(C1(X.headers))M+="}"}if(X.params){if(D6("default",X.params))for(let[j,R]of Object.entries(o.Default(X.params.schema,{}))){let b=typeof R==="object"?JSON.stringify(R):typeof R==="string"?`'${R}'`:R;if(b!==void 0)M+=`c.params['${j}']??=${b}
`}if(M+="if(validator.params.Check(c.params)===false){"+h0("params")+"}",y2(X.params.schema))M+=`c.params=validator.params.Decode(c.params)
`}if(X.query){if(Z0&&"Clean"in X.query&&!e2(X.query))M+=`c.query=validator.query.Clean(c.query)
`;if(D6("default",X.query))for(let[j,R]of Object.entries(o.Default(X.query.schema,{}))){let b=typeof R==="object"?JSON.stringify(R):typeof R==="string"?`'${R}'`:R;if(b!==void 0)M+=`if(c.query['${j}']===undefined)c.query['${j}']=${b}
`}if(C1(X.query))M+="if(isNotEmpty(c.query)){";if(M+="if(validator.query.Check(c.query)===false){"+h0("query")+"}",y2(X.query.schema))M+=`c.query=validator.query.Decode(Object.assign({},c.query))
`;if(C1(X.query))M+="}"}if(X.body){if(Z0&&"Clean"in X.body&&!e2(X.body))M+=`c.body=validator.body.Clean(c.body)
`;let j=y2(X.body.schema);if(j||C1(X.body))M+=`const isNotEmptyObject=c.body&&(typeof c.body==="object"&&isNotEmpty(c.body))
`;if(D6("default",X.body)){let R=X.body.schema,b=o.Default(R,R.type==="object"||R[m6.kind]==="Import"&&R.$defs[R.$ref][m6.kind]==="Object"?{}:void 0),c=typeof b==="object"?JSON.stringify(b):typeof b==="string"?`'${b}'`:b;if(M+="if(validator.body.Check(c.body)===false){",b!==void 0&&b!==null)M+=`if(typeof c.body==='object')c.body=Object.assign(${c},c.body)
else c.body=${c}
`;if(C1(X.body))M+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+h0("body")+"}";else M+="if(validator.body.Check(c.body)===false){"+h0("body")+"}";M+="}"}else if(C1(X.body))M+="if(isNotEmptyObject&&validator.body.Check(c.body)===false){"+h0("body")+"}";else M+="if(validator.body.Check(c.body)===false){"+h0("body")+"}";if(j)M+=`if(isNotEmptyObject)c.body=validator.body.Decode(c.body)
`}if(T&&w1(T?.schema?.properties??T?.schema?.schema??{})){if(M+=`const cookieValue={}
for(const [key,value] of Object.entries(c.cookie))cookieValue[key]=value.value
`,D6("default",T))for(let[j,R]of Object.entries(o.Default(T.schema,{})))M+=`cookieValue['${j}'] = ${typeof R==="object"?JSON.stringify(R):R}
`;if(C1(X.cookie))M+="if(isNotEmpty(c.cookie)){";if(M+="if(validator.cookie.Check(cookieValue)===false){"+h0("cookie","cookieValue")+"}",y2(X.cookie.schema))M+=`for(const [key,value] of Object.entries(validator.cookie.Decode(cookieValue)))c.cookie[key].value=value
`;if(C1(X.cookie))M+="}"}}if(W?.beforeHandle){let j=n0("beforeHandle",{total:W.beforeHandle.length}),R=!1;for(let b=0;b<W.beforeHandle.length;b++){let c=W.beforeHandle[b],t=j.resolveChild(c.fn.name),B=w8(c);if(c.subType==="resolve"||c.subType==="mapResolve"){if(!R)R=!0,M+=`
let resolved
`;if(M+=e0(c)?`resolved=await e.beforeHandle[${b}](c);
`:`resolved=e.beforeHandle[${b}](c);
`,c.subType==="mapResolve")M+=`if(resolved instanceof ElysiaCustomStatusResponse)throw resolved
else{resolved.request = c.request
resolved.store = c.store
resolved.qi = c.qi
resolved.path = c.path
resolved.url = c.url
resolved.redirect = c.redirect
resolved.set = c.set
resolved.error = c.error
c = resolved}`;else M+=`if(resolved instanceof ElysiaCustomStatusResponse)throw resolved
else Object.assign(c, resolved)
`}else if(!B)M+=e0(c)?`await e.beforeHandle[${b}](c)
`:`e.beforeHandle[${b}](c)
`,t();else{if(M+=e0(c)?`be=await e.beforeHandle[${b}](c)
`:`be=e.beforeHandle[${b}](c)
`,t("be"),M+="if(be!==undefined){",j.resolve(),W.afterHandle?.length){n0("handle",{name:N?A.name:void 0}).resolve();let L=n0("afterHandle",{total:W.afterHandle.length});for(let d=0;d<W.afterHandle.length;d++){let x=W.afterHandle[d],h=w8(x),b0=L.resolveChild(x.fn.name);if(M+=`c.response = be
`,!h)M+=e0(x.fn)?`await e.afterHandle[${d}](c, be)
`:`e.afterHandle[${d}](c, be)
`;else M+=e0(x.fn)?`af = await e.afterHandle[${d}](c)
`:`af = e.afterHandle[${d}](c)
`,M+=`if(af!==undefined) c.response=be=af
`;b0("af")}L.resolve()}if(X.response)M+=U6("be");let K=n0("mapResponse",{total:W.mapResponse?.length});if(W.mapResponse?.length){M+=`c.response=be
`;for(let L=0;L<W.mapResponse.length;L++){let d=W.mapResponse[L],x=K.resolveChild(d.fn.name);M+=`if(mr===undefined){mr=${O4(d)?"await ":""}e.mapResponse[${L}](c)
if(mr!==undefined)be=c.response=mr}`,x()}}K.resolve(),M+=a,M+=`return mapEarlyResponse(${I2}be,c.set${S0})}
`}}j.resolve()}if(W.afterHandle?.length){let j=n0("handle",{name:N?A.name:void 0});if(W.afterHandle.length)M+=W6?`let r=c.response=await ${S}
`:`let r=c.response=${S}
`;else M+=W6?`let r=await ${S}
`:`let r=${S}
`;j.resolve();let R=n0("afterHandle",{total:W.afterHandle.length});for(let c=0;c<W.afterHandle.length;c++){let t=W.afterHandle[c],B=w8(t),K=R.resolveChild(t.fn.name);if(!B)M+=e0(t.fn)?`await e.afterHandle[${c}](c)
`:`e.afterHandle[${c}](c)
`,K();else if(M+=e0(t.fn)?`af=await e.afterHandle[${c}](c)
`:`af=e.afterHandle[${c}](c)
`,K("af"),X.response)M+="if(af!==undefined){",R.resolve(),M+=U6("af"),M+="c.response=af}";else M+="if(af!==undefined){",R.resolve(),M+="c.response=af}"}if(R.resolve(),M+=`r=c.response
`,X.response)M+=U6();M+=a;let b=n0("mapResponse",{total:W.mapResponse?.length});if(W.mapResponse?.length)for(let c=0;c<W.mapResponse.length;c++){let t=W.mapResponse[c],B=b.resolveChild(t.fn.name);M+=`mr=${O4(t)?"await ":""}e.mapResponse[${c}](c)
if(mr!==undefined)r=c.response=mr
`,B()}if(b.resolve(),W1)M+=`return mapResponse(${I2}r,c.set${S0})
`;else M+=`return mapCompactResponse(${I2}r${S0})
`}else{let j=n0("handle",{name:N?A.name:void 0});if(X.response||W.mapResponse?.length){if(M+=W6?`let r=await ${S}
`:`let r=${S}
`,j.resolve(),X.response)M+=U6();n0("afterHandle").resolve();let R=n0("mapResponse",{total:W.mapResponse?.length});if(W.mapResponse?.length){M+=`
c.response=r
`;for(let b=0;b<W.mapResponse.length;b++){let c=W.mapResponse[b],t=R.resolveChild(c.fn.name);M+=`
if(mr===undefined){mr=${O4(c)?"await ":""}e.mapResponse[${b}](c)
if(mr!==undefined)r=c.response=mr}
`,t()}}if(R.resolve(),M+=a,A instanceof Response)M+=$.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${I2}${S}.clone(),c.set${S0})else return ${S}.clone()`:`return ${S}.clone()`,M+=`
`;else if(W1)M+=`return mapResponse(${I2}r,c.set${S0})
`;else M+=`return mapCompactResponse(${I2}r${S0})
`}else if(E||O){M+=W6?`let r=await ${S}
`:`let r=${S}
`,j.resolve(),n0("afterHandle").resolve();let R=n0("mapResponse",{total:W.mapResponse?.length});if(W.mapResponse?.length){M+=`c.response= r
`;for(let b=0;b<W.mapResponse.length;b++){let c=W.mapResponse[b],t=R.resolveChild(c.fn.name);M+=`if(mr===undefined){mr=${O4(c)?"await ":""}e.mapResponse[${b}](c)
if(mr!==undefined)r=c.response=mr}`,t()}}if(R.resolve(),M+=a,W1)M+=`return mapResponse(${I2}r,c.set${S0})
`;else M+=`return mapCompactResponse(${I2}r${S0})
`}else{j.resolve();let R=W6?`await ${S}`:S;if(n0("afterHandle").resolve(),A instanceof Response)M+=$.set?`if(isNotEmpty(c.set.headers)||c.set.status!==200||c.set.redirect||c.set.cookie)return mapResponse(${I2}${S}.clone(),c.set${S0})
else return ${S}.clone()
`:`return ${S}.clone()
`;else if(W1)M+=`return mapResponse(${I2}${R},c.set${S0})
`;else M+=`return mapCompactResponse(${I2}${R}${S0})
`}}if(M+=`
}catch(error){`,w0)M+=`if(isParsing)error=new ParseError()
`;if(!b6)M+="return(async()=>{";if(M+=`const set=c.set
if(!set.status||set.status<300)set.status=error?.status||500
`,O&&W.trace)for(let j=0;j<W.trace.length;j++)M+=`report${j}?.resolve(error);reportChild${j}?.(error)
`;let X6=n0("error",{total:W.error?.length});if(W.error?.length){if(M+=`c.error=error
`,C)M+=`if(error instanceof TypeBoxError){c.code="VALIDATION"
c.set.status=422}else{c.code=error.code??error[ERROR_CODE]??"UNKNOWN"}`;else M+=`c.code=error.code??error[ERROR_CODE]??"UNKNOWN"
`;M+=`let er
`;for(let j=0;j<W.error.length;j++){let R=X6.resolveChild(W.error[j].fn.name);if(e0(W.error[j]))M+=`er=await e.error[${j}](c)
`;else M+=`er=e.error[${j}](c)
if(er instanceof Promise)er=await er
`;R();let b=n0("mapResponse",{total:W.mapResponse?.length});if(W.mapResponse?.length)for(let c=0;c<W.mapResponse.length;c++){let t=W.mapResponse[c],B=b.resolveChild(t.fn.name);M+=`c.response=er
er=e.mapResponse[${c}](c)
if(er instanceof Promise)er=await er
`,B()}if(b.resolve(),M+=`er=mapEarlyResponse(er,set${S0})
`,M+="if(er){",O&&W.trace){for(let c=0;c<W.trace.length;c++)M+=`report${c}.resolve()
`;X6.resolve()}M+="return er}"}}if(X6.resolve(),M+="return handleError(c,error,true)",!b6)M+="})()";if(M+="}",G||O){if(M+="finally{ ",!b6)M+=";(async()=>{";let j=n0("afterResponse",{total:W.afterResponse?.length});if(G&&W.afterResponse)for(let R=0;R<W.afterResponse.length;R++){let b=j.resolveChild(W.afterResponse[R].fn.name);M+=`
await e.afterResponse[${R}](c)
`,b()}if(j.resolve(),!b6)M+="})()";M+="}"}let A6=Q.inject?Object.keys(Q.inject).join(",")+",":"",X1="const {handler,handleError,hooks:e, "+Y2("validator,",C)+"mapResponse,mapCompactResponse,mapEarlyResponse,isNotEmpty,utils:{"+Y2("parseQuery,",w0)+Y2("parseQueryFromURL,",k)+"},error:{"+Y2("ValidationError,",C)+"InternalServerError,"+Y2("ParseError",w0)+"},schema,definitions,ERROR_CODE,"+Y2("parseCookie,",E)+Y2("signCookie,",E)+Y2("decodeURIComponent,",k)+"ElysiaCustomStatusResponse,"+Y2("ELYSIA_TRACE,",O)+Y2("ELYSIA_REQUEST_ID,",O)+Y2("parser,",W.parse?.length)+Y2("getServer,",$.server)+A6+Y2("TypeBoxError",C)+`}=hooks
const trace=e.trace?.map(x=>typeof x==='function'?x:x.fn)??[]
return ${b6?"async ":""}function handle(c){`;if(W.beforeHandle?.length)X1+=`let be
`;if(W.afterHandle?.length)X1+=`let af
`;if(W.mapResponse?.length)X1+=`let mr
`;if(Z)X1+=`c.schema = schema
c.defs = definitions
`;X1+=M+"}";try{if(Y)return Function("hooks",X1);return Function("hooks",X1)({handler:A,hooks:CW(W),validator:C?X:void 0,handleError:z.handleError,mapResponse:J.mapResponse,mapCompactResponse:J.mapCompactResponse,mapEarlyResponse:J.mapEarlyResponse,isNotEmpty:w1,utils:{parseQuery:w0?v5:void 0,parseQueryFromURL:k?KG:void 0},error:{ValidationError:C?r:void 0,InternalServerError:vW,ParseError:w0?nW:void 0},schema:z.router.history,definitions:z.definitions.type,ERROR_CODE:m5,parseCookie:E?eW:void 0,signCookie:E?u5:void 0,decodeURIComponent:k?P6:void 0,ElysiaCustomStatusResponse:K1,ELYSIA_TRACE:O?Jw:void 0,ELYSIA_REQUEST_ID:O?l5:void 0,getServer:()=>z.getServer(),TypeBoxError:C?n:void 0,parser:z["~parser"],...Q.inject})}catch(j){let R=CW(W);console.log("[Composer] failed to generate optimized handler"),console.log("---"),console.log({handler:typeof A==="function"?A.toString():A,instruction:X1,hooks:{...R,transform:R?.transform?.map?.((b)=>b.toString()),resolve:R?.resolve?.map?.((b)=>b.toString()),beforeHandle:R?.beforeHandle?.map?.((b)=>b.toString()),afterHandle:R?.afterHandle?.map?.((b)=>b.toString()),mapResponse:R?.mapResponse?.map?.((b)=>b.toString()),parse:R?.parse?.map?.((b)=>b.toString()),error:R?.error?.map?.((b)=>b.toString()),afterResponse:R?.afterResponse?.map?.((b)=>b.toString()),stop:R?.stop?.map?.((b)=>b.toString())},validator:X,definitions:z.definitions.type,error:j,fnLiteral:M}),console.log("---"),process.exit(1)}},ww=(z,{asManifest:w=!1}={})=>{let U=z["~adapter"].composeGeneralHandler;z.router.http.build();let W=U.error404(!!z.event.request?.length,!!z.event.error?.length),X=z.event.trace?.length,A="",Z=z.router,$="const route=router.find(r.method,p)";$+=Z.http.root.ALL?`??router.find("ALL",p)
`:`
`,$+=W.code,$+=`
c.params=route.params
if(route.store.handler)return route.store.handler(c)
return (route.store.handler=route.store.compile())(c)
`;let Y="";for(let[G,O]of Object.entries(Z.static.http.map)){if(Y+=`case'${G}':`,z.config.strictPath!==!0)Y+=`case'${D4(G)}':`;let M=a4(G);if(G!==M)Y+=`case'${M}':`;Y+=`switch(r.method){${O.code}
`+(O.all??"default: break map")+"}"}let Q=!!z.event.request?.some(e0),J=U.inject?Object.keys(U.inject).join(",")+",":"";if(A+=`
const {app,mapEarlyResponse,NotFoundError,randomId,handleError,error,redirect,`+Y2("ELYSIA_TRACE,",X)+Y2("ELYSIA_REQUEST_ID,",X)+J+`}=data
const store=app.singleton.store
const decorator=app.singleton.decorator
const staticRouter=app.router.static.http
const ht=app.router.history
const router=app.router.http
const trace=app.event.trace?.map(x=>typeof x==='function'?x:x.fn)??[]
const notFound=new NotFoundError()
const hoc=app.extender.higherOrderFunctions.map(x=>x.fn)
`,z.event.request?.length)A+=`const onRequest=app.event.request.map(x=>x.fn)
`;if(A+=W.declare,z.event.trace?.length)A+="const "+z.event.trace.map((G,O)=>`tr${O}=app.event.trace[${O}].fn`).join(",")+`
`;if(A+=`${Q?"async ":""}function map(${U.parameters}){`,z.event.request?.length)A+=`let re
`;if(A+=U.createContext(z),z.event.trace?.length)A+="c[ELYSIA_TRACE]=["+z.event.trace.map((G,O)=>`tr${O}(c)`).join(",")+`]
`;let N=Bw({trace:z.event.trace,addFn(G){A+=G}})("request",{total:z.event.request?.length});if(z.event.request?.length){A+="try{";for(let G=0;G<z.event.request.length;G++){let O=z.event.request[G],M=w8(O),C=e0(O),k=N.resolveChild(z.event.request[G].fn.name);if(M)A+=`re=mapEarlyResponse(${C?"await ":""}onRequest[${G}](c),c.set)
`,k("re"),A+=`if(re!==undefined)return re
`;else A+=`${C?"await ":""}onRequest[${G}](c)
`,k()}A+="}catch(error){return app.handleError(c,error,false)}"}if(N.resolve(),A+=U.websocket(z),A+=`
map:switch(p){
`+Y+"default:break}"+$+`}
`,z.extender.higherOrderFunctions.length){let G="map";for(let O=0;O<z.extender.higherOrderFunctions.length;O++)G=`hoc[${O}](${G},${U.parameters})`;A+=`return function hocMap(${U.parameters}){return ${G}(${U.parameters})}`}else A+="return map";let S=WX(z);return z.handleError=S,Function("data",A)({app:z,mapEarlyResponse:z["~adapter"].handler.mapEarlyResponse,NotFoundError:Qw,randomId:iW,handleError:S,error:yW,redirect:cW,ELYSIA_TRACE:X?Jw:void 0,ELYSIA_REQUEST_ID:X?l5:void 0,...U.inject})},WX=(z)=>{let w=z.event,U="",W=z["~adapter"].composeError,X=W.inject?Object.keys(W.inject).join(",")+",":"",A=!!z.event.trace?.length;if(U+="const {app:{event:{error:onErrorContainer,afterResponse:resContainer,mapResponse:_onMapResponse,trace:_trace}},mapResponse,ERROR_CODE,ElysiaCustomStatusResponse,"+Y2("ELYSIA_TRACE,",A)+Y2("ELYSIA_REQUEST_ID,",A)+X+`}=inject
`,U+=`const trace=_trace?.map(x=>typeof x==='function'?x:x.fn)??[]
const onMapResponse=[]
if(_onMapResponse)for(let i=0;i<_onMapResponse.length;i++)onMapResponse.push(_onMapResponse[i].fn??_onMapResponse[i])
delete _onMapResponse
const onError=onErrorContainer?.map(x=>x.fn)??[]
const res=resContainer?.map(x=>x.fn)??[]
return ${z.event.error?.find(e0)||z.event.mapResponse?.find(e0)?"async ":""}function(context,error,skipGlobal){`,U+="",A)U+=`const id=context[ELYSIA_REQUEST_ID]
`;let Z=Bw({context:"context",trace:w.trace,addFn:(Q)=>{U+=Q}});if(U+=`const set=context.set
let _r
if(!context.code)context.code=error.code??error[ERROR_CODE]
if(!(context.error instanceof Error))context.error=error
if(error instanceof ElysiaCustomStatusResponse){set.status=error.status=error.code
error.message=error.response}`,W.declare)U+=W.declare;let $=A||!!w.afterResponse?.length||!!w.afterResponse?.length?"context.response = ":"";if(z.event.error)for(let Q=0;Q<z.event.error.length;Q++){let J=z.event.error[Q],N=`${e0(J)?"await ":""}onError[${Q}](context)
`;if(U+="if(skipGlobal!==true){",w8(J)){U+=`_r=${N}
if(_r!==undefined){if(_r instanceof Response)return mapResponse(_r,set${W.mapResponseContext})
if(_r instanceof ElysiaCustomStatusResponse){error.status=error.code
error.message = error.response}if(set.status===200||!set.status)set.status=error.status
`;let S=Z("mapResponse",{total:w.mapResponse?.length,name:"context"});if(w.mapResponse?.length)for(let G=0;G<w.mapResponse.length;G++){let O=w.mapResponse[G],M=S.resolveChild(O.fn.name);U+=`context.response=_r_r=${O4(O)?"await ":""}onMapResponse[${G}](context)
`,M()}S.resolve(),U+=`return mapResponse(${$}_r,set${W.mapResponseContext})}`}else U+=N;U+="}"}U+=`if(error.constructor.name==="ValidationError"||error.constructor.name==="TransformDecodeError"){if(error.error)error=error.error
set.status=error.status??422
`+W.validationError+"}",U+="if(error instanceof Error){"+W.unknownError+"}";let Y=Z("mapResponse",{total:w.mapResponse?.length,name:"context"});if(U+=`
if(!context.response)context.response=error.message??error
`,w.mapResponse?.length){U+=`let mr
`;for(let Q=0;Q<w.mapResponse.length;Q++){let J=w.mapResponse[Q],N=Y.resolveChild(J.fn.name);U+=`if(mr===undefined){mr=${O4(J)?"await ":""}onMapResponse[${Q}](context)
if(mr!==undefined)error=context.response=mr}`,N()}}return Y.resolve(),U+=`
return mapResponse(${$}error,set${W.mapResponseContext})}`,Function("inject",U)({app:z,mapResponse:z["~adapter"].handler.mapResponse,ERROR_CODE:m5,ElysiaCustomStatusResponse:K1,ELYSIA_TRACE:A?Jw:void 0,ELYSIA_REQUEST_ID:A?l5:void 0,...W.inject})},Uw=(z,w)=>{for(let[U,W]of Object.entries(z.schema.properties))w[U]??=W.default},TW=(z)=>{let{mapResponse:w,mapEarlyResponse:U}=z["~adapter"].handler;return async(W)=>{let X=W.url,A=X.indexOf("/",11),Z=X.indexOf("?",A+1),$=Z===-1?X.substring(A):X.substring(A,Z),Y={cookie:{},status:200,headers:{}},Q=Object.assign({},z.singleton.decorator,{set:Y,store:z.singleton.store,request:W,path:$,qi:Z,error:yW,redirect:cW});try{if(z.event.request)for(let E=0;E<z.event.request.length;E++){let T=z.event.request[E].fn,F=T(Q);if(F instanceof Promise)F=await F;if(F=U(F,Y),F)return Q.response=F}let J=z.router.dynamic.find(W.method,$)??z.router.dynamic.find("ALL",$);if(!J)throw new Qw;let{handle:N,hooks:S,validator:G,content:O,route:M}=J.store,C;if(W.method!=="GET"&&W.method!=="HEAD")if(O)switch(O){case"application/json":C=await W.json();break;case"text/plain":C=await W.text();break;case"application/x-www-form-urlencoded":C=v5(await W.text());break;case"application/octet-stream":C=await W.arrayBuffer();break;case"multipart/form-data":C={};let E=await W.formData();for(let T of E.keys()){if(C[T])continue;let F=E.getAll(T);if(F.length===1)C[T]=F[0];else C[T]=F}break}else{let E=W.headers.get("content-type");if(E){let T=E.indexOf(";");if(T!==-1)E=E.slice(0,T);if(Q.contentType=E,S.parse)for(let F=0;F<S.parse.length;F++){let a=S.parse[F].fn,Z0=a(Q,E);if(Z0 instanceof Promise)Z0=await Z0;if(Z0){C=Z0;break}}if(delete Q.contentType,C===void 0)switch(E){case"application/json":C=await W.json();break;case"text/plain":C=await W.text();break;case"application/x-www-form-urlencoded":C=v5(await W.text());break;case"application/octet-stream":C=await W.arrayBuffer();break;case"multipart/form-data":C={};let F=await W.formData();for(let a of F.keys()){if(C[a])continue;let Z0=F.getAll(a);if(Z0.length===1)C[a]=Z0[0];else C[a]=Z0}break}}}Q.route=M,Q.body=C,Q.params=J?.params||void 0,Q.query=Z===-1?{}:v5(X.substring(Z+1)),Q.headers={};for(let[E,T]of W.headers.entries())Q.headers[E]=T;let k=Object.assign({},z.config?.cookie,G?.cookie?.config),q0=W.headers.get("cookie");Q.cookie=await eW(Q.set,q0,k?{secrets:k.secrets!==void 0?typeof k.secrets==="string"?k.secrets:k.secrets.join(","):void 0,sign:k.sign===!0?!0:k.sign!==void 0?typeof k.sign==="string"?k.sign:k.sign.join(","):void 0}:void 0);let w0=G?.createHeaders?.();if(w0)Uw(w0,Q.headers);let _0=G?.createParams?.();if(_0)Uw(_0,Q.params);let C0=G?.createQuery?.();if(C0)Uw(C0,Q.query);if(S.transform)for(let E=0;E<S.transform.length;E++){let T=S.transform[E],F=T.fn(Q);if(T.subType==="derive")if(F instanceof Promise)Object.assign(Q,await F);else Object.assign(Q,F);else if(F instanceof Promise)await F}if(G){if(w0){let E=structuredClone(Q.headers);for(let[T,F]of W.headers)E[T]=F;if(G.headers.Check(E)===!1)throw new r("header",G.headers,E)}else if(G.headers?.Decode)Q.headers=G.headers.Decode(Q.headers);if(_0?.Check(Q.params)===!1)throw new r("params",G.params,Q.params);else if(G.params?.Decode)Q.params=G.params.Decode(Q.params);if(C0?.Check(Q.query)===!1)throw new r("query",G.query,Q.query);else if(G.query?.Decode)Q.query=G.query.Decode(Q.query);if(G.createCookie?.()){let E={};for(let[T,F]of Object.entries(Q.cookie))E[T]=F.value;if(G.cookie.Check(E)===!1)throw new r("cookie",G.cookie,E);else if(G.cookie?.Decode)E=G.cookie.Decode(E)}if(G.createBody?.()?.Check(C)===!1)throw new r("body",G.body,C);else if(G.body?.Decode)Q.body=G.body.Decode(C)}if(S.beforeHandle)for(let E=0;E<S.beforeHandle.length;E++){let T=S.beforeHandle[E],F=T.fn(Q);if(T.subType==="resolve"){if(F instanceof K1){let a=U(F,Q.set);if(a)return Q.response=a}if(F instanceof Promise)Object.assign(Q,await F);else Object.assign(Q,F);continue}else if(F instanceof Promise)F=await F;if(F!==void 0){if(Q.response=F,S.afterHandle)for(let Z0=0;Z0<S.afterHandle.length;Z0++){let H0=S.afterHandle[Z0].fn(Q);if(H0 instanceof Promise)H0=await H0;if(H0)F=H0}let a=U(F,Q.set);if(a)return Q.response=a}}let f=typeof N==="function"?N(Q):N;if(f instanceof Promise)f=await f;if(S.afterHandle)if(!S.afterHandle.length){let E=f instanceof K1?f.code:Y.status?typeof Y.status==="string"?p5[Y.status]:Y.status:200,T=G?.createResponse?.()?.[E];if(T?.Check(f)===!1)throw new r("response",T,f);else if(T?.Decode)f=T.Decode(f)}else{Q.response=f;for(let E=0;E<S.afterHandle.length;E++){let T=S.afterHandle[E].fn(Q);if(T instanceof Promise)T=await T;let F=U(T,Q.set);if(F!==void 0){let a=G?.response?.[F.status];if(a?.Check(F)===!1)throw new r("response",a,F);else if(a?.Decode)f=a.Decode(f);return Q.response=F}}}if(Q.set.cookie&&k?.sign){let E=!k.secrets?void 0:typeof k.secrets==="string"?k.secrets:k.secrets[0];if(k.sign===!0)for(let[T,F]of Object.entries(Q.set.cookie))Q.set.cookie[T].value=await u5(F.value,"${secret}");else{let T=G?.cookie?.schema?.properties;for(let F of k.sign){if(!(F in T))continue;if(Q.set.cookie[F]?.value)Q.set.cookie[F].value=await u5(Q.set.cookie[F].value,E)}}}return w(Q.response=f,Q.set)}catch(J){let N=J instanceof E5&&J.error?J.error:J;return z.handleError(Q,N)}finally{if(z.event.afterResponse)for(let J of z.event.afterResponse)await J.fn(Q)}}},kG=(z)=>{let{mapResponse:w}=z["~adapter"].handler;return async(U,W)=>{let X=Object.assign(U,{error:W,code:W.code});if(X.set=U.set,z.event.error)for(let A=0;A<z.event.error.length;A++){let Z=z.event.error[A].fn(X);if(Z instanceof Promise)Z=await Z;if(Z!==void 0&&Z!==null)return U.response=w(Z,U.set)}return new Response(typeof W.cause==="string"?W.cause:W.message,{headers:U.set.headers,status:W.status??500})}};class K0{config;server=null;dependencies={};_routes={};_types={Prefix:"",Singleton:{},Definitions:{},Metadata:{}};_ephemeral={};_volatile={};singleton={decorator:{},store:{},derive:{},resolve:{}};get store(){return this.singleton.store}get decorator(){return this.singleton.decorator}definitions={typebox:I.Module({}),type:{},error:{}};extender={macros:[],higherOrderFunctions:[]};validator={global:null,scoped:null,local:null,getCandidate(){return s4(s4(this.global,this.scoped),this.local)}};event={};telemetry={stack:void 0};router={"~http":void 0,get http(){if(!this["~http"])this["~http"]=new j6({lazy:!0});return this["~http"]},"~dynamic":void 0,get dynamic(){if(!this["~dynamic"])this["~dynamic"]=new j6;return this["~dynamic"]},static:{http:{static:{},map:{},all:""},ws:{}},history:[]};routeTree=new Map;get routes(){return this.router.history}getGlobalRoutes(){return this.router.history}inference={body:!1,cookie:!1,headers:!1,query:!1,set:!1,server:!1,request:!1,route:!1};getServer(){return this.server}getParent(){return null}"~parser"={};_promisedModules;get promisedModules(){if(!this._promisedModules)this._promisedModules=new hW;return this._promisedModules}constructor(z={}){if(z.tags)if(!z.detail)z.detail={tags:z.tags};else z.detail.tags=z.tags;if(z.nativeStaticResponse===void 0)z.nativeStaticResponse=!0;if(this.config={},this.applyConfig(z??{}),this["~adapter"]=z.adapter??(typeof Bun!=="undefined"?CG:y5),z?.analytic&&(z?.name||z?.seed!==void 0))this.telemetry.stack=new Error().stack}"~adapter";env(z,w=kW){if(j2(z,{modules:this.definitions.typebox,dynamic:!0,additionalProperties:!0,coerce:!0}).Check(w)===!1){let U=new r("env",z,w);throw new Error(U.all.map((W)=>W.summary).join(`
`))}return this}wrap(z){return this.extender.higherOrderFunctions.push({checksum:r4(JSON.stringify({name:this.config.name,seed:this.config.seed,content:z.toString()})),fn:z}),this}applyMacro(z){if(this.extender.macros.length){let w=XG({globalHook:this.event,localHook:z}),U={events:{global:this.event,local:z},get onParse(){return w("parse")},get onTransform(){return w("transform")},get onBeforeHandle(){return w("beforeHandle")},get onAfterHandle(){return w("afterHandle")},get mapResponse(){return w("mapResponse")},get onAfterResponse(){return w("afterResponse")},get onError(){return w("error")}};for(let W of this.extender.macros)WG(W.fn(U),z,w)}}applyConfig(z){return this.config={prefix:"",aot:kW.ELYSIA_AOT!=="false",normalize:!0,...z,cookie:{path:"/",...z?.cookie},experimental:z?.experimental??{},seed:z?.seed===void 0?"":z?.seed},this}get models(){let z={};for(let w of Object.keys(this.definitions.type))z[w]=j2(this.definitions.typebox.Import(w));return z.modules=this.definitions.typebox,z}add(z,w,U,W,{allowMeta:X=!1,skipPrefix:A=!1}={allowMeta:!1,skipPrefix:!1}){if(W=zw(ZG(W)),w!==""&&w.charCodeAt(0)!==47)w="/"+w;if(this.config.prefix&&!A)w=this.config.prefix+w;if(W?.type)switch(W.type){case"text":W.type="text/plain";break;case"json":W.type="application/json";break;case"formdata":W.type="multipart/form-data";break;case"urlencoded":W.type="application/x-www-form-urlencoded";break;case"arrayBuffer":W.type="application/octet-stream";break;default:break}let Z=this.definitions.type,$=!this.config.aot,Y={...this.validator.getCandidate()},Q={body:W?.body??Y?.body,headers:W?.headers??Y?.headers,params:W?.params??Y?.params,query:W?.query??Y?.query,cookie:W?.cookie??Y?.cookie,response:W?.response??Y?.response},J=()=>Q.cookie?dW({modules:S,validator:Q.cookie,defaultConfig:this.config.cookie,config:Q.cookie?.config??{},dynamic:$,models:Z}):void 0,N=this.config.normalize,S=this.definitions.typebox,G=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.schema===!0?{body:j2(Q.body,{modules:S,dynamic:$,models:Z,normalize:N,additionalCoerce:_W()}),headers:j2(Q.headers,{modules:S,dynamic:$,models:Z,additionalProperties:!this.config.normalize,coerce:!0,additionalCoerce:y6()}),params:j2(Q.params,{modules:S,dynamic:$,models:Z,coerce:!0,additionalCoerce:y6()}),query:j2(Q.query,{modules:S,dynamic:$,models:Z,normalize:N,coerce:!0,additionalCoerce:y6()}),cookie:J(),response:HW(Q.response,{modules:S,dynamic:$,models:Z,normalize:N})}:{createBody(){if(this.body)return this.body;return this.body=j2(Q.body,{modules:S,dynamic:$,models:Z,normalize:N,additionalCoerce:_W()})},createHeaders(){if(this.headers)return this.headers;return this.headers=j2(Q.headers,{modules:S,dynamic:$,models:Z,additionalProperties:!N,coerce:!0,additionalCoerce:y6()})},createParams(){if(this.params)return this.params;return this.params=j2(Q.params,{modules:S,dynamic:$,models:Z,coerce:!0,additionalCoerce:y6()})},createQuery(){if(this.query)return this.query;return this.query=j2(Q.query,{modules:S,dynamic:$,models:Z,coerce:!0,additionalCoerce:y6()})},createCookie(){if(this.cookie)return this.cookie;return this.cookie=J()},createResponse(){if(this.response)return this.response;return this.response=HW(Q.response,{modules:S,dynamic:$,models:Z,normalize:N})}};if(W=z6(W,zw(Y)),W.tags)if(!W.detail)W.detail={tags:W.tags};else W.detail.tags=W.tags;if(w1(this.config.detail))W.detail=F2(Object.assign({},this.config.detail),W.detail);this.applyMacro(W);let O=zw(z6(this.event,W));if(this.config.aot===!1){this.router.dynamic.add(z,w,{validator:G,hooks:O,content:W?.type,handle:U,route:w});let H0=a4(w,{dynamic:!0});if(w!==H0)this.router.dynamic.add(z,H0,{validator:G,hooks:O,content:W?.type,handle:U,route:w});if(this.config.strictPath===!1){let h0=D4(w);this.router.dynamic.add(z,h0,{validator:G,hooks:O,content:W?.type,handle:U,route:w});let U6=a4(h0);if(h0!==U6)this.router.dynamic.add(z,h0,{validator:G,hooks:O,content:W?.type,handle:U,route:w})}this.router.history.push({method:z,path:w,composed:null,handler:U,hooks:O});return}let M=this.config.precompile===!0||typeof this.config.precompile==="object"&&this.config.precompile.compose===!0,C=ez(this.inference),k=this["~adapter"].handler,q0=typeof U!=="function"&&typeof k.createStaticHandler==="function"?k.createStaticHandler(U,O,this.setHeaders):void 0,w0=typeof U!=="function"?k.createNativeStaticHandler?.(U,O,this.setHeaders):void 0;if(this.config.nativeStaticResponse===!0&&w0&&(z==="GET"||z==="ALL"))this.router.static.http.static[w]=w0();let _0=(H0=!1)=>VG({app:this,path:w,method:z,hooks:O,validator:G,handler:typeof U!=="function"&&typeof k.createStaticHandler!=="function"?()=>U:U,allowMeta:X,inference:C,asManifest:H0}),C0;if(this.routeTree.has(z+w))for(let H0=0;H0<this.router.history.length;H0++){let h0=this.router.history[H0];if(h0.path===w&&h0.method===z){C0=H0;break}}else this.routeTree.set(z+w,this.router.history.length);let f=this.router.history,E=C0??this.router.history.length,T=M?_0():(H0)=>{let h0=(f[E].composed=_0())(H0);return _0=void 0,h0};if(M)_0=void 0;let F=z==="$INTERNALWS";if(C0!==void 0)this.router.history[C0]=Object.assign({method:z,path:w,composed:T,handler:U,hooks:O},W.webSocket?{websocket:W.websocket}:{});else this.router.history.push(Object.assign({method:z,path:w,composed:T,handler:U,hooks:O},W.webSocket?{websocket:W.websocket}:{}));let a=this.router.static.http,Z0={handler:M?T:void 0,compile(){return this.handler=_0()}};if(F){if(this.router.http.add("ws",w,Z0),!this.config.strictPath)this.router.http.add("ws",D4(w),Z0);let H0=a4(w,{dynamic:!0});if(H0!==w)this.router.http.add("ws",H0,Z0);return}if(w.indexOf(":")===-1&&w.indexOf("*")===-1){if(!a.map[w])a.map[w]={code:""};let H0=q0?"":"c";if(z==="ALL")a.map[w].all=`default:return ht[${E}].composed(${H0})
`;else a.map[w].code=`case '${z}':return ht[${E}].composed(${H0})
${a.map[w].code}`;if(!this.config.strictPath&&this.config.nativeStaticResponse===!0&&w0&&(z==="GET"||z==="ALL"))this.router.static.http.static[D4(w)]=w0()}else{if(this.router.http.add(z,w,Z0),!this.config.strictPath){let h0=D4(w);if(this.config.nativeStaticResponse===!0&&q0&&(z==="GET"||z==="ALL"))this.router.static.http.static[h0]=q0();this.router.http.add(z,h0,Z0)}let H0=a4(w,{dynamic:!0});if(w!==H0){if(this.router.http.add(z,H0,Z0),this.config.nativeStaticResponse===!0&&q0&&(z==="GET"||z==="ALL"))this.router.static.http.static[H0]=q0();this.router.http.add(z,H0,Z0)}}}setHeaders;headers(z){if(!z)return this;if(!this.setHeaders)this.setHeaders={};return this.setHeaders=F2(this.setHeaders,z),this}onStart(z){return this.on("start",z),this}onRequest(z){return this.on("request",z),this}onParse(z,w){if(!w){if(typeof z==="string")return this.on("parse",this["~parser"][z]);return this.on("parse",z)}return this.on(z,"parse",w)}parser(z,w){return this["~parser"][z]=w,this}onTransform(z,w){if(!w)return this.on("transform",z);return this.on(z,"transform",w)}resolve(z,w){if(!w)w=z,z={as:"local"};let U={subType:"resolve",fn:w};return this.onBeforeHandle(z,U)}mapResolve(z,w){if(!w)w=z,z={as:"local"};let U={subType:"mapResolve",fn:w};return this.onBeforeHandle(z,U)}onBeforeHandle(z,w){if(!w)return this.on("beforeHandle",z);return this.on(z,"beforeHandle",w)}onAfterHandle(z,w){if(!w)return this.on("afterHandle",z);return this.on(z,"afterHandle",w)}mapResponse(z,w){if(!w)return this.on("mapResponse",z);return this.on(z,"mapResponse",w)}onAfterResponse(z,w){if(!w)return this.on("afterResponse",z);return this.on(z,"afterResponse",w)}trace(z,w){if(!w)w=z,z={as:"local"};if(!Array.isArray(w))w=[w];for(let U of w)this.on(z,"trace",FG(U));return this}error(z,w){switch(typeof z){case"string":return w.prototype[m5]=z,this.definitions.error[z]=w,this;case"function":return this.definitions.error=z(this.definitions.error),this}for(let[U,W]of Object.entries(z))W.prototype[m5]=U,this.definitions.error[U]=W;return this}onError(z,w){if(!w)return this.on("error",z);return this.on(z,"error",w)}onStop(z){return this.on("stop",z),this}on(z,w,U){let W;switch(typeof z){case"string":W=z,U=w;break;case"object":if(W=w,!Array.isArray(w)&&typeof w==="object")U=w;break}if(Array.isArray(U))U=W2(U);else if(typeof U==="function")U=[{fn:U}];else U=[U];let X=U;for(let A of X)if(A.scope=typeof z==="string"?"local":z?.as??"local",W==="resolve"||W==="derive")A.subType=W;if(W!=="trace")rW({[W]:X.map((A)=>A.fn)},this.inference);for(let A of X){let Z=wG(A,"global",{skipIfHasType:!0});switch(W){case"start":this.event.start??=[],this.event.start.push(Z);break;case"request":this.event.request??=[],this.event.request.push(Z);break;case"parse":this.event.parse??=[],this.event.parse.push(Z);break;case"transform":this.event.transform??=[],this.event.transform.push(Z);break;case"derive":this.event.transform??=[],this.event.transform.push(W2(Z,"derive"));break;case"beforeHandle":this.event.beforeHandle??=[],this.event.beforeHandle.push(Z);break;case"resolve":this.event.beforeHandle??=[],this.event.beforeHandle.push(W2(Z,"resolve"));break;case"afterHandle":this.event.afterHandle??=[],this.event.afterHandle.push(Z);break;case"mapResponse":this.event.mapResponse??=[],this.event.mapResponse.push(Z);break;case"afterResponse":this.event.afterResponse??=[],this.event.afterResponse.push(Z);break;case"trace":this.event.trace??=[],this.event.trace.push(Z);break;case"error":this.event.error??=[],this.event.error.push(Z);break;case"stop":this.event.stop??=[],this.event.stop.push(Z);break}}return this}propagate(){return L2(this.event.parse),L2(this.event.transform),L2(this.event.beforeHandle),L2(this.event.afterHandle),L2(this.event.mapResponse),L2(this.event.afterResponse),L2(this.event.trace),L2(this.event.error),this}as(z){let w={plugin:"scoped",scoped:"scoped",global:"global"}[z];if(L2(this.event.parse,w),L2(this.event.transform,w),L2(this.event.beforeHandle,w),L2(this.event.afterHandle,w),L2(this.event.mapResponse,w),L2(this.event.afterResponse,w),L2(this.event.trace,w),L2(this.event.error,w),z==="plugin")this.validator.scoped=s4(this.validator.scoped,this.validator.local),this.validator.local=null;else if(z==="global")this.validator.global=s4(this.validator.global,s4(this.validator.scoped,this.validator.local)),this.validator.scoped=null,this.validator.local=null;return this}group(z,w,U){let W=new K0({...this.config,prefix:""});W.singleton={...this.singleton},W.definitions={...this.definitions},W.getServer=()=>this.getServer(),W.inference=ez(this.inference),W.extender={...this.extender};let X=typeof w==="object",A=(X?U:w)(W);if(this.singleton=F2(this.singleton,W.singleton),this.definitions=F2(this.definitions,W.definitions),A.event.request?.length)this.event.request=[...this.event.request||[],...A.event.request||[]];if(A.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...A.event.mapResponse||[]];return this.model(A.definitions.type),Object.values(W.router.history).forEach(({method:Z,path:$,handler:Y,hooks:Q})=>{if($=(X?"":this.config.prefix)+z+$,X){let J=w,N=Q;this.add(Z,$,Y,z6(J,{...N||{},error:!N.error?A.event.error:Array.isArray(N.error)?[...N.error||{},...A.event.error||{}]:[N.error,...A.event.error||{}]}))}else this.add(Z,$,Y,z6(Q,{error:A.event.error}),{skipPrefix:!0})}),this}guard(z,w){if(!w){if(typeof z==="object"){this.applyMacro(z);let X=z.as??"local";if(this.validator[X]={body:z.body??this.validator[X]?.body,headers:z.headers??this.validator[X]?.headers,params:z.params??this.validator[X]?.params,query:z.query??this.validator[X]?.query,response:z.response??this.validator[X]?.response,cookie:z.cookie??this.validator[X]?.cookie},z.parse)this.on({as:X},"parse",z.parse);if(z.transform)this.on({as:X},"transform",z.transform);if(z.derive)this.on({as:X},"derive",z.derive);if(z.beforeHandle)this.on({as:X},"beforeHandle",z.beforeHandle);if(z.resolve)this.on({as:X},"resolve",z.resolve);if(z.afterHandle)this.on({as:X},"afterHandle",z.afterHandle);if(z.mapResponse)this.on({as:X},"mapResponse",z.mapResponse);if(z.afterResponse)this.on({as:X},"afterResponse",z.afterResponse);if(z.error)this.on({as:X},"error",z.error);if(z.detail)if(this.config.detail)this.config.detail=F2(Object.assign({},this.config.detail),z.detail);else this.config.detail=z.detail;if(z?.tags)if(!this.config.detail)this.config.detail={tags:z.tags};else this.config.detail.tags=z.tags;return this}return this.guard({},z)}let U=new K0({...this.config,prefix:""});U.singleton={...this.singleton},U.definitions={...this.definitions},U.inference=ez(this.inference),U.extender={...this.extender};let W=w(U);if(this.singleton=F2(this.singleton,U.singleton),this.definitions=F2(this.definitions,U.definitions),W.getServer=()=>this.server,W.event.request?.length)this.event.request=[...this.event.request||[],...W.event.request||[]];if(W.event.mapResponse?.length)this.event.mapResponse=[...this.event.mapResponse||[],...W.event.mapResponse||[]];return this.model(W.definitions.type),Object.values(U.router.history).forEach(({method:X,path:A,handler:Z,hooks:$})=>{this.add(X,A,Z,z6(z,{...$||{},error:!$.error?W.event.error:Array.isArray($.error)?[...$.error||{},...W.event.error||[]]:[$.error,...W.event.error||[]]}))}),this}use(z,w){if(Array.isArray(z)){let U=this;for(let W of z)U=U.use(W);return U}if(w?.scoped)return this.guard({},(U)=>U.use(z));if(Array.isArray(z)){let U=this;for(let W of z)U=this.use(W);return U}if(z instanceof Promise)return this.promisedModules.add(z.then((U)=>{if(typeof U==="function")return U(this);if(U instanceof K0)return this._use(U).compile();if(U.constructor.name==="Elysia")return this._use(U).compile();if(typeof U.default==="function")return U.default(this);if(U.default instanceof K0)return this._use(U.default);if(U.constructor.name==="Elysia")return this._use(U.default);if(U.constructor.name==="_Elysia")return this._use(U.default);try{return this._use(U.default)}catch(W){throw console.error('Invalid plugin type. Expected Elysia instance, function, or module with "default" as Elysia instance or function that returns Elysia instance.'),W}}).then((U)=>{if(U&&typeof U.compile==="function")U.compile();return U})),this;return this._use(z)}propagatePromiseModules(z){if(z.promisedModules.size<=0)return this;for(let w of z.promisedModules.promises)this.promisedModules.add(w.then((U)=>{if(!U)return;let W=this._use(U);if(W instanceof Promise)return W.then((X)=>{if(X)X.compile();else U.compile()});return U.compile()}));return this}_use(z){if(typeof z==="function"){let X=z(this);if(X instanceof Promise)return this.promisedModules.add(X.then((A)=>{if(A instanceof K0){A.getServer=()=>this.getServer(),A.getGlobalRoutes=()=>this.getGlobalRoutes(),A.model(this.definitions.type),A.error(this.definitions.error);for(let{method:Z,path:$,handler:Y,hooks:Q}of Object.values(A.router.history))this.add(Z,$,Y,z6(Q,{error:A.event.error}));if(A.compile(),A===this)return;return this.propagatePromiseModules(A),A}if(typeof A==="function")return A(this);if(typeof A.default==="function")return A.default(this);return this._use(A)}).then((A)=>{if(A&&typeof A.compile==="function")A.compile();return A})),this;return X}this.propagatePromiseModules(z);let{name:w,seed:U}=z.config;if(z.getParent=()=>this,z.getServer=()=>this.getServer(),z.getGlobalRoutes=()=>this.getGlobalRoutes(),z.model(this.definitions.type),z.error(this.definitions.error),this["~parser"]={...z["~parser"],...this["~parser"]},this.headers(z.setHeaders),w){if(!(w in this.dependencies))this.dependencies[w]=[];let X=U!==void 0?r4(w+JSON.stringify(U)):0;if(!this.dependencies[w].some(({checksum:A})=>X===A))this.extender.macros=this.extender.macros.concat(z.extender.macros),this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat(z.extender.higherOrderFunctions)}else this.extender.macros=this.extender.macros.concat(z.extender.macros),this.extender.higherOrderFunctions=this.extender.higherOrderFunctions.concat(z.extender.higherOrderFunctions);bW(this.extender.macros),bW(this.extender.higherOrderFunctions);let W=[];for(let X=0;X<this.extender.higherOrderFunctions.length;X++){let A=this.extender.higherOrderFunctions[X];if(A.checksum){if(W.includes(A.checksum))this.extender.higherOrderFunctions.splice(X,1),X--;W.push(A.checksum)}}this.inference={body:this.inference.body||z.inference.body,cookie:this.inference.cookie||z.inference.cookie,headers:this.inference.headers||z.inference.headers,query:this.inference.query||z.inference.query,set:this.inference.set||z.inference.set,server:this.inference.server||z.inference.server,request:this.inference.request||z.inference.request,route:this.inference.route||z.inference.route},this.decorate(z.singleton.decorator),this.state(z.singleton.store),this.model(z.definitions.type),this.error(z.definitions.error),z.extender.macros=this.extender.macros.concat(z.extender.macros);for(let{method:X,path:A,handler:Z,hooks:$}of Object.values(z.router.history))this.add(X,A,Z,z6($,{error:z.event.error}));if(w){if(!(w in this.dependencies))this.dependencies[w]=[];let X=U!==void 0?r4(w+JSON.stringify(U)):0;if(this.dependencies[w].some(({checksum:A})=>X===A))return this;this.dependencies[w].push(this.config?.analytic?{name:z.config.name,seed:z.config.seed,checksum:X,dependencies:z.dependencies,stack:z.telemetry.stack,routes:z.router.history,decorators:z.singleton,store:z.singleton.store,error:z.definitions.error,derive:z.event.transform?.filter((A)=>A?.subType==="derive").map((A)=>({fn:A.toString(),stack:new Error().stack??""})),resolve:z.event.transform?.filter((A)=>A?.subType==="resolve").map((A)=>({fn:A.toString(),stack:new Error().stack??""}))}:{name:z.config.name,seed:z.config.seed,checksum:X,dependencies:z.dependencies}),this.event=SW(this.event,DW(z.event),X)}else this.event=SW(this.event,DW(z.event));return this.validator.global=z6(this.validator.global,{...z.validator.global}),this.validator.local=z6(this.validator.local,{...z.validator.scoped}),this}macro(z){if(typeof z==="function"){let w={checksum:r4(JSON.stringify({name:this.config.name,seed:this.config.seed,content:z.toString()})),fn:z};this.extender.macros.push(w)}else if(typeof z==="object"){for(let U of Object.keys(z))if(typeof z[U]==="object"){let W={...z[U]};z[U]=(X)=>{if(X===!0)return W}}let w={checksum:r4(JSON.stringify({name:this.config.name,seed:this.config.seed,content:Object.entries(z).map(([U,W])=>`${U}+${W}`).join(",")})),fn:()=>z};this.extender.macros.push(w)}return this}mount(z,w){if(z instanceof K0||typeof z==="function"||z.length===0||z==="/"){let X=typeof z==="function"?z:z instanceof K0?z.compile().fetch:w instanceof K0?w.compile().fetch:w,A=({request:Z,path:$})=>X(new Request(GW(Z.url,$),{method:Z.method,headers:Z.headers,signal:Z.signal,credentials:Z.credentials,referrerPolicy:Z.referrerPolicy,duplex:Z.duplex,redirect:Z.redirect,mode:Z.mode,keepalive:Z.keepalive,integrity:Z.integrity,body:Z.body}));return this.all("/*",A,{parse:"none"}),this}if(!w)return this;let U=z.length-(z.endsWith("*")?1:0);if(w instanceof K0)w=w.compile().fetch;let W=({request:X,path:A})=>w(new Request(GW(X.url,A.slice(U)||"/"),{method:X.method,headers:X.headers,signal:X.signal,credentials:X.credentials,referrerPolicy:X.referrerPolicy,duplex:X.duplex,redirect:X.redirect,mode:X.mode,keepalive:X.keepalive,integrity:X.integrity,body:X.body}));return this.all(z,W,{parse:"none"}),this.all(z+(z.endsWith("/")?"*":"/*"),W,{parse:"none"}),this}get(z,w,U){return this.add("GET",z,w,U),this}post(z,w,U){return this.add("POST",z,w,U),this}put(z,w,U){return this.add("PUT",z,w,U),this}patch(z,w,U){return this.add("PATCH",z,w,U),this}delete(z,w,U){return this.add("DELETE",z,w,U),this}options(z,w,U){return this.add("OPTIONS",z,w,U),this}all(z,w,U){return this.add("ALL",z,w,U),this}head(z,w,U){return this.add("HEAD",z,w,U),this}connect(z,w,U){return this.add("CONNECT",z,w,U),this}route(z,w,U,W){return this.add(z.toUpperCase(),w,U,W,W?.config),this}ws(z,w){if(this["~adapter"].ws)this["~adapter"].ws(this,z,w);else console.warn("Current adapter doesn't support WebSocket");return this}state(z,w,U){if(w===void 0)U=z,z={as:"append"},w="";else if(U===void 0){if(typeof z==="string")U=w,w=z,z={as:"append"};else if(typeof z==="object")U=w,w=""}let{as:W}=z;if(typeof w!=="string")return this;switch(typeof U){case"object":if(w){if(w in this.singleton.store)this.singleton.store[w]=F2(this.singleton.store[w],U,{override:W==="override"});else this.singleton.store[w]=U;return this}if(U===null)return this;return this.singleton.store=F2(this.singleton.store,U,{override:W==="override"}),this;case"function":if(w){if(W==="override"||!(w in this.singleton.store))this.singleton.store[w]=U}else this.singleton.store=U(this.singleton.store);return this;default:if(W==="override"||!(w in this.singleton.store))this.singleton.store[w]=U;return this}}decorate(z,w,U){if(w===void 0)U=z,z={as:"append"},w="";else if(U===void 0){if(typeof z==="string")U=w,w=z,z={as:"append"};else if(typeof z==="object")U=w,w=""}let{as:W}=z;if(typeof w!=="string")return this;switch(typeof U){case"object":if(w){if(w in this.singleton.decorator)this.singleton.decorator[w]=F2(this.singleton.decorator[w],U,{override:W==="override"});else this.singleton.decorator[w]=U;return this}if(U===null)return this;return this.singleton.decorator=F2(this.singleton.decorator,U,{override:W==="override"}),this;case"function":if(w){if(W==="override"||!(w in this.singleton.decorator))this.singleton.decorator[w]=U}else this.singleton.decorator=U(this.singleton.decorator);return this;default:if(W==="override"||!(w in this.singleton.decorator))this.singleton.decorator[w]=U;return this}}derive(z,w){if(!w)w=z,z={as:"local"};let U={subType:"derive",fn:w};return this.onTransform(z,U)}model(z,w){let U=(W)=>Xw(W,[{from:I.Number(),to:(X)=>I.Numeric(X),untilObjectFound:!0},{from:I.Boolean(),to:(X)=>I.BooleanString(X),untilObjectFound:!0}]);switch(typeof z){case"object":let W={},X=Object.entries(z);for(let[$,Y]of X){if($ in this.definitions.type)continue;W[$]=this.definitions.type[$]=U(Y),W[$].$id??=`#/components/schemas/${$}`}return this.definitions.typebox=I.Module({...this.definitions.typebox.$defs,...W}),this;case"function":let A=U(z(this.definitions.type));return this.definitions.type=A,this.definitions.typebox=I.Module(A),this;case"string":if(!w)break;let Z={...w,id:w.$id??`#/components/schemas/${z}`};return this.definitions.type[z]=w,this.definitions.typebox=I.Module({...this.definitions.typebox.$defs,...Z}),this}return this.definitions.type[z]=w,this.definitions.typebox=I.Module({...this.definitions.typebox.$defs,[z]:w}),this}mapDerive(z,w){if(!w)w=z,z={as:"local"};let U={subType:"mapDerive",fn:w};return this.onTransform(z,U)}affix(z,w,U){if(U==="")return this;let W=["_","-"," "],X=(Y)=>Y[0].toUpperCase()+Y.slice(1),A=z==="prefix"?(Y,Q)=>W.includes(Y.at(-1)??"")?Y+Q:Y+X(Q):W.includes(U.at(-1)??"")?(Y,Q)=>Q+Y:(Y,Q)=>Q+X(Y),Z=(Y)=>{let Q={};switch(Y){case"decorator":for(let J in this.singleton.decorator)Q[A(U,J)]=this.singleton.decorator[J];this.singleton.decorator=Q;break;case"state":for(let J in this.singleton.store)Q[A(U,J)]=this.singleton.store[J];this.singleton.store=Q;break;case"model":for(let J in this.definitions.type)Q[A(U,J)]=this.definitions.type[J];this.definitions.type=Q;break;case"error":for(let J in this.definitions.error)Q[A(U,J)]=this.definitions.error[J];this.definitions.error=Q;break}},$=Array.isArray(w)?w:[w];for(let Y of $.some((Q)=>Q==="all")?["decorator","state","model","error"]:$)Z(Y);return this}prefix(z,w){return this.affix("prefix",z,w)}suffix(z,w){return this.affix("suffix",z,w)}compile(){if(this["~adapter"].isWebStandard){if(this.fetch=this.config.aot?ww(this):TW(this),typeof this.server?.reload==="function")this.server.reload({...this.server||{},fetch:this.fetch});return this}if(typeof this.server?.reload==="function")this.server.reload(this.server||{});return this._handle=ww(this),this}handle=async(z)=>this.fetch(z);fetch=(z)=>{return(this.fetch=this.config.aot?ww(this):TW(this))(z)};handleError=async(z,w)=>{return(this.handleError=this.config.aot?WX(this):kG(this))(z,w)};outerErrorHandler=(z)=>new Response(z.message||z.name||"Error",{status:z?.status??500});listen=(z,w)=>{return this["~adapter"].listen(this)(z,w),this};stop=async(z)=>{if(!this.server)throw new Error("Elysia isn't running. Call `app.listen` to start the server.");if(this.server){if(this.server.stop(z),this.server=null,this.event.stop?.length)for(let w=0;w<this.event.stop.length;w++)this.event.stop[w].fn(this)}};get modules(){return this.promisedModules}}var U8={AmazonCognito:Z8,AniList:$8,Apple:Q8,Atlassian:J8,Auth0:B8,Authentik:M8,Bitbucket:q8,Box:L8,Coinbase:N8,Discord:G8,Dribbble:H8,Dropbox:_8,Facebook:S8,Figma:D8,FortyTwo:e8,GitHub:P8,GitLab:O8,Google:R8,Intuit:C8,Kakao:b8,KeyCloak:K8,Lichess:F8,Line:j8,Linear:E8,LinkedIn:I8,MicrosoftEntraId:x8,MyAnimeList:V8,Notion:k8,Okta:T8,Osu:g8,Patreon:f8,Reddit:d8,Roblox:h8,Salesforce:c8,Shikimori:i8,Slack:y8,Spotify:v8,Strava:n8,Tiltify:u8,Tumblr:m8,Twitch:t8,Twitter:o8,VK:p8,WorkOS:l8,Yahoo:s8,Yandex:r8,Zoom:a8},XX=Object.keys(U8).reduce((z,w)=>{return z[w.toLowerCase()]=w,z},{});var r5=(z)=>("refreshAccessToken"in z)&&typeof z.refreshAccessToken==="function",AX=(z)=>("revokeAccessToken"in z)&&typeof z.revokeAccessToken==="function",t6=(z)=>Object.keys(U8).map((w)=>w.toLowerCase()).includes(z.toLowerCase()),ZX=(z)=>!0,$X=(z)=>z!==null&&z!==void 0&&z.trim()!=="";var YX=86400000;var W8=1800;var QX=({clientProviders:z,authorizeRoute:w="authorize",onAuthorize:U})=>new K0().get(`/${w}/:provider`,({error:W,redirect:X,cookie:{state:A,code_verifier:Z,auth_provider:$,redirect_url:Y},params:{provider:Q},headers:J})=>{if(Q===void 0)return W("Bad Request","Provider is required");if(!t6(Q))return W("Bad Request","Invalid provider");try{let N=Q.toLowerCase(),{providerInstance:S,scopes:G,searchParams:O}=z[N],M=J.referer??"/";Y.set({httpOnly:!0,maxAge:W8,path:"/",sameSite:"lax",secure:!0,value:M}),$.set({httpOnly:!0,maxAge:W8,path:"/",sameSite:"lax",secure:!0,value:Q});let C=Xz();A.set({httpOnly:!0,maxAge:W8,path:"/",sameSite:"lax",secure:!0,value:C});let k=S.createAuthorizationURL.toString().includes("codeVerifier"),q0=k?Wz():void 0;k&&Z.set({httpOnly:!0,maxAge:W8,path:"/",sameSite:"lax",secure:!0,value:q0??""});let w0=k?S.createAuthorizationURL(C,q0,G):S.createAuthorizationURL(C,G);return O.forEach(([_0,C0])=>{w0.searchParams.set(_0,C0)}),U?.(),X(w0.toString())}catch(N){if(N instanceof Error)return W("Internal Server Error",`Failed to authorize: ${N.message}`);return W("Internal Server Error",`Unknown error: ${N}`)}});var C4=()=>{let z={};return new K0({name:"sessionStore"}).state({session:z})};var JX=({clientProviders:z,callbackRoute:w="authorize/callback",onCallback:U,getUser:W,createUser:X})=>new K0().use(C4()).get(`/${w}`,async({error:A,redirect:Z,store:{session:$},cookie:{state:Y,code_verifier:Q,redirect_url:J,user_session_id:N,auth_provider:S},query:{code:G,state:O}})=>{if(!$X(G)||Y.value===void 0)return A("Bad Request","Invalid callback request");if(O!==Y.value)return A("Bad Request","Invalid state mismatch");if(S.value===void 0)return A("Unauthorized","No auth provider found");if(!t6(S.value))return A("Unauthorized","Invalid provider");let M=S.value.toLowerCase(),{providerInstance:C}=z[M];try{Y.remove();let k=C.validateAuthorizationCode.toString().includes("codeVerifier"),q0=Q.value;if(k&&q0===void 0)return A("Bad Request","Code verifier not found and is required");let w0=q0??"",_0=await(k?C.validateAuthorizationCode(G,w0):C.validateAuthorizationCode(G));if(k)Q.remove();let C0=Object.fromEntries(Object.entries($z(_0.idToken())).map(([a,Z0])=>[a,typeof Z0==="string"?Z0:void 0])),f=S.value,E=await W?.({authProvider:f,decodedIdToken:C0});if(E=E??await X?.({authProvider:f,decodedIdToken:C0}),!ZX(E))return A("Internal Server Error","Invalid user schema");let T=crypto.randomUUID();$[T]={expiresAt:Date.now()+YX,user:E},N.set({httpOnly:!0,sameSite:"lax",secure:!0,value:T}),U?.();let F=J.value??"/";return Z(F)}catch(k){if(k instanceof Error)return A("Internal Server Error",`${k.message} - ${k.stack??""}`);return A("Internal Server Error",`Failed to validate authorization code: Unknown error: ${k}`)}});var BX=({logoutRoute:z="logout",onLogout:w})=>new K0().post(`/${z}`,async({error:U,cookie:{user_session_id:W,auth_provider:X}})=>{if(X.value===void 0)return U("Unauthorized","No auth provider found");try{return w?.(),W.remove(),X.remove(),new Response("Succesfuly Logged Out",{status:204})}catch(A){if(A instanceof Error)return U("Internal Server Error",`Failed to logout: ${A.message}`);return U("Internal Server Error",`Failed to logout: Unknown error: ${A}`)}});var MX=()=>new K0().use(C4()).derive(({store:{session:z},cookie:{user_session_id:w},error:U})=>({protectRoute:async(W,X)=>{if(w.value===void 0)return X?.()??U("Unauthorized","No session ID found");if(z[w.value]===void 0)return X?.()??U("Unauthorized","No session found");return W()}})).as("plugin");var qX=({clientProviders:z,refreshRoute:w="refresh",onRefresh:U})=>new K0().post(`/${w}`,async({error:W,cookie:{user_refresh_token:X,auth_provider:A}})=>{if(X.value===void 0)return W("Unauthorized","No refresh token found");if(A.value===void 0)return W("Unauthorized","No auth provider found");let Z=A.value.toLowerCase(),{providerInstance:$}=z[Z];if(!r5($))return W("Not Implemented","Provider is not refreshable");try{return await $.refreshAccessToken(X.value),U?.(),new Response("Token refreshed",{status:204})}catch(Y){if(Y instanceof Error)return W("Internal Server Error",`Failed to refresh token: ${Y.message}`);return W("Internal Server Error",`Faile to refresh token: Unknown error: ${Y}`)}});var LX=({clientProviders:z,revokeRoute:w="revoke",onRevoke:U})=>new K0().post(`/${w}/access-token`,async({error:W,cookie:{user_refresh_token:X,auth_provider:A}})=>{if(X.value===void 0)return W("Unauthorized","No refresh token found");if(A.value===void 0)return W("Unauthorized","No auth provider found");let Z=A.value.toLowerCase(),{providerInstance:$}=z[Z];if(!AX($))return W("Not Implemented","Provider does not support revocation");try{return await $.revokeAccessToken(X.value),U?.(),new Response("Token revoked",{status:204})}catch(Y){if(Y instanceof Error)return W("Internal Server Error",`Failed to revoke token: ${Y.message}`);return W("Internal Server Error",`Failed to revoke token: Unknown error: ${Y}`)}});var NX=({clientProviders:z,statusRoute:w="auth-status",onStatus:U})=>new K0().use(C4()).get(`/${w}`,async({error:W,cookie:{user_session_id:X,auth_provider:A},store:{session:Z}})=>{try{if(X.value===void 0)return new Response(JSON.stringify({isLoggedIn:!1,user:null}),{headers:{"Content-Type":"application/json"}});if(A.value===void 0)return new Response(JSON.stringify({isLoggedIn:!1,user:null}),{headers:{"Content-Type":"application/json"}});let $=A.value.toLowerCase(),{providerInstance:Y}=z[$];if(!r5(Y))return W("Not Implemented","Provider is not refreshable");let Q=Z[X.value];if(Q===void 0)return new Response(JSON.stringify({isLoggedIn:!1,user:null}),{headers:{"Content-Type":"application/json"}});let{user:J}=Q;return U?.(),new Response(JSON.stringify({isLoggedIn:!0,user:J}),{headers:{"Content-Type":"application/json"}})}catch($){if($ instanceof Error)return W("Internal Server Error",`Error: ${$.message} - ${$.stack??""}`);return W("Internal Server Error",`Unknown Error: ${$}`)}});var zd=({config:z,authorizeRoute:w,callbackRoute:U,logoutRoute:W,statusRoute:X,refreshRoute:A,revokeRoute:Z,onAuthorize:$,onCallback:Y,onStatus:Q,onRefresh:J,onLogout:N,onRevoke:S,createUser:G,getUser:O})=>{let M=Object.keys(z).reduce((C,k)=>{if(!Object.prototype.hasOwnProperty.call(z,k))return C;if(!t6(k))return console.error(`Provider ${k} is not supported`),C;let q0=z[k];if(!q0)return C;let w0=k.toLowerCase(),_0=XX[w0];if(!t6(_0))return console.error(`Provider ${k} is not supported`),C;let C0=U8[_0],{credentials:f,scopes:E=[],searchParams:T=[]}=q0,F=new C0(...f);return C[w0]={providerInstance:F,scopes:E,searchParams:T},C},{});return new K0().error("OAUTH2_REQUEST_ERROR",F4).error("ARCTIC_FETCH_ERROR",$6).use(BX({logoutRoute:W,onLogout:N})).use(LX({clientProviders:M,onRevoke:S,revokeRoute:Z})).use(NX({clientProviders:M,onStatus:Q,statusRoute:X})).use(qX({clientProviders:M,onRefresh:J,refreshRoute:A})).use(QX({authorizeRoute:w,clientProviders:M,onAuthorize:$})).use(JX({callbackRoute:U,clientProviders:M,createUser:G,getUser:O,onCallback:Y})).use(MX()).as("plugin")};export{zd as absoluteAuth};
